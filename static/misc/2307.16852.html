<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>2307.16852</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 24pt; }
 .s2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s3 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: 4pt; }
 .s4 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 3pt; }
 .p, p { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .s5 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .h2, h2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s6 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s7 { color: #7F7F7F; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 .s8 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 4pt; }
 .a, a { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s9 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s10 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s11 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s12 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s13 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s15 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s16 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s17 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s18 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s19 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s20 { color: black; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s21 { color: black; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2.5pt; vertical-align: 2pt; }
 .s22 { color: black; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s23 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s24 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2.5pt; vertical-align: 2pt; }
 .s25 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s26 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s27 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s28 { color: #262626; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s29 { color: #262626; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s30 { color: #262626; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s31 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s32 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s33 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 3pt; }
 .s34 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt; }
 .s35 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s36 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s37 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11.5pt; }
 .s38 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s39 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s40 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -1pt; }
 .s41 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s42 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -1pt; }
 .s43 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s44 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 1pt; }
 .s45 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 1pt; }
 .s46 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s47 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 11pt; }
 .s48 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 5pt; }
 .s49 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 5pt; }
 .s50 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 6pt; }
 .s51 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 6pt; }
 .s52 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s53 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s54 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 4pt; }
 .s55 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 1pt; }
 .s56 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: -14pt; }
 .s58 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 7pt; vertical-align: 5pt; }
 .s59 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 5pt; }
 .s60 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 2pt; }
 .s61 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s62 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s64 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s65 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s67 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s68 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s69 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s70 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s71 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s72 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s73 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s74 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s75 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s76 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s77 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 4pt; }
 .s78 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s79 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s80 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s81 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s82 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s83 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s84 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -2pt; }
 .s86 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s87 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s88 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 2pt; }
 .s89 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 2pt; }
 .s90 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s91 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 6pt; }
 .s92 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s93 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: 2pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, upper-roman)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: "("counter(d1, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt;counter-reset: e1 1; }
 #l3> li>*:first-child:before {counter-increment: e1; content: counter(e1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: e1 0;  }
 #l4 {padding-left: 0pt;counter-reset: f1 1; }
 #l4> li>*:first-child:before {counter-increment: f1; content: "["counter(f1, decimal)"] "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 li {display: block; }
 #l5 {padding-left: 0pt;counter-reset: f1 2; }
 #l5> li>*:first-child:before {counter-increment: f1; content: "["counter(f1, decimal)"] "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 li {display: block; }
 #l6 {padding-left: 0pt;counter-reset: g1 1; }
 #l6> li>*:first-child:before {counter-increment: g1; content: counter(g1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: g1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p class="s1" style="padding-top: 3pt;padding-left: 13pt;text-indent: 0pt;text-align: center;">Learning When to Say Goodbye: What Should be the Shelf Life of an Indicator of Compromise?</p><p class="s2" style="padding-top: 15pt;padding-left: 13pt;text-indent: 0pt;line-height: 12pt;text-align: center;">Breno Tostes<span class="s3">∗</span>, Leonardo Ventura<span class="s3">∗</span>, Enrico Lovat<span class="s3">‡</span>, Matheus Martins<span class="s3">‡</span>, Daniel Menasche´<span class="s3">∗</span></p><p class="s4" style="text-indent: 0pt;line-height: 13pt;text-align: center;">∗<span class="p">Federal University of Rio de Janeiro (UFRJ), </span>‡<span class="p">Siemens Corporation</span></p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">Abstract<span class="h2">—Indicators of Compromise (IOCs), such as IP ad- dresses, file hashes, and domain names associated with known malware or attacks, are cornerstones of cybersecurity, serving to identify malicious activity on a network. In this work, we leverage real data to compare different parameterizations of IOC aging models. Our dataset comprises traffic at a real environment for more than 1 year. Among our trace-driven findings, we determine thresholds for the ratio between miss over monitoring costs such</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 14pt;text-indent: 37pt;line-height: 189%;text-align: left;">vendor or TI source honeypot event</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 13pt;text-indent: 0pt;line-height: 106%;text-align: center;">event at controlled environment</p><p class="s6" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">MISP</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">arXiv:2307.16852v1 [cs.CR] 31 Jul 2023</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SIEM</p><h2 style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">that the system benefits from storing IOCs for a finite time-to-live (TTL) before eviction. To the best of our knowledge, this is the first real world evaluation of thresholds related to IOC aging, paving the way towards realistic IOC decaying models.</h2><p class="s8" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">(lab) <span class="s6">IoC created</span></p><p class="s6" style="padding-left: 20pt;text-indent: 0pt;line-height: 106%;text-align: center;">and published by vendor</p><p class="s6" style="padding-left: 18pt;text-indent: 0pt;line-height: 7pt;text-align: center;">at its platform</p><p class="s6" style="padding-top: 3pt;padding-left: 9pt;text-indent: -3pt;line-height: 106%;text-align: left;">IoC created at MISP</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 6pt;line-height: 106%;text-align: left;">IoC sighting occurs at SIEM</p><p class="s5" style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Index Terms<span class="h2">—Threat intelligence; data science; modeling and analysis.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="I."><p style="padding-left: 103pt;text-indent: -10pt;text-align: left;"><a name="bookmark0">&zwnj;</a>Introduction</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 9pt;text-align: right;"><a href="#bookmark28" class="a">Indicators of Compromise (IOCs), such as IP addresses of compromised hosts, hashes of malware and bodies of emails of phishing campaigns, are the foundation of cyber threat intelligence (TI). They serve as signatures of risk, being employed in monitoring systems to generate alerts if a match is found between known IOCs and data collected at a given environment. In essence, the larger the IOC base, the greater is the coverage against previously observed cyber-attacks. However, such coverage is associated with its own costs </a><a href="#bookmark28">[1].</a></p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark32" class="a">The security of the target environment could be at risk if the number of monitored IOCs is limited, as it may lead to the omission of crucial indicators. On the other hand, maintaining too many IOCs is prohibitive due to intrinsic costs of investigating a large catalog of potential incidents </a>[2]. Understanding the dynamics of IOC creation and sightings is crucial for addressing the challenges of maintaining and using IOCs, and for developing effective strategies for monitoring and responding to cyber threats.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark1" class="a">Figure </a>1 shows the typical dynamics of IOC creation and sightings. An IOC is typically discovered at a vendor or TI source, e.g., in a controlled lab environment or through a honeypot. Then, the IOC is created and published by that vendor, and is also propagated to sharing platforms, such as the Malware Information Sharing Platform (MISP). MISP is a distributed system comprising multiple instances, run by different organizations and communities, and allowing them to benefit from the collective knowledge. Finally, Security Information and Event Management (SIEM) systems monitor the IOCs, and eventually report sightings for the monitored IOCs at the Security Operation Centers (SOCs).</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Over time, IOCs lose relevance and their monitoring leads to costs due to outdated information. Indeed, numerous false</p><p class="s9" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark1">&zwnj;</a>Figure 1. Ecosystem of vendors, MISP instances and SIEMs sharing IOCs and their sightings.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark33" class="a">positives challenges cognitive limitations of SOC employees, and builds monetary costs that vary depending on monitoring price models. Azure Sentinel Threat Intelligence, for instance, offers two pricing alternatives: Capacity Reservations and Pay- As-You-Go. In the latter, the current cost is of $2.46 per GB- ingested. If the presence of IOCs is used to pre-filter data to be fed to Azure, the larger the number of IOCs being monitored, the larger the incurred costs </a><a href="#bookmark33">[3].</a></p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark34" class="a">To cope with the aging of IOCs, threat intelligence plat- forms, such as MISP, have introduced models to determine when an IOC should no longer be monitored. Those models, referred to as aging models (or decaying models), however, have a number of parameters whose assignment poses its own challenges, thus motivating explainable models with simpler and fewer parameters </a>[4]. In particular, we focus on a model with two main parameters, namely the missing and monitoring costs, related to the impact of missing a sighting and to the attention span required to handle alarms, respectively. Our study aims to answer two key questions: How long should a certain indicator be monitored for, and what is the optimal aging model parameterization for a given environment?</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark2" class="a">To answer the above questions, we leverage real data to compare different parameterizations of IOC aging models. Our dataset comprises traffic from a real-world enterprise environment spanning over a year. It contains for each IOC the instants at which sightings occurred (see Figure </a>2). Those sightings are used to parametrize aging models.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">In the MISP terminology, an event refers to a collection of related IOCs. A given IOC may be part of multiple events, but each sighting corresponds to a single event. In summary, our dataset contains, for each sighting towards each IOC, its</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">1) timestamp, 2) IOC anonymized identifier, 3) IOC type,</p><p class="s10" style="padding-top: 2pt;padding-left: 122pt;text-indent: 0pt;text-align: center;">1.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 1pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Cumulative Fraction</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;text-align: right;">0.8</p><p class="s10" style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">2019-4-24</p><p class="s10" style="padding-top: 3pt;padding-left: 17pt;text-indent: 0pt;text-align: left;">2019-7-29</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 122pt;text-indent: 0pt;text-align: center;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 122pt;text-indent: 0pt;text-align: center;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="text-indent: 0pt;text-align: right;">0.0</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2018-10</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2019-01</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2019-04</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2019-07</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2019-10</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2020-01</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2020-04</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2020-07</p><p style="text-indent: 0pt;text-align: left;"/><p class="s10" style="text-indent: 0pt;line-height: 4pt;text-align: left;">2020-10</p><p style="text-indent: 0pt;text-align: left;"/><p class="s12" style="padding-left: 108pt;text-indent: 0pt;line-height: 120%;text-align: left;">IOC sightings IOC creations</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 4pt;padding-left: 45pt;text-indent: 0pt;text-align: left;"><a name="bookmark2">&zwnj;</a>Figure 2. Dynamics of IOC creations and sightings.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">e.g., domain, IP source, IP destination, email source, email subject, md5, sha1, sha256, filename, hostname or URL, 4) IOC creation date, and 5) event identifier. Note that data is anonymized, so the event is characterized by a non-informative identifier, that serves solely to determine how sightings are related to each other through their corresponding events.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark35" class="a">Using our dataset, we characterize how the number of sightings towards IOCs varies over time, as a function of IOC types, and assess the impact of aging model parameters on coverage and corresponding monitoring costs </a>[5]. The <i>hit ratio </i>corresponds to the fraction of IOC sightings that occur while the corresponding IOC is being monitored. A sighting to an unmonitored IOC is said to be uncovered, contributing towards its <i>miss ratio</i>. Correspondingly, the <i>monitoring cost </i>at any given point in time is proportional to the number of IOCs that are being monitored at that time.</p><h1 style="padding-left: 15pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">Contributions. <span class="p">Our key contributions are twofold.</span></h1><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><b>Formulation of the TTL optimization problem. </b><a href="#bookmark37" class="a">To each IOC we associate a corresponding TTL. The TTL is initialized at a constant value, and is decremented at every time unit. When TTL reaches zero, the corresponding IOC monitoring is discontinued. Such a TTL decaying model has a number of different flavors </a>[6]–[8]. Under TTL with reset, the TTL is reset to its initial value whenever a sighting occurs. Under TTL without reset, in contrast, sightings do not impact the TTL dynamics. In any case, note that the TTL dynamics are decoupled across multiple IOCs. We let <i>T </i>denote the initial TTL value, and show how <i>T </i>impacts monitoring costs and miss ratio, under TTL with and without reset.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><b>Trace driven findings. </b>Among our trace-driven findings, we discover that if the cost of missing a sighting is below 2,152 times the daily cost of monitoring an IOC, it is not worth incurring the monitoring costs for any IOC. Conversely, if the cost of a miss is beyond 10<i>.</i>5 million dollars, all IOCs should be constantly monitored, assuming a unitary daily dollar cost for monitoring an IOC. For values inbetween those two thresholds, the system benefits from storing IOCs for a finite time-to-live (TTL), which can be set according to the IOC category. For instance, if the TTL is set to 248 days then the sum of miss costs and monitoring costs is minimized when the cost of missing a sighting equals 10,000 times the daily cost of monitoring an IOC. To the best of our knowledge, this is the first real world evaluation of IOC aging thresholds.</p><h1 style="padding-left: 15pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">Outline. <span class="p">The remainder of this paper is organized as fol-</span></h1><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 13pt;text-indent: 0pt;text-align: center;"><a name="bookmark3">&zwnj;</a>Figure 3. Cumulative fraction of IOCs created and sightings</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark5" class="a">lows. In Section </a><a href="#bookmark10" class="a">II we introduce our trace. Then, Sections </a><a href="#bookmark15" class="a">III and </a><a href="#bookmark19" class="a">IV report our trace-driven findings. Section </a><a href="#bookmark31" class="a">V introduces a utility optimization approach to set TTLs and reports our model-driven findings. Finally, Section </a>VI concludes.</p></li><li data-list-text="II."><p style="padding-top: 9pt;padding-left: 88pt;text-indent: -14pt;text-align: left;"><a name="bookmark4">&zwnj;</a>Dataset Description<a name="bookmark5">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark6" class="a">Our trace was collected from a SOC of a large scale com- pany, comprising more than 300,000 employees and gathering data from more than 12 countries, and contains 5,789 IOCs with at least one sighting. The first and last IOC creation dates occurred at 9/9/2018 and 9/2/2020.</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">1</span><a href="#bookmark3" class="a"> The last sighting occurred at the same date at which the last IOC was created. Figure </a><a href="#bookmark7" class="a">3 shows the cumulative fraction of IOCs created during the interval of our trace, and the cumulative fraction of sightings issued across that interval. Among all sightings, 66% occurred during the first three months of our monitoring campaign, between 4/24/2019 and 7/29/2019 (see Table </a><a href="#bookmark7">I).</a></p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark12" class="a">It is worth noting that some IOCs may have sightings before their corresponding creation dates. This is because once an IOC is created, one may, in retrospect, detect occurrences of the IOC at system logs. Among the IOCs with sightings in our trace, 9% (530/5,789) contain sightings one day before their creation dates (see Figure </a><a href="#bookmark46" class="a">4). In Appendix </a>A we provide a more detailed statistical characterization of time between sightings and creation dates, leveraging survival analysis for this purpose.</p><h1 style="padding-top: 6pt;padding-left: 15pt;text-indent: -10pt;text-align: left;">Motivating question 1. <i>How are IOCs related to each other?</i></h1><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark8" class="a">In our trace, each IOC belongs to one of the eleven types shown in Figure </a>5. Most of the observed indicators and IOCs are associated with domains. IPs also contribute to a considerable proportion of sightings, whereas hashes have the second-highest number of IOCs.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark11" class="a">Recall that each sighting to an IOC belongs to an event, where an event consists of a collection of sightings to related IOCs over time. Despite the fact that the IOCs and events in our trace were anonymized, we are still able to correlate sighting categories through the corresponding events. To that aim, in Figure </a>6 each cell corresponds to the percentage of sightings pertaining to the row’s category that appear in events</p><p class="s15" style="padding-top: 11pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;"><a name="bookmark6">&zwnj;</a>1<span class="s16">For the considered company, sensitive information becomes unclassified after 2 years, as far as it is anonymized.</span></p><p class="s9" style="padding-top: 3pt;padding-left: 31pt;text-indent: 0pt;line-height: 9pt;text-align: center;"><a name="bookmark7">&zwnj;</a>Table I</p><p class="s9" style="padding-left: 31pt;text-indent: 0pt;line-height: 9pt;text-align: center;">General statistics.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:28pt"><td style="width:131pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;padding-right: 15pt;text-indent: 0pt;text-align: left;"># IOCs with at least one sighting # IOCs (total)</p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;"># sightings</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">5,789</p><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;"><span class="s18">≈ </span>14<i>, </i>000<i>, </i>000</p><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">892,240</p></td></tr><tr style="height:18pt"><td style="width:131pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;"># IOCs with first sighting</p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">before its creation date</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-top: 7pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">530</p></td></tr><tr style="height:9pt"><td style="width:131pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">trace duration</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 7pt;text-align: right;">724 days</p></td></tr><tr style="height:9pt"><td style="width:131pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">first creation date</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">2018-09-09</p></td></tr><tr style="height:9pt"><td style="width:131pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">last creation date</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">2020-09-02</p></td></tr><tr style="height:9pt"><td style="width:131pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">first sighting</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">2019-04-24</p></td></tr><tr style="height:11pt"><td style="width:131pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">last sighting</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">2020-09-02</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s9" style="padding-left: 34pt;text-indent: 0pt;text-align: center;">Metric                   Value</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">6</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">5</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">4</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">3</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">domain</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ip-src</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ip-dst</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">filename</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">MD5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">SHA-256</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">SHA-1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">URL</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">mail-src</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">mail-sbj</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ostname</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">10<span class="s21">1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l2"><li data-list-text="(a)"><p class="s9" style="padding-left: 48pt;text-indent: -11pt;text-align: left;">Number of sightings per IOC type</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">10<span class="s24">3</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">10<span class="s24">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">10<span class="s24">1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">domain</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">MD5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">SHA-256</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">URL</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">SHA-1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ip-src</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ﬁlename</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">ip-dst</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">email-sbj</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">email-src</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 5pt;text-align: left;">hostname</p><p style="text-indent: 0pt;text-align: left;"/><p class="s23" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">10<span class="s24">0</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="(b)"><p class="s9" style="padding-left: 23pt;text-indent: -12pt;text-align: left;">Number of IOCs per IOC type</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">Conditional metrics for IOCs with at least one sighting</p><p class="s9" style="padding-top: 5pt;padding-left: 42pt;text-indent: 0pt;text-align: justify;"><a name="bookmark8">&zwnj;</a>Figure 5. Number of sightings and IOCs per type. Domains correspond to the vast majority of sightings and IOCs. IPs also yield a significant fraction of sightings, while hashes have the second-largest number of IOCs.</p><table style="border-collapse:collapse" cellspacing="0"><tr style="height:27pt"><td style="width:131pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;padding-right: 15pt;text-indent: 0pt;text-align: left;">mean time to upcoming sighting, per IOC (multiple sightings</p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">can occur at same day)</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p style="padding-top: 9pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 29pt;text-indent: 0pt;line-height: 8pt;text-align: left;">0.6 days</p></td></tr><tr style="height:54pt"><td style="width:131pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">mean time to first sighting, per IOC (after creation)</p><p class="s17" style="padding-left: 5pt;padding-right: 22pt;text-indent: 0pt;text-align: left;">average number of sightings, per IOC</p><p class="s17" style="padding-left: 5pt;padding-right: 34pt;text-indent: 0pt;line-height: 9pt;text-align: left;">average number of days with sightings, per IOC</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">83 days</p><p class="s17" style="padding-top: 8pt;padding-left: 34pt;text-indent: 0pt;text-align: left;">154.13</p><p class="s17" style="padding-top: 8pt;padding-left: 25pt;text-indent: 0pt;line-height: 8pt;text-align: left;">2.72 days</p></td></tr></table><table style="border-collapse:collapse" cellspacing="0"><tr style="height:36pt"><td style="width:46pt"><p class="s26" style="padding-left: 16pt;padding-right: 1pt;text-indent: 4pt;line-height: 119%;text-align: right;">Domain IP Source IP Dest.</p><p class="s26" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">URL</p></td><td style="width:19pt"><p class="s27" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">100.00</p><p class="s27" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">51.57</p><p class="s27" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">89.51</p><p class="s27" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">42.44</p></td><td style="width:36pt" colspan="2"><p class="s27" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">40.44 <span style=" color: #262626;">0.07</span></p><p class="s27" style="padding-top: 3pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">100.00 <span style=" color: #262626;">0.01</span></p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.01 <span style=" color: #FFF;">100.00</span></p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">2.52 0.28</p></td><td style="width:19pt"><p class="s28" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">1.82</p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.01</p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.02</p><p class="s27" style="padding-top: 3pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">100.00</p></td><td style="width:128pt" colspan="7" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.00  0.00  0.04  0.09  0.17  0.13  0.13</p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.00  0.00  8.85  0.12  0.31  0.00  0.15</p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.02  0.00  0.00  0.03 <span style=" color: #FFF;">69.63 69.74 69.54</span></p><p class="s28" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.00  0.00  0.00  2.94  8.12  6.44  5.88</p></td></tr><tr style="height:9pt"><td style="width:46pt"><p class="s26" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">Host name</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td></tr><tr style="height:9pt"><td style="width:46pt"><p class="s26" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">E-mail Source</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#D01D1F"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">72.69</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td></tr><tr style="height:9pt"><td style="width:46pt"><p class="s26" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">E-mail Subject</p></td><td style="width:19pt" bgcolor="#FB6E4E"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">48.57</p></td><td style="width:18pt" bgcolor="#FBA689"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">31.43</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td></tr><tr style="height:9pt"><td style="width:46pt"><p class="s26" style="padding-right: 1pt;text-indent: 0pt;line-height: 7pt;text-align: right;">File name</p></td><td style="width:19pt" bgcolor="#FEF3ED"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">1.55</p></td><td style="width:18pt" bgcolor="#FEF4EF"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.51</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.05</p></td><td style="width:19pt" bgcolor="#FEF4EF"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.51</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.03</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:18pt" bgcolor="#FFF4F0"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">0.00</p></td><td style="width:19pt" bgcolor="#66000D"><p class="s27" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">100.00</p></td><td style="width:18pt" bgcolor="#FEEDE5"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">4.41</p></td><td style="width:18pt" bgcolor="#FEF2EC"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">1.58</p></td><td style="width:19pt" bgcolor="#FEF1EA"><p class="s28" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">2.63</p></td></tr></table><p style="padding-left: 36pt;text-indent: 0pt;text-align: left;">	</p><p class="s6" style="text-indent: 0pt;line-height: 5pt;text-align: right;">MD5 <span class="s29">13.15</span></p><p class="s30" style="padding-left: 4pt;text-indent: 0pt;line-height: 5pt;text-align: left;">2.04  6.49  3.03  0.00  0.00  0.00</p><p class="s30" style="padding-left: 4pt;text-indent: 0pt;line-height: 5pt;text-align: left;">12.78 <span style=" color: #FFF;">100.00 </span>33.47 <span style=" color: #FFF;">46.47</span></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">that also present IOCs from the column’s category. From this heat map, we can highlight two clusters.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: left;">The first cluster, in the bottom right corner, comprises MD5, SHA-1 and SHA-256 categories, in which we observe that</p><p class="s6" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">SHA-1 <span class="s29">20.72</span></p><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">Domain</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">IP Source</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">IP Dest.</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">Host name</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">E-mail Source</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">E-mail Subject</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">File name</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">SHA-256</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">SHA-256 <span class="s29">17.39</span></p><p class="s30" style="padding-top: 2pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">0.80  7.97  7.57  0.00  0.00  0.00</p><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">URL</p><p style="text-indent: 0pt;text-align: left;"/><p class="s30" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">1.23  6.89  4.12  0.00  0.00  0.00</p><p class="s30" style="padding-top: 2pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">13.01</p><p class="s30" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">12.03</p><p class="s31" style="padding-top: 2pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">95.22 100.00 94.16</p><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">MD5</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="text-indent: 0pt;line-height: 6pt;text-align: left;">SHA-1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s31" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">65.01 45.88 100.00</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">whenever we have an indicator’s MD5 hash, it is accompanied 33% of the time by its SHA-1 hash and, 46% of the time, by its SHA-256 hash. Indeed, it is typical to share different hash values for a given malware or for its variants. The second cluster, in the top left, suggests that domain names and IP addresses also tend to be shared through common events.</p><h1 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 1. <i>Hashes are typically sighted in bundles, and the same occurs for IPs and domain names. The decaying models considered in this work can be used either to capture the aging of isolated IOCs or bundles of IOCs.</i></h1><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="III."><p style="padding-left: 53pt;text-indent: -18pt;text-align: left;"><a name="bookmark9">&zwnj;</a>Deterministic bounds and outliers<a name="bookmark10">&zwnj;</a></p><h1 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 2. <i>What is a naive upper bound on TTL?</i></h1><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 9pt;text-align: left;">We begin by estimating an upper bound on the TTL value to cover all sightings for all IOCs. Indeed, a conservative</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 171pt;text-indent: 0pt;text-align: left;">[11,724]</p><p class="s12" style="padding-top: 6pt;padding-left: 58pt;text-indent: 0pt;text-align: center;">24.52%</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 73pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0</p><p class="s12" style="padding-left: 85pt;text-indent: 0pt;line-height: 5pt;text-align: left;">43.31%</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="padding-left: 156pt;text-indent: 0pt;text-align: left;">16.35%</p><p class="s9" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark11">&zwnj;</a>Figure 6. Correlation matrix of IOC categories, obtained from the relation between IOC sightings and events. Each cell corresponds to the percentage of sightings pertaining to the row’s category that appear in events that also have IOCs from the column’s category.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">approach towards IOC monitoring consists in setting TTL to a large enough value that, in retrospect, would have covered all sightings.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">In our trace, the largest gap between the first and last sight- ings towards an IOC equals 724 days. Following a conservative monitoring strategy, i.e., <i>T </i>= 724, and assuming an extension towards an infinite trace wherein IOCs are created at a rate of <i>λ </i>IOCs per time unit, it follows from Little’s law the expected number of IOCs to be monitored at any point in time, in steady state, equals 724 <span class="s32">· </span><i>λ</i>. This estimate, however, is sensitive to outliers, motivating the use of statistical tools to parameterize TTL in order to determine when and if IOCs should be evicted.</p><h1 style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 2. <i>Setting TTL to the largest gap between IOC creation date and IOC sighting serves as a conservative upper bound on the TTL value, but this bound is sensitive to outliers.</i></h1><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">Whereas the above discussion accounted for a deterministic upper bound on the TTL, in what follows we consider a statistical perspective to account for outliers.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="padding-left: 116pt;text-indent: 0pt;text-align: left;">6.65%</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 116pt;text-indent: 0pt;text-align: left;">1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="text-indent: 0pt;text-align: right;">9.16%</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="text-indent: 0pt;text-align: right;"> -1</p><p class="s6" style="padding-top: 1pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">[2,10]</p><h1 style="padding-top: 4pt;padding-left: 67pt;text-indent: 0pt;text-align: left;">Motivating question 3. <i>How to cope with outliers while trading between monitoring costs and misses?</i></h1><p style="padding-top: 6pt;padding-left: 77pt;text-indent: 0pt;text-align: left;">To cope with outliers and with the need for allowing</p><p class="s9" style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark12">&zwnj;</a>Figure 4. Distribution of first sighting minus creation date. Around 9% of the IOCs have their first sighting one day before creation date, and 43% at the same day.</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">a certain level of missed sightings, we consider statistical approaches to parametrize TTLs. In the simplest setting, we take as inputs the target hit ratio <i>t </i>(with corresponding miss</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">ratio 1 <span class="s32">− </span><i>t</i>) and the cumulative distribution function (CDF) of the time between consecutive sightings, <i>F </i>(<i>x</i>) = <i>P </i>(<i>X &lt; x</i>), where <i>X </i>is a sample from the distribution of the time between sightings. Then, we let <i>T </i>= <i>F</i><span class="s33">−</span><span class="s34">1</span>(<i>t</i>).</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">For large values of <i>t</i>, this model clearly degenerates to the simple deterministic bound discussed in the previous paragraph. Smaller values of <i>t </i>allow us to trade-off between coverage and monitoring costs. In our trace, to capture 90% of sightings towards IOCs related to emails, we must let <i>T </i>= 38</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark13">&zwnj;</a>1.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 1pt;text-indent: 0pt;line-height: 12pt;text-align: left;">CDF</p><p style="text-indent: 0pt;text-align: left;"/><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1.00</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.98</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.96</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.94</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.92</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Hashes</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Mail</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IP</p><p class="s35" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 115%;text-align: left;">Host Mail Hashes Filename</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;">days. In this case, a 10% reduction in coverage corresponds</p><p class="s35" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0.90</p><p class="s35" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">0    200   400   600</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">to a 95% decrease (1 <span class="s32">− </span>38<i>/</i>724 = 0<i>.</i>95) in monitoring costs.</p><h1 style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Finding 3. <i>By reducing TTL, a small decrease in coverage can</i></h1><p class="s35" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0.0</p><p class="s35" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0   1000  2000  3000  4000  5000  6000</p><p class="s36" style="padding-top: 2pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Time between sightings (hours)</p><p class="s13" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">yield a significant reduction in monitoring costs. This occurs in part due to outliers.</p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">(a) Time between sightings. Internal plot: zoom accounting for time between sightings of up to 30 days.</p></li><li data-list-text="IV."><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -17pt;text-align: left;"><a name="bookmark14">&zwnj;</a>Accounting for categories<a name="bookmark15">&zwnj;</a></p><h1 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Motivating question 4. <i>What is the impact of categories on IOC lifetimes?</i></h1><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">In our trace we count with eleven IOC types: md5, sha1, sha256, ip-src, ip-dst, email-subject, email-dst, domain, host- name, filename and url. Each IOC is associated to exactly one type. Conditioning TTL values to IOC types allows us to reduce the impact of outliers, which skew the TTL values for</p><p class="s6" style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">1.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">CDF</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.2</p><p class="s6" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Filename</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="text-indent: 0pt;text-align: right;">IP</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">Mail</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IP</p><p class="s11" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 118%;text-align: left;">Host Mail Hashes Filename</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">the whole trace but may not impact certain categories.</p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.0</p><p class="s6" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0  2500 5000 7500 10000 12500 15000 17500</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark21" class="a">The categories discussed above can be split or grouped. As an example, the eleven categories may be grouped into five coarser clusters (see Figure </a>7): hashes (md5, sha1, sha256), IPs (ip-src, ip-dst), email (email-subject, email-dst), host (domain, hostname, url) and filename. In what follows, we refer to those five clusters of categories simply as <i>categories</i>.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark13" class="a">Figure </a>7a shows the cumulative distribution function (CDF) of the time between sightings, for the five considered cat- egories, respectively. Hashes tend to linger longer than IPs, corresponding to larger times between sightings. Indeed, while IPs are dynamic and should eventually be white-listed, hashes tend to be more stable over time.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark20" class="a">Figure </a>7b shows the CDF of time from IOC creation until first sighting, per category. For most categories, roughly 70% of the IOCs have their first sighting soon after the creation date. However, the remaining 30% of IOCs have their first sightings uniformly distributed throughout the period of observation. This means that for a significant fraction of IOCs the first sighting can take more than one year to occur.</p><h1 style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 4. <i>There are at least two motivations to reduce TTL values: 1) reduce monitoring costs and 2) cope with IOCs that expire. The time between sightings for hashes tends to be larger than for IPs. This motivates setting TTLs for IPs to smaller values when compared against hashes, not only to reduce monitoring costs but also to cope with the fact that IP entries in blacklists expire due to their ephemeral nature.</i></h1><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="V."><p style="padding-left: 90pt;text-indent: -13pt;text-align: left;"><a name="bookmark16">&zwnj;</a>Utilities and costs<a name="bookmark19">&zwnj;</a></p><h1 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 5. <i>How to quantitatively capture the monitoring and miss costs while setting TTL?</i></h1><p class="s38" style="padding-top: 2pt;padding-left: 42pt;text-indent: 0pt;text-align: left;"><a name="bookmark20">&zwnj;</a>Time between creation and first sighting</p><p class="s9" style="padding-top: 4pt;padding-left: 21pt;text-indent: 0pt;text-align: left;">(b) Time between IOC creation date and first sighting, measured in hours.</p><p class="s9" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark21">&zwnj;</a>Figure 7. Time between sightings and time until first sighting (measured in hours), over different IOC categories. Hashes tend to linger longer than IPs, showing larger times between sightings and times to first sightings.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Next, we consider the availability of information about monitoring costs and costs associated with missing a sighting, to determine the target hit ratio <i>t</i>. Together, these costs can assist in the flexible monitoring of IOCs. Indeed, such costs, e.g., measured in dollars per time unit and dollars per missed sighting, respectively, can be used to establish a utility function to set TTL values in a principled utility-oriented fashion.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">Introducing monetary costs may impose additional chal- lenges, as determining such costs is non-trivial. However, monetary costs may help to convey the role of the IOC aging model in the considered organization, bridging the gap between IOC monitoring strategies and other elements of the business workflow. Monetary costs can be determined exogenously based on related literature or on information provided by certain products, such as Azure Sentinel Threat Intelligence (ASTI).</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">The ratio between monitoring and missing costs can also be estimated in an endogenous fashion, using data from the collected traces. Indeed, the trace of sightings implies that if the cost ratio is above a certain threshold, one should never monitor any IOC (no-monitoring extreme). At the other extreme of the spectrum, when the ratio is below a lower threshold all IOCs should be constantly monitored (always-</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">monitoring extreme). Knowing such two thresholds, and un- derstanding how the cost ratio impacts monitoring strategies, together with historical information about monitoring practices in a given business, provides insights on the current and prospective target cost ratios.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark10" class="a">To find the two thresholds referred to in the above para- graph, we define TTLs ranging between 0 and the maximum interval between sightings (see Section </a>III). For each TTL value we compute, in retrospect, the corresponding monitoring and missing costs. The monitoring cost is the number of days we monitor each IOC in our system multiplied by the cost of each day of monitoring. The missing cost is the number of missed sightings multiplied by the cost of each miss.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Let <i>C </i>be the total cost, and <i>C</i><span class="s39">mon</span> and <i>C</i><span class="s39">miss</span> be the mon- itoring and missed sighting costs, respectively. <i>C</i><span class="s39">mon</span> is the monitoring cost per IOC per day, and <i>C</i><span class="s39">miss</span> is the miss cost per missed sighting. Under the above simple model, the total cost is a linear function of the time that IOCs were monitored (accounting for IOCs with no sighting) and the number of missed sightings. Let <i>I </i>be the number of IOCs:</p><p class="s13" style="padding-top: 8pt;padding-left: 54pt;text-indent: 0pt;text-align: left;">C<span class="p">(</span>N<span class="s40">mon</span>, N<span class="s40">miss</span><span class="s41">; </span>C<span class="s40">mon</span>, C<span class="s40">miss</span><span class="s41">) =        (1)</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">and 2) search for the two cost ratios that correspond to the extremal thresholds discussed above.</p><h1 style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 5. <i>The impact of monitoring and miss costs can be captured through an utility function consisting of the sum of two costs, which vary in a non-linear fashion with respect to TTL values. To deal with such non-linearity, one alternative is to approach the problem of finding the optimal TTL through a trace-driven perspective.</i></h1><ol id="l3"><li data-list-text="A."><p class="s13" style="padding-top: 6pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark17">&zwnj;</a>Back-of-the-envelope calculations</p><h1 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 6. <i>Is it feasible to get rough estimates of recommended TTL values without leveraging the full trace of sightings in its details?</i></h1><p class="s13" style="padding-top: 5pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark22" class="a">Next, we aim at providing initial insights on the proposed cost model, leveraging data from our traces. We begin by revisiting Equation </a><span class="p">(5). In particular, we consider a simple workload model wherein sightings to IOC </span>i <span class="p">arrive according to a Poisson process with rate </span>λ<span class="s42">i</span><span class="p">. Then, under TTL with reset, the probability that the TTL is not reset during an interval of </span>T <span class="p">seconds is given by exp(</span><span class="s32">−</span>λ<span class="s42">i</span>T <span class="p">), which corresponds to the probability that no sighting arrives during that interval. In that</span></p><p class="s43" style="padding-left: 104pt;text-indent: 0pt;line-height: 4pt;text-align: left;">I       I         <span class="p">case, assuming that every reset increases the monitoring period</span></p><p class="s45" style="padding-left: 67pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><span class="s44">= </span>C<span class="s46">mon </span><span class="s47">L </span>N <span class="s48">(</span><span class="s49">i</span><span class="s48">) </span><span class="s44">+ </span>C<span class="s46">miss </span><span class="s47">L </span>N <span class="s50">(</span><span class="s51">i</span><span class="s50">)</span></p><p style="padding-top: 7pt;text-indent: 0pt;line-height: 5pt;text-align: right;">(2)</p><p style="padding-top: 7pt;padding-left: 9pt;text-indent: 0pt;line-height: 5pt;text-align: left;">by <i>T/</i>2, we have</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s43" style="text-indent: 0pt;text-align: right;">i<span class="s35">=1</span></p><p class="s46" style="padding-left: 8pt;text-indent: 0pt;line-height: 8pt;text-align: left;">mon</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s43" style="text-indent: 0pt;text-align: right;">i<span class="s35">=1</span></p><p class="s46" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">miss</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 100pt;text-indent: 0pt;line-height: 7pt;text-align: left;"><span class="p">∆</span>T <span class="s34">(</span><span class="s33">i</span><span class="s34">)</span><span class="s52"> </span><span class="p">= </span>Te<span class="s33">λ</span><span class="s53">i</span><span class="s54">T </span>/<span class="p">2</span>.         <span class="p">(8)</span></p><p class="s45" style="padding-left: 67pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><span class="s44">= </span>C<span class="s46">mon</span>N<span class="s46">mon </span><span class="s55">+ </span>C<span class="s46">miss</span>N<span class="s46">miss         </span><span class="s55">(3)</span></p><p class="s46" style="text-indent: 0pt;line-height: 8pt;text-align: left;">mon</p><p style="text-indent: 0pt;text-align: left;"/><p class="s34" style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span class="p">where </span><span class="s13">N </span>(<span class="s33">i</span>)</p><p class="s35" style="padding-top: 7pt;padding-left: 7pt;text-indent: 0pt;line-height: 8pt;text-align: left;">(<span class="s43">i</span>)</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;">and <i>N</i></p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">miss</p><p style="padding-top: 9pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">are the monitoring time and number of</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">According to the above model, the cost of monitoring increases exponentially with <i>T </i>. However, our trace-driven analysis</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">missed sightings for the <i>i</i>-th IOC, and <i>N</i><span class="s39">mon</span> and <i>N</i><span class="s39">miss</span> are the</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">corresponding quantities accounting for all IOCs. Note that <i>N</i><span class="s39">mon</span> and <i>N</i><span class="s39">miss</span> are functions of <i>T </i>. Indeed, as many IOCs receive no sightings, we have</p><p class="s13" style="text-indent: 0pt;line-height: 10pt;text-align: left;">N</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;line-height: 10pt;text-align: left;">=</p><p style="text-indent: 0pt;text-align: left;"/><p class="s35" style="padding-top: 6pt;padding-left: 44pt;text-indent: 0pt;line-height: 7pt;text-align: left;">(<span class="s43">i</span>)</p><p class="s56" style="padding-top: 7pt;text-indent: 0pt;text-align: left;">=<span class="s52"> </span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s46" style="padding-left: 43pt;text-indent: 0pt;line-height: 7pt;text-align: left;">mon</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">shows that in practice, the monitoring cost increases linearly as <i>T </i>increases. This is because we observed that sightings of a particular IOC tend to occur in bursts, meaning that many sightings occur on the same day. To estimate the arrival rate of sightings that contribute to resets, we count all sightings in a burst as a single burst arrival. We found that the average</p><p class="s13" style="padding-left: 61pt;text-indent: 0pt;line-height: 9pt;text-align: left;">T,     <span class="p">if IOC </span>i <span class="p">has no sightings</span></p><p class="s13" style="padding-left: 61pt;text-indent: 0pt;text-align: left;">T <span class="p">+ ∆</span>T <span class="s34">(</span><span class="s33">i</span><span class="s34">)</span>, <span class="p">otherwise</span></p><p style="padding-top: 3pt;padding-left: 21pt;text-indent: 0pt;text-align: left;">(4)</p><p style="padding-left: 9pt;text-indent: 0pt;text-align: left;"><a href="#bookmark7" class="a">number of daily bursts of sightings per IOC is 2.72 (as shown in the last line of Table </a>I), which is quite small compared to the</p><p class="s34" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">where ∆</span><span class="s13">T </span>(<span class="s33">i</span>)<span class="s52"> </span><span class="p">is the additional number of days at which IOC</span></p><p class="s13" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">i <span class="p">is monitored beyond </span>T <span class="p">. Then,</span></p><p class="s52" style="text-indent: 0pt;line-height: 10pt;text-align: left;">L</p><p style="text-indent: 0pt;text-align: left;"/><p class="s43" style="padding-top: 7pt;padding-left: 42pt;text-indent: 0pt;text-align: center;"><a name="bookmark22">&zwnj;</a>I</p><p class="s13" style="padding-top: 1pt;padding-left: 77pt;text-indent: 0pt;text-align: left;">N<span class="s39">mon</span><span class="p"> = </span>T <span class="s32">· </span>I <span class="p">+   ∆</span>T <span class="s34">(</span><span class="s33">i</span><span class="s34">)</span><span class="s52">       </span><span class="p">(5)</span></p><p class="s43" style="padding-top: 2pt;padding-left: 43pt;text-indent: 0pt;text-align: center;">i<span class="s35">=1</span></p><p class="s34" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">where ∆</span><span class="s13">T </span>(<span class="s33">i</span>)<span class="s52"> </span><span class="p">= 0 for TTL without reset, and can be positive for TTL with reset.</span></p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">The dependency of <i>N</i><span class="s39">mon</span> and <i>N</i><span class="s39">miss</span> on <i>T </i>may be non-trivial, e.g., non-convex. In what follows, we denote the functions that capture such dependencies and that map <i>T </i>into <i>N</i><span class="s39">mon</span> and <i>N</i><span class="s39">miss</span> as <i>g</i>(<span class="s32">·</span>) and <i>h</i>(<span class="s32">·</span>),</p><p class="s13" style="padding-top: 8pt;padding-left: 104pt;text-indent: 0pt;text-align: left;">N<span class="s39">mon</span><span class="p"> = </span>g<span class="p">(</span>T <span class="p">)          (6)</span></p><p class="s13" style="padding-top: 3pt;padding-left: 103pt;text-indent: 0pt;text-align: left;">N<span class="s39">miss</span><span class="p"> = </span>h<span class="p">(</span>T <span class="p">)          (7)</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">overall trace duration. As a result, <i>λ</i><span class="s42">i</span><span class="s32"> </span>approaches zero, causing the monitoring cost to increase roughly linearly with respect to <i>T </i>in the scenarios examined in the following section.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Next, we provide rough estimates of two thresholds on the ratio between monitoring costs and missed sighting costs, according to which it is beneficial never to monitor any IOC or always to monitor all IOCs. Let</p><p class="s13" style="padding-top: 4pt;padding-left: 108pt;text-indent: 0pt;line-height: 16pt;text-align: left;"><a name="bookmark23">&zwnj;</a>R <span class="p">= </span><u>C</u><span class="s58">mon</span><span class="s59"> </span>.           <span class="p">(9)</span></p><p class="s45" style="padding-left: 13pt;text-indent: 0pt;line-height: 10pt;text-align: center;">C<span class="s46">miss</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: center;">For the first threshold, that we refer to as <i>R</i><span class="s42">U</span><span class="s32"> </span>, we have that</p><p class="s13" style="padding-top: 7pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">R <span class="s32">≥ </span>R<span class="s42">U</span><span class="s32"> ⇒ </span>T<span class="s33">⋆</span><span class="s32"> </span><span class="p">= 0        (10)</span></p><p class="s13" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">where </span>T<span class="s33">⋆</span><span class="s32"> </span><span class="p">is the optimal threshold. Similarly, for the second threshold, referred to as </span>R<span class="s42">L</span>,</p><p style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">We first provide some back-of-the-envelope calculations to get some insights on how cost impacts the optimal TTL, and the</p><p class="s13" style="padding-left: 90pt;text-indent: 0pt;line-height: 13pt;text-align: left;">R <span class="s32">≤ </span>R<span class="s42">L</span><span class="s32"> ⇒ </span>T<span class="s33">⋆</span><span class="s32"> </span><span class="p">= </span>T<span class="s60">˜</span></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">where <i>T</i><span class="s60">˜ </span>is the maximum admitted threshold.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(11)</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">proceed with a trace-driven exploration to 1) determine the best TTL value, given the costs of monitoring and missing</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: left;">In the following section, we formally pose optimization problems that yield the above thresholds, and proceed with a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">trace-driven simulation to determine <i>R</i><span class="s42">L</span><span class="s32"> </span>and <i>R</i><span class="s42">U</span><span class="s32"> </span><a href="#bookmark24" class="a">. The results are shown in Table </a>II. Alternatively, in what follows we provide some back-of-the-envelope heuristics to approximate those thresholds.</p><p class="s9" style="padding-top: 5pt;padding-left: 13pt;text-indent: 0pt;line-height: 9pt;text-align: center;"><a name="bookmark24">&zwnj;</a>Table II</p><p class="s64" style="text-indent: 0pt;line-height: 90%;text-align: center;"><span class="s9">T</span><span class="s61">RACE</span><span class="s9">-</span><span class="s61">DRIVEN BOUNDS</span><span class="s9">. T</span><span class="s61">HE LOWER BOUND </span><span class="s62">R</span><i>L </i>CORRESPONDS TO THE RATIO MONITORING COST<span class="s16">:</span>MISS COST MOTIVATING ALWAYS MONITORING<span class="s16">, </span>I<span class="s16">.</span>E<span class="s16">., </span>SETTING <span class="s62">T </span><span class="s9">= 724 </span><span class="s61">DAYS</span><span class="s9">. T</span><span class="s61">HE UPPER BOUND </span><span class="s62">R</span><i>U </i>CORRESPONDS TO THE RATIO MOTIVATING NEVER MONITORING<span class="s16">, </span>I<span class="s16">.</span>E<span class="s16">., </span>SETTING <span class="s62">T </span><span class="s9">= 0.</span></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:9pt"><td style="width:25pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:109pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt" colspan="2"><p class="s17" style="text-indent: 0pt;line-height: 8pt;text-align: center;">TTL</p></td></tr><tr style="height:9pt"><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">with reset</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">without reset</p></td></tr><tr style="height:9pt"><td style="width:25pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s19" style="padding-right: 1pt;text-indent: 0pt;line-height: 8pt;text-align: center;">R<span class="s65">L</span></p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">1:10,504,881</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">1:843,470</p></td></tr><tr style="height:9pt"><td style="width:25pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s19" style="padding-right: 1pt;text-indent: 0pt;line-height: 8pt;text-align: center;">R<span class="s65">U</span></p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">1:2,152</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s17" style="padding-right: 5pt;text-indent: 0pt;line-height: 8pt;text-align: right;">1:2,115</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 15pt;text-indent: 0pt;text-align: justify;">The total number of sightings in our trace is 892<i>, </i>240,  <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">spread over 724 days and across roughly 14 million IOCs, most of which having no sightings. Assuming a normalized unitary monitoring cost per IOC per day, the monitoring cost to monitor a single IOC during the interval of interest will be of 724 normalized monetary units. The gain, in contrast,</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">will be on average of <i>C</i><span class="s39">miss</span> <span class="s32">· </span>892<i>, </i>240<i>/</i>(14 <span class="s32">· </span>10<span class="s34">6</span>), assuming that the probability that the monitored IOC will be sighted is proportional to the fraction of IOCs that receive at least one sighting. In particular, in our trace we have an average of 892<i>, </i>240<i>/</i>5<i>, </i>789 sightings per IOC, conditioned on IOCs that have at least one sighting, and a fraction of 5<i>, </i>789<i>/</i>(14 <span class="s32">· </span>10<span class="s34">6</span>) IOCs that are sighted. Multiplying the two quantities, we obtain the expected number of sightings covered by an IOC. Therefore, it is worth monitoring at least one IOC per day if <i>C</i><span class="s39">mon</span> <span class="s32">· </span>724 <i>&lt; C</i><span class="s39">miss</span> <span class="s32">· </span>892<i>, </i>240<i>/</i>(14 <span class="s32">· </span>10<span class="s34">6</span>). Letting <i>C</i><span class="s39">mon</span> = 1, if 1<i>/C</i><span class="s39">miss</span> <i>&gt; </i>892<i>, </i>240<i>/</i>(14 <span class="s32">· </span>10<span class="s34">6</span><span class="s52"> </span><span class="s32">· </span>724) = 1<i>/</i>11<i>, </i><a href="#bookmark24" class="a">363 it is not worth monitoring even one IOC per day. As shown in Table </a>II, indeed such ballpark value is on the same order of magnitude of 1/2,115 that we found in our trace-driven evaluations as the cost ratio above which monitoring is not worthy.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">On the other extreme of the spectrum, if the cost of a miss at a given day, <i>C</i><span class="s39">miss</span>, is larger than the cost of monitoring all IOCs during that day, one should always monitor all IOCs. Given that we have roughly 14 million IOCs, this amounts to always monitoring if <i>C</i><span class="s39">miss</span> <i>&gt; </i>14 <span class="s32">· </span>10<span class="s34">6</span><a href="#bookmark24" class="a">. Again, the order of magnitude is in agreement with the results presented in Table II. The difference between the values in Table </a>II and the above back-of-the-envelope calculations are due to a number of factors, including 1) the fact that IOCs are created in a non- uniform fashion over the trace and 2) sightings tend to occur in bursts. To capture those details, we perform a trace-driven evaluation as further discussed in the next section.</p><h1 style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 6. <i>The ratio between monitoring costs and miss costs plays a key role in determining when it is optimal to never monitor any IOC, or to always monitor all IOCs. Those two strategies are optimal when the miss cost is on the order of thousands and millions, respectively, when compared against unitary monitoring costs.</i></h1></li><li data-list-text="B."><p class="s13" style="padding-top: 10pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark18">&zwnj;</a>Model and optimization problem</p></li></ol><h1 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 7. <i>How does a detailed trace analysis compare against back of the envelope calculations to deter- mine optimal TTL values?</i></h1><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">The optimization problem corresponding to the optimal TTL estimation is given as follows:</p><p class="s13" style="padding-top: 1pt;padding-left: 15pt;text-indent: 0pt;text-align: left;"><span class="p">Recall that </span>R <span class="p">= </span>C<span class="s39">mon</span>/C<span class="s39">miss</span><a href="#bookmark23" class="a"> (see Equation </a><span class="p">9). Then,</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 51pt;text-indent: 0pt;text-align: left;"><span class="p">Argmin</span><span class="s67">T </span>C<span class="p">(</span>N<span class="s39">mon</span>, N<span class="s39">miss</span><span class="p">; </span>C<span class="s39">mon</span>, C<span class="s39">miss</span><span class="p">) =</span></p><p class="s13" style="padding-top: 1pt;padding-left: 64pt;text-indent: 0pt;text-align: left;"><a name="bookmark25">&zwnj;</a><span class="p">= Argmin</span><span class="s67">T </span>R <span class="s32">· </span>g<span class="p">(</span>T <span class="p">) + </span>h<span class="p">(</span>T <span class="p">)       (12)</span></p><p style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark49" class="a">In Appendix </a>B we specialize the above optimization problem to determine <i>R</i><span class="s42">U</span><span class="s32"> </span>and <i>R</i><span class="s42">L</span>, i.e., the thresholds beyond which IOCs should never be monitored, or should be always moni- tored, respectively.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">Note that in the above formulation we assumed that func- tions <i>g</i>(<span class="s32">·</span>) and <i>h</i>(<span class="s32">·</span>) are obtained from traces. Alternatively, approximating those functions through simple expressions may be instrumental to express the solutions to the above problems in closed-form, which we leave as subject for future work.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark24" class="a">Table </a>II shows the values of <i>R</i><span class="s42">L</span><span class="s32"> </span>and <i>R</i><span class="s42">U</span><span class="s32"> </span><a href="#bookmark26" class="a">obtained as solutions of the above optimization problems. Leveraging our traces, we learn that if the cost of a miss is on the order of millions when compared to the monitoring cost per IOC per day, it is worth always monitoring all IOCs. Alternatively, if the miss cost is around 2,000 times the monitoring cost per IOC per day, it is not worth monitoring any IOC. For intermediary cost values, Figure </a>8 shows how the cost varies as a function of TTL.</p><p class="s13" style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark26" class="a">Figure </a><span class="p">8 shows how the monitoring cost, </span>C<span class="s39">mon</span>N<span class="s39">mon</span><span class="p">, miss cost, </span>C<span class="s39">miss</span>N<span class="s39">miss</span><span class="p">, and total cost, </span>C<span class="p">, varies as a function of TTL, </span>T <span class="p">. We let </span>C<span class="s39">mon</span><span class="p"> = 1 USD and </span>C<span class="s39">miss</span><span class="p"> = 10</span>, <span class="p">000 USD, i.e., </span>R <span class="p">= 1</span>/<span class="p">10</span>, <span class="p">000. The curve is obtained using TTL with reset. Note that the monitoring cost grows roughly linearly with respect to </span>T <span class="p">, as previously discussed under our back- of-the-envelope calculations. In addition, note that the miss cost decreases with respect to </span>T <span class="p">, showing a steep decrease around </span>T <span class="p">= 200. Finally, the optimal TTL equals 248, and occurs around the point where the cost curves corresponding to monitoring and miss costs cross each other.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">We repeat the above methodology for <i>C</i><span class="s39">miss</span> varying between 1 and 10<span class="s34">8</span>, keeping <i>C</i><span class="s39">mon</span><a href="#bookmark29" class="a"> = 1. The results are reported in Figure </a>9, that shows how the best <i>T </i>varies as a function of the ratio <i>R</i><span class="s33">−</span><span class="s34">1</span><span class="s52"> </span>= <i>C</i><span class="s39">miss</span><i>/C</i><span class="s39">mon</span>. The figure shows that as <i>C</i><span class="s39">miss</span> increases from 10,000 to 100,000, the optimal TTL value rapidly grows from 248 (as discussed in the previous paragraph) to 500 (as shown in the inside zoom box in</p><p class="s43" style="text-indent: 0pt;line-height: 7pt;text-align: left;">T</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 2pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">T<span class="s33">∗</span><span class="s32"> </span><span class="p">: Argmin</span></p><p class="s45" style="padding-top: 2pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">C<span class="s44">(</span>N<span class="s46">mon</span>, N<span class="s46">miss</span><span class="s55">; </span>C<span class="s46">mon</span>, C<span class="s46">miss</span><span class="s55">)</span></p><p style="padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><a href="#bookmark29" class="a">Figure </a>9). The maximum TTL value is 724 days, which</p><p style="padding-left: 29pt;text-indent: 0pt;line-height: 6pt;text-align: left;">corresponds to the trace duration, and is reached when the</p><p style="text-indent: 0pt;line-height: 11pt;text-align: right;">Subject to          <i>N</i><span class="s39">mon</span> = <i>g</i>(<i>T </i>)</p><p class="s13" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">N<span class="s39">miss</span><span class="p"> = </span>h<span class="p">(</span>T <span class="p">)</span></p><p style="padding-top: 6pt;padding-left: 33pt;text-indent: 0pt;text-align: left;"><a href="#bookmark24" class="a">miss cost reaches roughly 10 million times the monitoring costs (as previously reported in Table </a><a href="#bookmark24">II).</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">1.0</p><p class="s68" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">1e10</p><p style="padding-top: 3pt;padding-left: 41pt;text-indent: 0pt;text-align: justify;">of IOCs. While considering the costs of monitoring IOCs and of missed sightings, we provide a methodology to determine lower and upper bounds (<i>R</i><span class="s42">L</span><span class="s32"> </span>and <i>R</i><span class="s42">U</span><span class="s32"> </span>, respectively) on the</p><p class="s68" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s69" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Cost</p><p style="text-indent: 0pt;text-align: left;"/><p class="s68" style="text-indent: 0pt;text-align: right;">0.6</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">0.4</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">0.2</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">0.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 127pt;text-indent: 0pt;line-height: 115%;text-align: left;">Monitoring cost Miss cost</p><p class="s35" style="padding-left: 127pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Total cost</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0  100  200  300  400  500  600  700</p><p class="s69" style="padding-top: 2pt;padding-left: 15pt;text-indent: 0pt;text-align: center;">TTL</p><p style="padding-left: 37pt;text-indent: 0pt;text-align: right;">ratio between such costs so that IOCs should be monitored forever or not monitored at all. Such ratio, together with traces collected from a SOC, allow operators to tune TTL values according to their needs. We illustrate the methodology using a trace collected from a real world environment, and envision that the methodology is applicable across different businesses. This work opens up a number of avenues related to IOC decaying models. First, we simplified the parameterization of an IOC decaying model, mapping it into the assessment of the ratio between miss costs and monitoring costs, which we</p><p class="s62" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark26">&zwnj;</a><span class="s9">Figure 8. Costs as a function of </span>T <span class="s9">for </span>R <span class="s9">= </span>C<span class="s70">mon</span>/C<span class="s70">miss</span><span class="s9"> = 1</span>/<span class="s9">10</span>, <span class="s9">000. The </span><span class="s71">monitoring cost </span><span class="s72">C</span><span class="s64">mon </span><span class="s73">· </span><span class="s72">N</span><span class="s64">mon </span><span class="s74">grows with respect to </span><span class="s72">T </span><span class="s71">, whereas the miss cost </span>C<span class="s70">miss</span><span class="s9"> </span><span class="s75">· </span>N<span class="s70">miss</span><span class="s9"> decreases. The sum of the two costs, </span>C<span class="s9">, has its minimum at </span>T <span class="s9">= 248.</span></p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="padding-left: 38pt;text-indent: 0pt;text-align: left;">700</p><p class="s76" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Best TTL (days)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s68" style="padding-top: 5pt;padding-left: 38pt;text-indent: 0pt;text-align: left;">600</p><p class="s68" style="padding-top: 5pt;padding-left: 38pt;text-indent: 0pt;line-height: 9pt;text-align: left;">500</p><p class="s68" style="padding-left: 84pt;text-indent: 0pt;line-height: 8pt;text-align: left;">400</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">believe is close to the reality of operators. Further assessing how that ratio varies across environments is left as subject for future work. Second, we provided a trace-driven solution to the problem of determining the best TTL. Analytical solutions, e.g., leveraging special properties on how the number of misses or the monitoring costs vary as a function of the TTL, are also left as subject for future work.</p><h1 style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Acknowledgment:  <span class="p">This work was supported in part by SIEMENS, CAPES, CNPq, and FAPERJ under Grants</span></h1><p class="s68" style="padding-left: 38pt;text-indent: 0pt;line-height: 5pt;text-align: left;">400</p><p class="s68" style="padding-top: 5pt;padding-left: 38pt;text-indent: 0pt;text-align: left;">300</p><p class="s68" style="padding-top: 5pt;padding-left: 38pt;text-indent: 0pt;text-align: left;">200</p><p class="s68" style="padding-top: 5pt;padding-left: 38pt;text-indent: 0pt;line-height: 9pt;text-align: left;">100</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">200</p><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s68" style="text-indent: 0pt;text-align: right;">0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s35" style="padding-left: 38pt;text-indent: 0pt;line-height: 115%;text-align: left;">Original Kaplan-Meier</p><p style="padding-left: 25pt;text-indent: 0pt;text-align: center;">315110/2020-1, E-26/211.144/2019, and E-26/201.376/2021.</p><p style="padding-top: 11pt;padding-left: 28pt;text-indent: 0pt;text-align: center;"><a name="bookmark27">&zwnj;</a>References</p><ol id="l4"><li data-list-text="[1]"><p class="s9" style="padding-top: 8pt;padding-left: 56pt;text-indent: -14pt;line-height: 6pt;text-align: left;"><a name="bookmark28">&zwnj;</a>X. Bouwman, H. Griffioen, J. Egbers, C. Doerr, B. Klievink, and</p><p class="s68" style="text-indent: 0pt;line-height: 7pt;text-align: right;">0.00  0.25  0.50  0.75  1.00</p><p class="s68" style="text-indent: 0pt;line-height: 9pt;text-align: right;">0                    1e6</p><p class="s68" style="padding-left: 59pt;text-indent: 0pt;line-height: 9pt;text-align: left;">0    1    2    3    4    5</p><p class="s76" style="padding-left: 96pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Missing:Monitoring ratio   <span class="s77">1e8</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;"><a name="bookmark29">&zwnj;</a>Figure 9. Best TTL as a function of miss over monitoring cost ratio (<i>R</i><span class="s78">−</span><span class="s79">1</span> =</p><p class="s62" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">C<span class="s70">miss</span>/C<span class="s70">mon</span><span class="s9">), under TTL with reset.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 7. <i>The trace-driven analysis is in agreement with the back-of-the-envelope calculations, and further allows us to assess the optimal TTL values in the range between 0 and 724 days when the miss costs vary from the order of thousands to the order of million times the normalized monitoring costs.</i></h1><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="VI."><p style="padding-left: 111pt;text-indent: -18pt;text-align: left;"><a name="bookmark30">&zwnj;</a>Conclusion<a name="bookmark31">&zwnj;</a></p></li></ol><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark39" class="a">Platforms for information sharing are key elements of the cyber-security ecosystem </a>[9]–[11]. By facilitating the exchange of IOCs and sightings among stakeholders, such platforms allow SOC employees to prioritize which IOCs must be monitored and which alerts require immediate attention. Despite the tremendous success of platforms of that sort, such as MISP, and the proposed features to capture the aging of IOCs, their users are still challenged by the parametrization of the aging models. In particular, such platforms allow users to share sightings, but sensitive information about how those sightings impact monitoring is typically kept private.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">In this work, we provide initial insights obtained from a flow of sightings towards IOCs in a real world environment. By leveraging a trace of sightings towards IOCs, we consider the problem of determining optimal schedules for the monitoring</p><p class="s9" style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;"><a name="bookmark32">&zwnj;</a>M. Van Eeten, “A different cup of TI? the added value of commercial threat intelligence,” in <i>USENIX security</i>, 2020, pp. 433–450.</p><ol id="l5"><li data-list-text="[2]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;"><a name="bookmark33">&zwnj;</a>X. Liao, K. Yuan, X. Wang, Z. Li, L. Xing, and R. Beyah, “Acing the IOC game: Toward automatic discovery and analysis of open-source cyber threat intelligence,” in <i>SIGSAC Conference on Computer and Communications Security</i>, 2016, pp. 755–766.</p></li><li data-list-text="[3]"><p style="padding-left: 24pt;text-indent: -14pt;text-align: justify;"><a href="https://azure.microsoft.com/en-us/pricing/details/azure-sentinel/" class="s80" target="_blank" name="bookmark34">Microsoft, “Azure sentinel,” https://docs.microsoft.com/en-us/azure/ architecture/example-scenario/data/sentinel-threat-intelligence   and https://azure.microsoft.com/en-us/pricing/details/azure-sentinel/.</a></p></li><li data-list-text="[4]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;"><a name="bookmark35">&zwnj;</a>A. Iklody, G. Wagener, A. Dulaunoy, S. Mokaddem, and C. Wagner, “Decaying indicators of compromise,” <i>arXiv:1803.11052</i>, 2018.</p></li><li data-list-text="[5]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;line-height: 9pt;text-align: justify;">S. Romanosky, “Examining the costs and causes of cyber incidents,”</p><p class="s62" style="padding-left: 24pt;text-indent: 0pt;line-height: 9pt;text-align: justify;"><a name="bookmark36">&zwnj;</a>Journal of Cybersecurity<span class="s9">, vol. 2, no. 2, pp. 121–135, 2016.</span></p></li><li data-list-text="[6]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">M. Dehghan, L. Massoulie, D. Towsley, D. S. Menasche, and Y. C. Tay, “A utility optimization approach to network cache design,” <i>IEEE/ACM Transactions on Networking</i>, vol. 27, no. 3, pp. 1013–1027, 2019.</p></li><li data-list-text="[7]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;"><a name="bookmark37">&zwnj;</a>S. Mokaddem, G. Wagener, A. Dulaunoy, and A. Iklody, “Taxonomy driven indicator scoring in misp threat intelligence platforms,” <i>arXiv preprint arXiv:1902.03914</i>, 2019.</p></li><li data-list-text="[8]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;"><a name="bookmark38">&zwnj;</a>J. Ermerins, N. van Noort, J. de Novais Marques, and L. Velasco, “Scoring model for IoCs by combining open intelligence feeds to reduce false positives,” 2020.</p></li><li data-list-text="[9]"><p class="s9" style="padding-left: 24pt;text-indent: -14pt;line-height: 9pt;text-align: justify;">L. Miranda, D. Vieira, L. P. de Aguiar, D. S. Menasche´, M. A. Bicudo,</p><p class="s9" style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">M. S. Nogueira, M. Martins, L. Ventura, L. Senos, and E. Lovat, “On the flow of software security advisories,” <i>IEEE Transactions on Network and Service Management</i>, vol. 18, no. 2, pp. 1305–1320, 2021.</p></li><li data-list-text="[10]"><p class="s9" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a name="bookmark39">&zwnj;</a>D. Preuveneers and W. Joosen, “Sharing machine learning models as indicators of compromise for cyber threat intelligence,” <i>Journal of Cybersecurity and Privacy</i>, vol. 1, no. 1, pp. 140–163, 2021.</p></li><li data-list-text="[11]"><p class="s9" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a name="bookmark40">&zwnj;</a>K. Sridhar, A. Householder, J. Spring, and D. W. Woods, “Cybersecurity information sharing: Analysing an email corpus of coordinated vulner- ability disclosure,” in <i>The 20th Annual Workshop on the Economics of Information Security</i>, 2021.</p></li><li data-list-text="[12]"><p class="s9" style="padding-left: 24pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">M. Newman, “Power laws, Pareto distributions and Zipf&#39;s law,”</p><p class="s62" style="padding-left: 24pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">Contemporary Physics<span class="s9">, vol. 46, no. 5, pp. 323–351, sep 2005. [Online].</span></p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 9pt;text-align: justify;"><a href="https://doi.org/10.1080%2F00107510500052444" class="s80" target="_blank" name="bookmark41">Available: https://doi.org/10.1080%2F00107510500052444</a></p></li><li data-list-text="[13]"><p class="s9" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;">S. Frei, M. May, U. Fiedler, and B. Plattner, “Large-scale vulnerability analysis,” in <i>Proceedings of the 2006 SIGCOMM Workshop on Large- Scale Attack Defense - LSAD ’06</i>, 2006, pp. 131–138.</p></li></ol><p class="s9" style="padding-top: 3pt;padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: center;"><a name="bookmark42">&zwnj;</a>Table III</p><p class="s9" style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Pareto and Weibull fits to time between sightings.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:10.3895pt" cellspacing="0"><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s81" style="text-indent: 0pt;line-height: 5pt;text-align: center;">Category</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s81" style="text-indent: 0pt;line-height: 5pt;text-align: center;">Weibull Parameters</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s81" style="padding-left: 2pt;text-indent: 0pt;line-height: 5pt;text-align: center;">RMSE</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s81" style="text-indent: 0pt;line-height: 5pt;text-align: center;">Pareto Parameters</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s81" style="padding-left: 2pt;text-indent: 0pt;line-height: 5pt;text-align: center;">RMSE</p></td></tr><tr style="height:8pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="padding-top: 1pt;text-indent: 0pt;line-height: 5pt;text-align: center;">Domain</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="padding-top: 1pt;text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">2057</span>, k <span class="s82">= 0</span>.<span class="s82">0004</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">1<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="padding-top: 1pt;text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 1</span>.<span class="s82">2</span>, k <span class="s82">= 0</span>.<span class="s82">0199</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">8<i>e</i><span class="s86">−</span><span class="s87">6</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">IP Source</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">1191</span>, k <span class="s82">= 9</span>.<span class="s82">65</span>e<span class="s88">−</span><span class="s89">7</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">1<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">8</span>, k <span class="s82">= 0</span>.<span class="s82">0020</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">2<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">IP Destination</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">1354</span>, k <span class="s82">= 3</span>.<span class="s82">01</span>e<span class="s88">−</span><span class="s89">5</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">5<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">7</span>, k <span class="s82">= 0</span>.<span class="s82">0067</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">6<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">MD5</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">2731</span>, k <span class="s82">= 0</span>.<span class="s82">2983</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">1<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">7</span>, k <span class="s82">= 0</span>.<span class="s82">1914</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">2<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">SHA1</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">2735</span>, k <span class="s82">= 1</span>.<span class="s82">3974</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">3<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">6</span>, k <span class="s82">= 0</span>.<span class="s82">3322</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">7<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">SHA256</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">2990</span>, k <span class="s82">= 0</span>.<span class="s82">6838</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">1<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">7</span>, k <span class="s82">= 0</span>.<span class="s82">2623</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">3<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">Filename</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">1375</span>, k <span class="s82">= 0</span>.<span class="s82">0003</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">5<i>e</i><span class="s86">−</span><span class="s87">4</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">6</span>, k <span class="s82">= 0</span>.<span class="s82">0097</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">7<i>e</i><span class="s86">−</span><span class="s87">4</span></p></td></tr><tr style="height:7pt"><td style="width:44pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s82" style="text-indent: 0pt;line-height: 5pt;text-align: center;">URL</p></td><td style="width:76pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">λ <span class="s82">= 0</span>.<span class="s82">2978</span>, k <span class="s82">= 2</span>.<span class="s82">2679</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">1<i>e</i><span class="s86">−</span><span class="s87">5</span></p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s83" style="text-indent: 0pt;line-height: 5pt;text-align: center;">α <span class="s82">= 0</span>.<span class="s82">6</span>, k <span class="s82">= 0</span>.<span class="s82">4199</span></p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s84" style="padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 6pt;text-align: center;">9<i>e</i><span class="s86">−</span><span class="s87">3</span></p></td></tr></table><p class="s6" style="padding-top: 3pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">1.0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">0.8</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s90" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">CDF</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">0.6</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">0.4</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">0.2</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">0.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 56pt;text-indent: 0pt;line-height: 118%;text-align: left;">Original empirical data Adjusted empirical data Kaplan-Meier estimate</p><p class="s6" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">0    5000   10000   15000</p><p style="padding-top: 7pt;padding-left: 60pt;text-indent: 44pt;text-align: left;"><a name="bookmark43">&zwnj;</a>Appendix A Workload Characterization<a name="bookmark46">&zwnj;</a></p><p style="padding-top: 3pt;padding-left: 15pt;text-indent: 0pt;text-align: left;">We provide further insights on the workload of our traces.</p><ol id="l6"><li data-list-text="A."><p class="s13" style="padding-top: 6pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark44">&zwnj;</a>Curve fitting</p><h1 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 8. <i>Does the time between sightings follow a power law?</i></h1><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark40" class="a">We plotted the complementary cumulative distribution func- tion (CCDF) of time between all sightings in our trace, and observed a linear decay typical of a power law </a><a href="#bookmark41" class="a">[12]. A similar power law behavior for time between security incidents was observed in </a>[13]. Motivated by these observations, we selected Pareto and Weibull distributions <u>&nbsp;t</u>o fit our data. The Pareto and Weibull CCDFs are given by <i>F </i>(<i>x</i>) = (<i>k/x</i>)<span class="s33">α</span><span class="s32"> </span>and</p><p class="s13" style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">F <span class="p">(</span>x<span class="p">) = </span>e<span class="s33">−</span><span class="s34">(</span><span class="s33">x/k</span><span class="s34">)</span><span class="s91">λ </span><a href="#bookmark42" class="a">, respectively. The parameters of the best fits for each category are listed in Table III, for the Pareto and Weibull fits. Table </a><span class="p">III also provides insight on the quality of fits. For instance, IOCs corresponding to hashes (MD5, SHA- 1 and SHA-256) tend to be better captured through a Weibull distribution as opposed to other IOCs (domains and IPs) that find a good fit under both Pareto and Weibull.</span></p><h1 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 8. <a href="#bookmark42" class="s92">The time between sightings follows a power law, whose parameters are presented in Table III.</a></h1></li><li data-list-text="B."><p class="s13" style="padding-top: 6pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark45">&zwnj;</a>Survival analysis</p></li></ol><h1 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Motivating question 9. <i>How to cope with the fact that many IOCs, for which the exact creation date is unknown, have their creation dates set at the very beginning of our trace?</i></h1><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark3" class="a">The creation dates of IOCs in our trace are lower bounded by September 9, 2018. Around 10% of the IOCs (533 IOCs) were created before that date, but are attributed such lower bound as a reference (see Figure </a>3). Under survival analysis, this sort of reference attribution is referred to as censoring. In what follows, we apply the standard Kaplan-Meier (KM) survival estimator to adjust the dataset, filling up missing data for creation dates that occurred before the reference.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark47" class="a">Figure </a>10 shows the results obtained through the KM estimator. The dotted blue line shows the empirical CDF of time to first sighting, and the red line shows the adjusted CDF obtained using the KM estimator. The green line corresponds to a simple heuristic, wherein for each IOC <i>i </i><a href="#bookmark47" class="a">for which the creation date equals the reference value of September 9, 2018, we replace its creation date by its first sighting minus 724 days, which corresponds to our trace duration. The rationale is that, for the oldest IOCs, the trace duration is a good proxy for the time until first sighting. Indeed, Figure </a>10 indicates that this</p><p class="s90" style="padding-left: 13pt;text-indent: 0pt;text-align: center;">Time from first sighting until creation (hours)</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark47">&zwnj;</a>Figure 10. CDF of time between creation and first sighting. In dotted blue, the empirical CDF; in red, the Kaplan-Meier (KM) estimator; in blue, a simple adjustment to the empirical values that produces results similar to KM.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">heuristic closely captures the behavior of KM, and we adopt it to reassess optimal TTL values in light of survival analysis, referring to it simply as KM.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;"><a href="#bookmark29" class="a">Figure </a>9 indicates how the adjustment of creation dates impacts optimal TTLs. Note that after distancing creation dates from the IOC first sighting, additional time is spent monitoring IOCs while no sightings are observed. This, in turn, makes monitoring less rewarding, favoring smaller TTL values.</p><h1 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding 9. <i>Survival analysis provides a methodology to cope with missing data, and alllows us to revisit the optimal TTL values in light of missing data. In particular, after filling up missing data, optimal TTL values increase, given that unknown creation dates occurred before the beginning of the trace.</i></h1><p style="padding-top: 5pt;padding-left: 13pt;text-indent: 0pt;text-align: center;"><a name="bookmark48">&zwnj;</a>Appendix B<a name="bookmark49">&zwnj;</a></p><p style="padding-left: 13pt;text-indent: 0pt;text-align: center;">Details on optimization problem</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">First, we consider the problem of determining an upper bound on the cost ratio <i>R</i><span class="s42">U</span><span class="s32"> </span><a href="#bookmark25" class="a">beyond which IOCs should never be monitored. Given </a>(12), the optimization problem is:</p><p class="s13" style="padding-top: 5pt;padding-left: 55pt;text-indent: 0pt;text-align: left;">R<span class="s42">U</span><span class="s32"> </span><span class="p">:Min </span>R</p><p style="padding-top: 3pt;padding-left: 74pt;text-indent: 0pt;text-align: justify;">Subject to</p><p class="s13" style="padding-top: 3pt;padding-left: 84pt;text-indent: 0pt;text-align: justify;"><span class="p">Argmin</span><span class="s67">T </span>R <span class="s32">· </span>g<span class="p">(</span>T <span class="p">) + </span>h<span class="p">(</span>T <span class="p">) = 0</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Note that <i>g</i>(0) = 0, therefore for <i>R &gt; R</i><span class="s42">U</span><span class="s32"> </span>we have <i>C </i>= <i>C</i><span class="s39">miss</span> <span class="s32">· </span><i>N</i><span class="s39">miss</span> = <i>C</i><span class="s39">miss</span> <span class="s32">· </span><i>h</i>(<i>T </i>). In the regime wherein monitoring costs are high, no IOCs are monitored and the ultimate cost depends only on the number of missed sightings.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Correspondingly, the optimization problem to determine a lower bound on the cost ratio <i>R</i><span class="s42">L</span><span class="s32"> </span>below which IOCs should always be monitored is:</p><p class="s13" style="padding-top: 5pt;padding-left: 54pt;text-indent: 0pt;text-align: left;">R<span class="s42">L</span><span class="s32"> </span><span class="p">:Max </span>R</p><p style="padding-top: 3pt;padding-left: 73pt;text-indent: 0pt;text-align: justify;">Subject to</p><p class="s52" style="text-indent: 0pt;line-height: 10pt;text-align: left;">-</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 4pt;padding-left: 83pt;text-indent: 0pt;text-align: justify;"><span class="p">Argmin</span><span class="s67">T </span>R <span class="s32">· </span>g<span class="p">(</span>T <span class="p">) + </span>h<span class="p">(</span>T <span class="p">) = </span>T</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;">no sightings are missed when <i>T </i>is set to <i>T</i><span class="s93">-</span>, condition <i>R &lt; R</i><span class="s42">L</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s52" style="text-indent: 0pt;line-height: 10pt;text-align: left;">-</p><p style="text-indent: 0pt;text-align: left;"/><p class="s52" style="text-indent: 0pt;line-height: 10pt;text-align: left;">-</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;line-height: 94%;text-align: justify;">where <i>T </i>is the maximum feasible TTL value. Under a trace- driven approach, <i>T </i><a href="#bookmark10" class="a">can be set as the maximum interval between sightings (see Section </a>III). Assuming <i>h</i>(<i>T</i><span class="s93">-</span>) = 0, i.e.,</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">implies that </span>C/C<span class="s39">miss</span><span class="p"> = </span>R <span class="s32">· </span>g<span class="p">(</span>T <span class="p">). In the regime wherein mon- itoring costs are low, all IOCs are monitored and the ultimate cost depends only on the product </span>C<span class="s39">mon</span><span class="p"> </span><span class="s32">· </span>N<span class="s39">mon</span><span class="p"> = </span>C<span class="s39">mon</span><span class="p"> </span><span class="s32">· </span>g<span class="p">(</span>T <span class="p">).</span></p></body></html>
