<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CyCon_2018_sisu.indd</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h4 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s1 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s2 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s3 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; }
 h2 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .p, p { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .a, a { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h1 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 13pt; }
 .s5 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; vertical-align: -1pt; }
 .s6 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 h3 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 .s7 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s8 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s9 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 2pt; }
 .s10 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, decimal)". "; color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 13pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3 {padding-left: 0pt;counter-reset: d1 1; }
 #l3> li>*:first-child:before {counter-increment: d1; content: counter(d1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l4 {padding-left: 0pt;counter-reset: e1 1; }
 #l4> li>*:first-child:before {counter-increment: e1; content: counter(e1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: e1 0;  }
 #l5 {padding-left: 0pt;counter-reset: e2 1; }
 #l5> li>*:first-child:before {counter-increment: e2; content: counter(e2, upper-roman)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: e2 0;  }
 #l6 {padding-left: 0pt; }
 #l6> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l7 {padding-left: 0pt; }
 #l7> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l8 {padding-left: 0pt;counter-reset: h1 1; }
 #l8> li>*:first-child:before {counter-increment: h1; content: counter(h1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l8> li:first-child>*:first-child:before {counter-increment: h1 0;  }
 #l9 {padding-left: 0pt;counter-reset: h2 1; }
 #l9> li>*:first-child:before {counter-increment: h2; content: counter(h2, decimal)") "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l9> li:first-child>*:first-child:before {counter-increment: h2 0;  }
 #l10 {padding-left: 0pt;counter-reset: i1 1; }
 #l10> li>*:first-child:before {counter-increment: i1; content: counter(i1, upper-roman)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l10> li:first-child>*:first-child:before {counter-increment: i1 0;  }
 #l11 {padding-left: 0pt; }
 #l11> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l12 {padding-left: 0pt;counter-reset: k1 1; }
 #l12> li>*:first-child:before {counter-increment: k1; content: counter(k1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: k1 0;  }
 #l13 {padding-left: 0pt;counter-reset: l1 1; }
 #l13> li>*:first-child:before {counter-increment: l1; content: counter(l1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: l1 0;  }
 #l14 {padding-left: 0pt; }
 #l14> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l15 {padding-left: 0pt;counter-reset: m1 1; }
 #l15> li>*:first-child:before {counter-increment: m1; content: counter(m1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 #l15> li:first-child>*:first-child:before {counter-increment: m1 0;  }
 #l16 {padding-left: 0pt; }
 #l16> li>*:first-child:before {content: "• "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 li {display: block; }
 #l17 {padding-left: 0pt;counter-reset: n1 1; }
 #l17> li>*:first-child:before {counter-increment: n1; content: "["counter(n1, decimal)"] "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 #l17> li:first-child>*:first-child:before {counter-increment: n1 0;  }
</style></head><body><h4 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">2018 10th International Conference on Cyber Conflict</h4><p class="s1" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">CyCon X: Maximising Effects</p><p class="s1" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">T. Minárik, R. Jakschis, L. Lindström (Eds.) 2018 © NATO CCD COE Publications, Tallinn</p><p class="s2" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Permission to make digital or hard copies of this publication for internal use within NATO and for personal or educational use when for non-profit or non-commercial purposes is granted providing that copies bear this notice and a full citation on the first page. Any other reproduction or transmission requires prior written permission by NATO CCD COE.</p><p class="s3" style="padding-top: 19pt;padding-left: 5pt;text-indent: 0pt;line-height: 90%;text-align: left;">FeedRank: A Tamper- resistant Method for the Ranking of Cyber Threat Intelligence Feeds</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Roland Meier</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">Department of Information Technology and Electrical Engineering</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;"><a href="mailto:meierrol@ethz.ch" class="a" target="_blank">ETH Zürich Zürich, Switzerland </a><a href="mailto:meierrol@ethz.ch" target="_blank">meierrol@ethz.ch</a></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">David Gugelmann <span class="p">Exeon Analytics Zürich, Switzerland</span></h2><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="mailto:david.gugelmann@exeon.ch">david.gugelmann@exeon.ch</a></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Laurent Vanbever</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">Department of Information Technology and Electrical Engineering</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;"><a href="mailto:lvanbever@ethz.ch" class="a" target="_blank">ETH Zürich Zürich, Switzerland </a><a href="mailto:lvanbever@ethz.ch" target="_blank">lvanbever@ethz.ch</a></p><h2 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Cornelia Scherrer</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">Department of Information Technology and Electrical Engineering</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">ETH Zürich Zürich, Switzerland</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="mailto:cornelia.scherrer@alumni.ethz.ch">cornelia.scherrer@alumni.ethz.ch</a></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">Vincent Lenders <span class="p">Science and Technology armasuisse</span></h2><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;"><a href="mailto:vincent.lenders@armasuisse.ch" class="a" target="_blank">Thun, Switzerland </a><a href="mailto:vincent.lenders@armasuisse.ch" target="_blank">vincent.lenders@armasuisse.ch</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Abstract: <span class="p">Organizations increasingly rely on cyber threat intelligence feeds to protect their infrastructure from attacks. These feeds typically list IP addresses or domains associated with malicious activities such as spreading malware or participating in a botnet. Today, there is a rich ecosystem of commercial and free cyber threat intelligence feeds, making it difficult, yet essential, for network defenders to quantify the quality and to select the optimal set of feeds to follow. Selecting too many or low- quality feeds results in many false alerts, while considering too few feeds increases the risk of missing relevant threats. Naïve individual metrics like size and update rate</span></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">give a somewhat good overview about a feed, but they do not allow conclusions about its quality and they can easily be manipulated by feed providers.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this paper, we present FeedRank, a novel ranking approach for cyber threat intelligence feeds. In contrast to individual metrics, FeedRank is robust against tampering attempts by feed providers. FeedRank’s key insight is to rank feeds according to the originality of their content and the reuse of entries by other feeds. Such correlations between feeds are modelled in a graph, which allows FeedRank to find temporal and spatial correlations without requiring any ground truth or an operator’s feedback.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">We illustrate FeedRank’s usefulness with two characteristic examples: <i>(i) </i>selecting the best feeds that together contain as many distinct entries as possible; and <i>(ii) </i>selecting the best feeds that list new entries before they appear on other feeds. We evaluate FeedRank based on a large set of real feeds. The evaluation shows that FeedRank identifies dishonest feeds as outliers and that dishonest feeds do not achieve a better FeedRank score than the top-rated real feeds.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Keywords: <i>cyber threat intelligence, intelligence feeds, cyber attacks, malware, botnets, situational awareness</i></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="1."><h1 style="padding-left: 20pt;text-indent: -14pt;text-align: left;">IntroductIon</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">States, organizations, companies and individuals are faced with ever-growing cyber threats. The most prominent among these threats include phishing or spam campaigns, malware distribution and DDoS attacks [1] [2]. To mitigate these threats, Cyber Threat Intelligence Feeds (CTIFs, also known as blacklists or block lists) are a major source of information for most network defenders [3]. The CTIF ecosystem is currently very large and complex [4] and for reliable protection, network defenders need to correlate data from multiple CTIFs [1].</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">However, while selecting the best set of CTIFs is crucial to maximizing efficiency, it is also difficult as there is no easy way to objectively compare CTIFs. In fact, network defenders often only evaluate feeds individually based on naïve metrics such as the feed’s size. While these metrics allow for a rough assessment, they do not allow conclusions about the combination of multiple feeds and – as we will show in this paper – they are easy to manipulate for a dishonest CTIF provider in order to pretend a higher quality and thus increase its impact and revenue.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;"><b>Problem statement. </b>In this paper, we address the problem of finding an objective, tamper-resistant ranking algorithm that allows well-grounded selections of high quality CTIFs. We determine the quality of a feed by three key properties: <i>completeness, accuracy </i>and <i>speed</i>. That is, an ideal CTIF lists all malicious entities, does not list non-malicious entities and updates its entries promptly. In particular, we address the following research questions:</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><ul id="l2"><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">How can the quality of a CTIF be estimated in a robust and scalable way? Achieving this is challenging because there is no ground truth to compare it with. Hence, one cannot rely on standard metrics such as precision and recall.</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">How can the structure of the CTIF ecosystem be evaluated and how do existing CTIFs differ in terms of completeness, accuracy and speed? In particular, do CTIF providers cluster in groups or is there a large diversity regarding the reported threats among the different providers?</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">Can we identify individual CTIFs that consistently outperform others and CTIFs that seem to lack behind or borrow information from other feeds? Specially, what are good metrics to identify outperformers and tampering- attempts by a subset of the feeds?</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">FeedRank. <span class="p">We present FeedRank, a novel metric for the ranking of CTIFs. The key idea behind FeedRank is to model the correlations between CTIFs as a graph and to obtain the ranking by applying algorithms to this graph. This way, FeedRank quantifies the relative performance among CTIFs and is able to evaluate the quality of feeds without a ground truth. At its core, FeedRank bears similarities with collective intelligence approaches or PageRank [5], an algorithm to rank websites that is used by Google.</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">The setting for ranking CTIFs bears similarities with the ranking of websites by search engines in the following aspects:</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: left;">Websites can contain arbitrary content (including dummy keywords to improve their ranking).</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -17pt;text-align: left;">Websites can contain links to any other website.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">There is no ground truth for the quality of websites.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">A website to which many other websites refer to is likely to be important.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Similar properties hold for CTIFs:</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">CTIFs can contain arbitrary entries.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">CTIFs can copy entries from any other CTIF.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">There is no ground truth for the quality and validity of CTIF entries.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">A CTIF whose entries appear in other CTIFs is likely to be of high quality.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Despite these similarities, applying website ranking algorithms (such as PageRank) to CTIFs is challenging because of the particular semantic of the CTIF application domain. The key idea to apply website ranking algorithms to CTIFs is to model correlations between CTIFs in a graph. In particular, while PageRank uses the web graph (a graph that models the links between websites), FeedRank uses a correlation graph to model common entries in CTIFs and the time at which they appear in each of the considered CTIFs. The correlation graph provides us with the foundation to assess a CTIF’s quality as we argue that a CTIF whose entries later appear on many other feeds has a high quality (like a website with many incoming links is assumed to be important). However, since the correlation graph alone does not allow conclusions about the completeness of a particular CTIF, FeedRank also performs an analysis of the contribution of each CTIF.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Contributions. <span class="p">The main contributions of this paper are:</span></h2></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">A tamper-resistant approach to rank CTIFs at scale (Section 3) based on:</p><p class="s5" style="padding-top: 1pt;padding-left: 43pt;text-indent: 0pt;text-align: left;">°  <span class="p">correlations between CTIFs (Section 3B); and</span></p><p class="s5" style="padding-left: 43pt;text-indent: 0pt;text-align: left;">°  <span class="p">the individual contribution of each CTIF (Section 3C).</span></p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: left;">A comprehensive evaluation based on large sets of freely available CTIFs (Section 4).</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -17pt;text-align: left;">Two case-studies to demonstrate useful use-cases of FeedRank (Section 5).</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li data-list-text="2."><h1 style="padding-left: 20pt;text-indent: -14pt;line-height: 87%;text-align: justify;">eValuatIng cyber threat IntellIgence feeds</h1><p style="padding-top: 14pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we provide an overview over Cyber Threat Intelligence Feeds (CTIFs) and identify key properties that characterize good CTIFs, sketch traditional evaluation metrics and identify strategies for how dishonest CTIF providers can tamper with them.</p><ol id="l3"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Cyber Threat Intelligence Feeds</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In general, CTIFs are collections of <i>Indicators of Compromise </i>(IOC) that characterize malicious or non-malicious endpoints or activities. In this paper, we focus on feeds that list IP addresses associated with malicious activities (such as sending spam or hosting phishing sites). However, the obtained results are also applicable to other types of feeds.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">CTIFs are available from a variety of commercial and non-commercial providers and can cover one or multiple types of threats (e.g. spam or phishing). The feeds are typically provided in real time; that is, the contents are updated continuously or with a certain frequency. New entries may be added when, for example, an endpoint is</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">found to behave maliciously and removed if the malicious activity has stopped. CTIFs obtain information about malicious endpoints in various ways. For example, malicious activity can be detected by email providers, honeypots, CERTs or by manual reports from users. CTIFs can also copy or fuse information from other CTIFs.</p></li><li data-list-text="B."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Properties of High Quality Feeds</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">An ideal CTIF is complete, accurate and fast. To be <i>complete</i>, the CTIF needs to contain all malicious endpoints at a given time. To be <i>accurate</i>, the CTIF must not list benign endpoints. To be fast, the completeness and accuracy property must hold at any given point in time, i.e., an endpoint must appear exactly during the time it behaves maliciously. This ideal state is obviously difficult to reach in practice, as there always exist malicious endpoints that have not yet been identified as such.</p></li><li data-list-text="C."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -14pt;text-align: justify;">Individual Feed Metrics</p></li></ol><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Naïve metrics which evaluate each CTIF individually are easy to calculate and widely used. Examples of such individual metrics include the feed’s size, the update frequency and the number of entries that are added or removed (cf. Table I). However, a major problem with individual metrics is that they provide little insight about the quality of a CTIF without a ground truth (i.e. a way to objectively verify the correctness of the feed’s contents). Even worse, all the listed individual metrics can easily be manipulated by adding or removing entries to/from a CTIF (cf. Table I).</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">With FeedRank, we present an advanced and tamper-resistant ranking metric that does not require a ground truth. As we will describe in the following sections, analyzing the correlations of CTIFs allows reasoning about the feed’s completeness, accuracy and speed.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE I: <span class="s7">EXAMPLES OF INDIVIDUAL FEED METRICS. THESE METRICS DO NOT ALLOW CONCLUSIONS ABOUT A FEED’S QUALITY AND CAN BE MANIPULATED BY THE FEED PROVIDER.</span></h3></li><li data-list-text="3."><h1 style="padding-top: 2pt;padding-left: 20pt;text-indent: -14pt;text-align: justify;">feedranK</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we present the design goals and an overview of FeedRank. Further, we describe the two core components of FeedRank in more detail and explain why FeedRank is robust against tampering attempts.</p><ol id="l4"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Overview</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">FeedRank allows us to identify high quality CTIFs, while at the same time being robust against tampering attempts from CTIF providers, by combining the contribution analysis and the correlation graph (see Table II).</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">TABLE II: <span class="s7">KEY PROPERTIES OF HIGH QUALITY CTIFS AND HOW THEY ARE REPRESENTED IN FEEDRANK.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">FeedRank operates in three steps (see Figure 1). First, it collects snapshots of considered CTIFs; second it builds a feed correlation graph and performs a contribution analysis; and third, it computes a score for each considered CTIF.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">FIGURE 1: <span class="s7">FEEDRANK OPERATES IN THREE STEPS: IT COLLECTS SNAPSHOTS OF CTIFS, COMPUTES A CORRELATION GRAPH AND A CONTRIBUTION ANALYSIS AND OUTPUTS A RANKING.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l5"><li data-list-text="I."><h2 style="padding-left: 15pt;text-indent: -9pt;line-height: 112%;text-align: justify;">Feed Collection. <span class="p">As an input, FeedRank requires at least two snapshots of each considered feed. A snapshot consists of the timestamp and all entries of a CTIF. For the most accurate results, the time between the two snapshots should be long enough such that all CTIFs provide an update of the entries. The set of considered feeds can</span></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">be specified by the operator who uses FeedRank. It should contain all the CTIFs that the operator considers using in their environment.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="II."><h2 style="padding-left: 19pt;text-indent: -13pt;line-height: 112%;text-align: justify;">a) Correlation Graph. <span class="p">Based on the snapshots, FeedRank builds a correlation graph. The nodes in this graph correspond to the CTIFs and the (directed) edges represent correlations between them.</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">II. b) Contribution Analysis. <span class="p">For each CTIF, FeedRank computes a contribution metric that measures the CTIF’s contribution to the total number of listed entries.</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">III. Feed Rating. <span class="p">FeedRank runs an algorithm similar to PageRank on the correlation graph. This, together with the results from the contribution analysis, assigns each feed a score and allows to rank them.</span></h2></li></ol></li><li data-list-text="B."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Correlation Graph</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The correlation graph is used to model correlations between CTIFs. It is a directed graph where the vertices represent feeds and the weighted edges describe correlations between them. Two CTIFs (X and Y) are connected with a directed edge from X to Y if X contains entries that were contained in Y before they appeared in X. This means that X implicitly confirms the respective entries from Y. In other words: both feeds classify the entries as malicious, and Y was faster in listing them, which makes it more likely that Y is accurate with respect to these entries.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The weight of this edge is determined by the percentage of entries that appear first in Y and are later mentioned by X. For example, if Y contains 20 entries and 10 of them appear later on X, the weight of the edge would be 50% as this is the percentage of entries in Y that were confirmed by X.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Figure 2 illustrates an example of a correlation graph with 3 feeds with the following characteristics:</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><ul id="l6"><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: left;">B confirms 100% of the entries in A (i.e. every entry that appears in A later appears in B)</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: left;">C confirms 10% of the entries in A and 20% of the entries in B (i.e. 10% of the entries in A and 20% of the entries in B appear later in C)</p></li></ul><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this example, feed A achieves the highest score according to the correlation graph and would thus be considered as the most valuable feed. The intuitive explanation for this is that all of A’s entries are confirmed by B and no other feed is faster than A.</p><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">FIGURE 2: <span class="s7">EXAMPLE OF THE FEEDRANK GRAPH METRIC. IT RANKS FEEDS ACCORDING TO THE AMOUNT OF ENTRIES THAT ARE CONFIRMED BY OTHER FEEDS (E.G. B CONFIRMS 100% OF THE ENTRIES IN A).</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">To determine a ranking of CTIFs in the correlation graph, we apply the PageRank algorithm [5]. PageRank is a ranking algorithm for websites (famously used by Google) and is based on a graph that models the hyperlinks between websites. Besides the web graph, PageRank requires two additional parameters: the damping factor and a convergence condition.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The damping factor <i>d </i>in PageRank describes the probability with which a user browsing at a certain website will click on any of the links to visit another website. For FeedRank, we calculate the damping factor depending on the average path length <i>l </i>(i.e., the average number of CTIFs that subsequently list an entry) of all entries that appear in at least two CTIFs within the analyzed dataset. From <i>l</i>, we calculate the probability that an entry “propagates” to another feed – along the lines of a user that clicks on a link to move to another website – as:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Being an iterative algorithm, PageRank further requires a convergence condition. The convergence condition in PageRank specifies the maximal delta between the graph score of all nodes (i.e. the precision of the result).</p></li><li data-list-text="C."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -14pt;text-align: justify;">Contribution Analysis</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The contribution metric is the result of the contribution analysis and measures the relative contribution of a single CTIF compared to the complete set of analyzed feeds. Therefore, it provides the foundation to select a subset of the analyzed feeds that together have a maximal contribution.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">FeedRank’s contribution analysis works as follows. First, it computes the complete set of all listed entries, i.e., the union of all entries listed in the considered feeds at any of the recorded snapshots. For each entry, it determines the feed that listed the entry first, and assigns the entry to that feed. In case multiple feeds add an entry at the same time, the entry is assigned to the biggest feed. The resulting contribution metric is then computed as the percentage of entries that each feed contributes to the complete set.</p></li><li data-list-text="D."><p class="s6" style="padding-top: 3pt;padding-left: 20pt;text-indent: -14pt;text-align: left;">Tamper-resistance</p></li></ol><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we explain why FeedRank is robust against an unfair CTIF which tries to manipulate its rank. Since a CTIF provider can arbitrarily choose the contents of its feed, there are no guarantees about the validity of entries.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">At a high level, we distinguish between the following tampering strategies:</p><ul id="l7"><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Adding entries that are not contained in the original CTIF.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Removing of entries from the original CTIF.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Replacing existing entries by other values (i.e. pretend updates).</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">For each of these strategies, the dishonest CTIF provider needs to choose the entries that will be added or removed. This can be done in at least the following ways:</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">At random: New entries are generated randomly and randomly chosen entries are removed from the feed.</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">Based on the contents of another CTIF: A dishonest CTIF can copy a subset or all entries from one or multiple other CTIFs and thus copy the behavior of these CTIFs.</p></li></ul><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The manipulation strategies mentioned above work well for individual metrics (as described in Section 2. C) but, as we explain in the following, they do not work with FeedRank.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">A dishonest CTIF that tries to manipulate its FeedRank score by adding entries is not successful because: <i>(i) </i>if the added entries are chosen randomly, they will not be confirmed by other feeds with very high probability; <i>(ii) </i>if the added entries are copied from another CTIF, this is considered as if the dishonest feed confirms the other feed’s entries and can therefore help the other feed, but not the dishonest feed. Obviously, a feed that copies entries from another feed is always slower in listing these entries. If a dishonest CTIF tries to improve its score by removing entries, each of the removed entries is either of high quality (i.e. it is confirmed by other feeds) or of low quality (it does not appear on other feeds). If a CTIF removes high quality entries, this lowers its ranking because a smaller percentage of its entries are confirmed. If it removes low quality entries, its overall quality increases and it (deservedly) obtains a better ranking.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">A dishonest CTIF that both adds and removes entries faces the union of the limitations mentioned above. FeedRank does not measure the update frequency of CTIFs and therefore a higher update frequency does not help to improve the score. Instead, FeedRank is run with a certain frequency and based on the feed’s contents at the time of execution. Therefore, as long as the update frequency of a CTIF is larger than or</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">equal to the execution frequency of FeedRank, increasing the update frequency does not change the FeedRank score.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">While FeedRank is robust against a small percentage of dishonest CTIFs, it can be susceptible to manipulation attempts by many colluding CTIFs. However, this is hardly feasible in practice because it would require many CTIFs to become dishonest and it only works if the user considers all of them when running FeedRank (it is easy for a single entity to publish a large number of dishonest feeds, but it is unlikely that a user would consider all of them). Such a set of colluding CTIFs can be identified by doing basic cluster analysis based on the considered feeds and the correlation graph (we show this in Section 4B).</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4."><h1 style="padding-left: 20pt;text-indent: -14pt;text-align: justify;">eValuatIon</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we use real CTIFs to compare FeedRank with individual metrics and show its tamper-resistance. In the following subsections, we describe and visualize the dataset and show the evaluation results.</p><ol id="l8"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Dataset and Methodology</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">To evaluate FeedRank, we use both real CTIFs which we collected over a timespan of almost 12 days and synthetic CTIFs with which we simulated the impact of tampering strategies. Below, we provide more details about both types of feeds.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l9"><li data-list-text="1)"><p class="s8" style="padding-left: 16pt;text-indent: -10pt;text-align: justify;">Collecting Real Feeds</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">For a comprehensive dataset, we fetched the feeds listed in Table III at regular intervals (60 min) during almost 12 days in 2017. In this way, we obtained 277 snapshots representing the activity of 27 feeds with a total of around 40 million entries. These snapshots allowed us to analyze correlations between feeds at a granularity of an hour. Some of the snapshots were incomplete because our collection infrastructure was unable to fetch them due to connectivity issues, database overload or rate limiting by the CTIF provider. The feed collection functionality was implemented in Python on top of the stix [6] and libtaxii [7] modules. The collected feeds were normalized and stored in an Elasticsearch database to facilitate analysis. We anonymized the feeds as it is not our goal to provide a ranking of particular feed providers, but to demonstrate the practicality of our algorithm.</p><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">TABLE III: <span class="s7">EVALUATED FEEDS. WE ANALYZE 27 FREELY AVAILABLE CTIFS (LISTED IN ALPHABETICAL ORDER HERE).</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2)"><p class="s8" style="padding-left: 16pt;text-indent: -10pt;text-align: justify;">Generating Dishonest Feeds</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">To capture the effect of dishonest feeds, we considered two strategies: listing random entries and imitating high-ranked feeds.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l10"><li data-list-text="I."><h2 style="padding-left: 14pt;text-indent: -8pt;line-height: 112%;text-align: justify;">Adding random entries: <span class="p">Adding random entries is a straightforward approach for a dishonest feed to improve its rank because it makes the feed appear larger and more up-to-date. Particularly because random entries are unlikely to be contained in other feeds, thus the tampering feed is the first to report them.</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Adding random entries can be risky for a CTIF provider as it can increase the false positive rate, especially if an entry maps to a popular non-malicious service. However, by choosing unused (or rarely used) IP addresses or domains, a dishonest CTIF provider can cheat with a low risk of being detected.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">We call a synthetic feed that follows such a strategy “RandomFeed” and generate it by choosing 50k IP addresses uniformly at random at each time unit (i.e. 1 hour).</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="II."><h2 style="padding-left: 21pt;text-indent: -16pt;line-height: 112%;text-align: justify;">Copying entries from high-reputation feeds: <span class="p">For this case, we generate “CopyFeed” by assuming that it copies all entries from the two best-ranked feeds with a delay of one time unit (i.e. 1 hour). By doing so, CopyFeed becomes the most complete feed but it lacks speed as it is never the first to announce any entry.</span></h2></li></ol><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="3)"><p class="s8" style="padding-left: 16pt;text-indent: -10pt;text-align: justify;">Parameters</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">PageRank, which is part of the graph ranking, requires the specification of a damping factor and a convergence condition. As we explained in Section 3B, we compute the damping factor as <i>d</i>=1-1/<i>l </i>where <i>l </i>is the average path length. For the evaluated dataset, the average path length is 2.87, which leads to a damping factor of 0.65. For the convergence condition, we choose a maximum delta (i.e. the precision of the results) of 10<span class="s9">-6</span>.</p></li></ol></li><li data-list-text="B."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">FeedRank Dataset Baseline</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we illustrate our dataset and the input of FeedRank with Figure 3 and Figure 4 after listing basic properties of each analyzed CTIF in Table IV.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE IV: <span class="s7">SIZE OF THE EVALUATED CTIFS.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">For a first insight in correlations in our dataset, we use Figure 3 to visualize a clustering of the evaluated feeds according to the number of common entries. That is, we run the Stoer-Wagner HCS (highly connected subgraphs) clustering algorithm [8] on a graph where the nodes represent feeds and the edges connect feeds with common entries</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">and are assigned a weight that equals the number of common entries. In Figure 3, we observe four clusters:</p><ul id="l11"><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -17pt;text-align: justify;">One big cluster containing 7 (out of 27) feeds of different providers.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: justify;">Two smaller clusters consisting of 2 and 3 feeds from the same provider.</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">One small cluster of two feeds (F11 and F15) where the number of common elements corresponds to the size of the smaller feed. This depicts an example of a feed (F15) that most likely contains a subset of the entries from another feed (F11).</p></li></ul><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Even though this clustering is not directly contained in the FeedRank algorithm, it shows that there are indeed correlations between the analyzed feeds.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In Figure 4, we show the correlation graph for the evaluated feeds. As explained in Section 3. B, this graph consists of nodes representing the feeds and directed, weighted edges that describe the percentage of confirmed entries from another feed.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">FIGURE 3: <span class="s7">EVALUATED FEEDS CLUSTERED BY THE NUMBER OF COMMON ELEMENTS. ABOUT 25% OF ALL FEEDS ARE CONTAINED IN ONE CLUSTER. FEEDS FROM THE SAME PROVIDERS ARE CONTAINED IN SMALLER CLUSTERS AND F15 DOES NOT LIST ELEMENTS THAT ARE NOT IN F11.</span></h3><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">FIGURE 4: <span class="s7">CORRELATION GRAPH FOR THE EVALUATED FEEDS. AS AN EXAMPLE, THE LARGEST FEED (F1) AND ALL ITS IN- AND OUTGOING EDGES ARE HIGHLIGHTED. THE EDGE LABEL DENOTES THE PERCENTAGE OF ENTRIES THAT A FEED CONFIRMS.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="C."><p class="s6" style="padding-left: 19pt;text-indent: -14pt;text-align: justify;">FeedRank vs. Individual Metrics</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this experiment, we compare the ranking obtained by individual metrics with the ranking according to FeedRank (see Table V). In Table VI, we show the ranking for all real feeds. The listed overall rank corresponds to the ranking according to the combination of all individual (or FeedRank) metrics. In this non-malicious case, we observe that the ranking according to the two metrics are strongly correlated (with a Spearman correlation coefficient of <i>ρ </i>= 0.81).</p><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">TABLE V: <span class="s7">EVALUATED FEED METRICS.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>TABLE VI: </b>RANKING WITH INDIVIDUAL METRICS COMPARED WITH FEEDRANK. THE RANKINGS ARE STRONGLY CORRELATED (<i>ρ </i>= 0.81).</p></li><li data-list-text="D."><p class="s6" style="padding-top: 3pt;padding-left: 20pt;text-indent: -14pt;text-align: left;">Tamper-resistance</p></li></ol><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this experiment, we evaluate the impact of RandomFeed and CopyFeed on the ranking. As the results in Table VII show, the dishonest feeds can obtain very good ranks (rank 1 for RandomFeed and rank 3 for CopyFeed) according to individual metrics, but not for FeedRank (rank 16 and 20).</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE VII: <span class="s7">RANKING IN THE PRESENCE OF DISHONEST FEEDS. RANDOMFEED AND COPYFEED CAN TAMPER WITH WITH INDIVIDUAL METRICS, BUT NOT WITH FEEDRANK.</span></h3></li><li data-list-text="5."><h1 style="padding-top: 2pt;padding-left: 20pt;text-indent: -14pt;text-align: justify;">case-study</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we come back to the two use-cases mentioned initially – network defenders that want to: <i>(i) </i>select the best feeds that together contain as many distinct entries as possible; and <i>(ii) </i>select the best feeds that list new entries before they appear on other feeds.</p><ol id="l12"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Prioritizing Completeness</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">To find a set of CTIFs that covers as many entries as possible (i.e. is as complete as possible) while not being susceptible to tampering attempts, FeedRank is used as follows. First, we compute the ranking solely according to the contribution. Since this ranking ignores the correlations, it is not tamper resistant and a CTIF that adds random entries can achieve a good rank. In a second step, we ensure tamper-resistance by excluding CTIFs whose graph score is below a user-defined percentile. Intuitively, the choice of this percentile reflects how many dishonest feeds the user expects. Here, we use the fifth percentile; that is, we assume that feeds whose graph metric is in the upper 95% are non-malicious.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In Figure 5, we plot the contribution of all collected CTIFs. As the figure shows, considering a small subset of all feeds is enough to cover a large percentage of all entries (e.g. the best 5 feeds together cover 80% of all entries). The figure also shows that by only looking at a feed’s size it is not possible to derive the feed’s contribution.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">FIGURE 5: <span class="s7">CONTRIBUTION OF ALL EVALUATED CTIFS. SELECTING 5 FEEDS IS ENOUGH TO COVER 80% OF ALL REPORTED IPS.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">In Tables VIII and IX, we show the ranking in the presence of dishonest feeds.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">RandomFeed has a high contribution score because its entries are most likely not listed on any other feed. However, because the vast majority of them are not confirmed by</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">any other feed, the graph score is very low. In particular, the graph score is below the 5th percentile, which is why the feed is not eligible to be used. CopyFeed has a poor contribution score because it is never the first feed to list any entry. However, because the copied entries originate from highly ranked feeds, CopyFeed deservedly achieves a good graph score.</p><h3 style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE VIII: <span class="s7">RANKING ACCORDING TO THE CONTRIBUTION METRIC IN THE PRESENCE OF RANDOMFEED. THE GRAPH METRIC IS USED TO EXCLUDE POTENTIALLY DISHONEST FEEDS.</span></h3><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE IX: <span class="s7">RANKING ACCORDING TO THE CONTRIBUTION METRIC IN THE PRESENCE OF COPYFEED. THE GRAPH METRIC IS USED TO EXCLUDE POTENTIALLY DISHONEST FEEDS.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="B."><p class="s6" style="padding-left: 19pt;text-indent: -13pt;text-align: justify;">Prioritizing Speed</p></li></ol><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this case study, a network defender wants to select CTIFs such that new entries are available as early as possible. For this, we rank the feeds according to the graph metric (that is, we ignore the contribution). FeedRank’s correlation graph models the order in which entries appear in the feeds. Therefore, a feed that scores well in the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">graph metric is one that is fast in including new entries. In contrast to computing the added entries for each feed individually, FeedRank ensures that it is impossible for a dishonest feed to tamper with the ranking.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In Table X, we show the resulting ranking with and without the dishonest feeds. RandomFeed appears at the very end of the ranking because its entries are not confirmed by other feeds. CopyFeed achieves a better rank because it copies the entries of highly ranked feeds with only a one-hour delay. By doing so, it is faster in listing these entries than other feeds that confirm the entries later.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">TABLE X: <span class="s7">RANKING ACCORDING TO THE GRAPH METRIC TO SELECT THE</span></h3><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">FASTEST FEEDS. THE DISHONEST FEEDS CANNOT ACHIEVE TOP RANKINGS.</p></li><li data-list-text="6."><h1 style="padding-top: 2pt;padding-left: 20pt;text-indent: -14pt;text-align: justify;">dIscussIon</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In this section, we first summarize the answers to the research questions, then discuss additional aspects of and choices that we made in the design of FeedRank.</p><ol id="l13"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Research Questions</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Our research questions listed in Section 1 relate to the estimation of the quality of CTIFs, the CTIF ecosystem and the tamper-resistance of the evaluation metrics.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">CTIF quality estimation. <span class="p">We use a graph-based correlation analysis together with a contribution analysis to measure correlations between CTIFs and the individual contribution of each CTIF. This allows us to estimate the relative quality of each CTIF with respect to all other analyzed CTIFs without requiring a ground truth.</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">CTIF ecosystem. <span class="p">Our correlation analysis allows finding clusters of highly correlated CTIFs and shows that most of the evaluated feeds are contained in the same cluster (i.e. most of the feeds overlap in terms of their entries but differ in terms of speed).</span></h2><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Tamper resistance. <span class="p">Our evaluation shows that correlation and contribution are tamper-resistant metrics for ranking CTIFs. While FeedRank produces a ranking that is strongly correlated with the ranking according to individual metrics in the absence of dishonest feeds, only FeedRank allows to identify dishonest feeds and to prevent them from achieving a good rank.</span></h2></li><li data-list-text="B."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Speed of Dishonest Feeds vs. Execution Interval of FeedRank</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">For our evaluation, we use hourly snapshots and assume that the dishonest CopyFeed copies entries with a delay of one hour. If the delay were to be shorter than the snapshot interval, FeedRank could not determine whether CopyFeed and the two copied (legitimate) feeds listed the entries simultaneously or not. To prevent this inaccuracy, we envision the following mechanisms:</p><ul id="l14"><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">The time between two snapshots can be decreased, which makes it more likely to be faster than dishonest feeds.</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">CTIF providers can provide FeedRank with exclusive access to updates shortly before they are published.</p></li><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -18pt;line-height: 112%;text-align: justify;">CTIF providers can add a few random (non-malicious and inactive) entries to their feeds to detect if another feed copies them (if these entries appear on another feed, it is highly likely that they were copied).</p></li></ul></li><li data-list-text="C."><p class="s6" style="padding-top: 3pt;padding-left: 19pt;text-indent: -14pt;text-align: justify;">Evaluating CTIFs Instead of Evaluating Entries in CTIFs</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">With FeedRank, we assess the quality of CTIFs as a whole and not the quality of individual entries. With this, FeedRank provides the foundation to select CTIFs for deployment. The problem of evaluating the quality of particular entries is orthogonal to our work, but could be approached with a similar technique (e.g. by building a graph that models individual entries). From a network defender’s point of view, the advantages of scoring threat intelligence at the level of CTIFs instead of individual entries are that: <i>(i) </i>reporting an IOC is delayed if an entry first needs to be verified by multiple feeds; and <i>(ii) </i>scoring CTIFs can be done once before deciding which feeds to use, which reduces operational and potential subscription costs.</p></li><li data-list-text="D."><p class="s6" style="padding-top: 11pt;padding-left: 20pt;text-indent: -14pt;text-align: justify;">Choice of the Evaluated Feeds</p></li></ol><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">For our evaluation, we used a generic threat model and included a large set of freely available feeds covering different domains (e.g. generic, malware or phishing). Generally speaking, the set of considered CTIFs should contain all feeds that are suitable for the network defender’s purpose. For example, a network defender that wants to select CTIFs for a spam filter should only consider feeds in this domain to get the most meaningful results.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Evaluating CTIFs for a more specific threat model or including commercial feeds is possible without modifying FeedRank but it is out of the scope of this paper.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="7."><h1 style="padding-left: 20pt;text-indent: -14pt;text-align: justify;">related worK</h1><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">To the best of our knowledge, we are the first to rank CTIFs based on their correlations and to consider potential manipulation strategies from CTIF providers. However, there has been previous work in the area of evaluating CTIFs and applying graph- based ranking algorithms in other domains.</p><ol id="l15"><li data-list-text="A."><p class="s6" style="padding-top: 11pt;padding-left: 18pt;text-indent: -13pt;text-align: justify;">Analysis and Evaluation of CTIFs</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Sheng et al. study the effectiveness of phishing blacklists [9] and find that blacklists are ineffective when protecting users against phishing attacks because most phishing campaigns only last for a short time and blacklists are too slow in reacting.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Kührer and Holz describe a CTIF parser system [10] that records a large number of CTIFs and allows users to compute intersections between feeds and to query entries (e.g. domains). Entries that are contained in a large number of feeds are considered as being dishonest with high certainty. In later work [11], Kührer et al. propose a mechanism to identify parked domains and sinkholes (i.e. malicious domains that are identified and mitigated) in CTIFs.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Metcalf and Spring present an analysis of CTIFs over multiple years [12]. Similar to our approach, they analyze individual and combined features of CTIFs. However, they do not address the issue of dishonest CTIF providers that attempt to manipulate the rankings.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The Ponemon Institute found in a survey [3] that the application of threat intelligence is considered as very important for running secure systems but they did not investigate in the quality or the ecosystem of threat intelligence providers.</p></li><li data-list-text="B."><p class="s6" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Graph-based Ranking</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">Page and Brin developed PageRank to rank websites [5]. They showed that the problem of ranking websites can be transferred to a graph problem and thus provided the foundation of transferring problems with several connected parties to graph problems.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: left;">Since then, concepts similar to PageRank have been applied to various problems, including to:</p><ul id="l16"><li data-list-text="•"><p style="padding-left: 43pt;text-indent: -17pt;text-align: left;">Predict future relevance of scientific articles [13].</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Rank authors and publications [14].</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Rank correspondents according to their degree of expertise [15].</p></li><li data-list-text="•"><p style="padding-top: 1pt;padding-left: 43pt;text-indent: -17pt;text-align: left;">Find influential users [16] and important content [17] in social networks.</p></li></ul></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="8."><h1 style="padding-left: 20pt;text-indent: -14pt;text-align: justify;">conclusIon and future worK</h1></li></ol><p style="padding-top: 13pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">The core concept of FeedRank is to model temporal correlations between feeds in a graph structure and to rank feeds based on this graph and the individual contribution of each feed. In contrast to traditional metrics that are applied to feeds individually, FeedRank is robust against tampering attempts by potentially dishonest feed providers.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">In the evaluation and two case studies, we use data from 27 real feeds and show that FeedRank allows a reliable ranking even in the presence of dishonest feeds. For future work, we suggest using FeedRank to track the rankings of CTIFs over time. This will provide insights in the long-term behavior of CTIFs. Further, FeedRank could be extended by additional metrics and applied to related problems such as the evaluation of single entries in CTIFs.</p><h1 style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">references</h1><ol id="l17"><li data-list-text="[1]"><p class="s7" style="padding-top: 12pt;padding-left: 23pt;text-indent: -17pt;text-align: left;">D. Shackleford, “Who’s Using Cyberthreat Intelligence and How?,” SANS Survey, 2015.</p></li><li data-list-text="[2]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">Symantec, “Internet Security Threat Report,” Bd. 22, 2017.</p></li><li data-list-text="[3]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">“The Value of Threat Intelligence: The Second Annual Study of North American &amp; United Kingdom Companies,” Ponemon Institute, 2017.</p></li><li data-list-text="[4]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">H. Slatman, “awesome-threat-intelligence,” [Online]. Available: https://github.com/hslatman/awesome- threat-intelligence.</p></li><li data-list-text="[5]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">L. Page, S. Brin, R. Motwani and T. Winograd, “The PageRank Citation Ranking: Bringing Order to the Web.,” Stanford InfoLab, 1999.</p></li><li data-list-text="[6]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">“python-stix,” [Online]. Available: https://github.com/STIXProject/python-stix.</p></li><li data-list-text="[7]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">“libtaxii,” [Online]. Available: https://github.com/TAXIIProject/libtaxii.</p></li><li data-list-text="[8]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">M. Stoer and F. Wagner, “A Simple Min Cut Algorithm,” <i>Journal of the ACM (JACM)</i>, Bd. 44, Nr. 4, pp. 585-591, 1997.</p></li><li data-list-text="[9]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">S. Sheng, B. Wardman, G. Warner, L. F. Cranor, J. Hong and C. Zhang, “An Empirical Analysis of Phishing Blacklists,” in <i>Proceedings of Sixth Conference on Email and Anti-Spam (CEAS)</i>, 2015.</p></li><li data-list-text="[10]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">M. Kührer and T. Holz, “An Empirical Analysis of Malware Blacklists,” <i>PIK-Praxis der Informationsverarbeitung und Kommunikation 35.1</i>, pp. 11-16, 2012.</p></li><li data-list-text="[11]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">M. Kührer, C. Rossow and T. Holz, “Paint It Black - Evaluating the Effectiveness of Malware Blacklists,”</p><p class="s7" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">in <i>International Workshop on Recent Advances in Intrusion Detection</i>, 2014.</p></li><li data-list-text="[12]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">L. Metcalf and J. M. Spring, “Blacklist ecosystem analysis: Spanning Jan 2012 to Jun 2014,” in</p><p class="s10" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">Proceedings of the 2nd ACM Workshop on Information Sharing and Collaborative Security<span class="s7">, 2015.</span></p></li><li data-list-text="[13]"><p class="s7" style="padding-left: 23pt;text-indent: -17pt;text-align: left;">H. Sayyadi and L. Getoor, “FutureRank: Ranking Scientific Articles by Predicting their Future PageRank,”</p><p class="s7" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">in <i>Proceedings of the 2009 SIAM International Conference on Data Mining</i>, 2009.</p></li><li data-list-text="[14]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">D. Zhou, S. A. Orshanskiy, H. Zha and C. L. Giles, “Co-ranking Authors and Documents in a Heterogeneous Network,” in <i>Seventh IEEE International Conference on Data Mining</i>, 2007.</p></li><li data-list-text="[15]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">B. Dom, I. Eiron, A. Cozzi and Y. Zhang, “Graph-based ranking algorithms for e-mail expertise analysis,” in <i>Proceedings of the 8th ACM SIGMOD workshop on Research issues in data mining and knowledge discovery</i>, 2003.</p></li><li data-list-text="[16]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">Q. Wang, Y. Jin, S. Cheng and T. Yang, “ConformRank: A conformity-based rank for finding top-k influential users,” <i>Physica A: Statistical Mechanics and its Applications</i>, Bd. 474, pp. 39-48, 2017.</p></li><li data-list-text="[17]"><p class="s7" style="padding-left: 23pt;text-indent: -18pt;text-align: left;">E. Agichtein, C. Castillo, D. Donato, A. Gionis and G. Mishne, “Finding high-quality content in social media,” <i>Proceedings of the 2008 International Conference on Web Search and Data Mining</i>, 2008.</p></li></ol></body></html>
