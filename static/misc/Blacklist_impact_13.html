<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Blacklist_impact_13_</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 .s1 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 9pt; vertical-align: 4pt; }
 .p, p { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .s2 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt; }
 .s3 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s4 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s5 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 a { color: black; font-family:"Courier New", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s6 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s7 { color: black; font-family:"Courier New", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .h4, h4 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s8 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 h2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s9 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s10 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s11 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s12 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s13 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s14 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s15 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s16 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 h3 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s17 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s18 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s19 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -1pt; }
 .s20 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s21 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s22 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s23 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s24 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s25 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s26 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s27 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -1pt; }
 .s30 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s31 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s32 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 6.5pt; vertical-align: 3pt; }
 .s33 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 6.5pt; vertical-align: 3pt; }
 .s34 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s35 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s36 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 10pt; }
 .s37 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 6.5pt; vertical-align: 3pt; }
 .s38 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 5pt; vertical-align: 3pt; }
 .s39 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s40 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s41 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s42 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s43 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 5pt; vertical-align: 4pt; }
 .s44 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 4pt; }
 .s45 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 7pt; vertical-align: 5pt; }
 .s47 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 4pt; }
 .s48 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s49 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s50 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; vertical-align: -1pt; }
 .s51 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s52 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s53 { color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l3 {padding-left: 0pt;counter-reset: c2 1; }
 #l3> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l4 {padding-left: 0pt;counter-reset: c2 1; }
 #l4> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l5 {padding-left: 0pt; }
 #l5> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l6 {padding-left: 0pt; }
 #l6> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l7 {padding-left: 0pt;counter-reset: c2 1; }
 #l7> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l7> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l8 {padding-left: 0pt; }
 #l8> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l9 {padding-left: 0pt;counter-reset: c2 1; }
 #l9> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l9> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l10 {padding-left: 0pt; }
 #l10> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l11 {padding-left: 0pt; }
 #l11> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l12 {padding-left: 0pt;counter-reset: c2 1; }
 #l12> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l13 {padding-left: 0pt;counter-reset: c2 1; }
 #l13> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l14 {padding-left: 0pt; }
 #l14> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 #l15 {padding-left: 0pt; }
 #l15> li>*:first-child:before {content: "– "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 li {display: block; }
 #l16 {padding-left: 0pt;counter-reset: g1 1; }
 #l16> li>*:first-child:before {counter-increment: g1; content: counter(g1, decimal)". "; color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l16> li:first-child>*:first-child:before {counter-increment: g1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-left: 45pt;text-indent: 0pt;line-height: 111%;text-align: center;">Using NetFlow to measure the impact of deploying DNS-based blacklists <span class="s1">?</span></h1><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Martin Fejrskov<span class="s2">1</span>, Jens Myrup Pedersen<span class="s2">2</span>, and Emmanouil Vasilomanolakis<span class="s2">2</span></p><p class="s3" style="padding-top: 10pt;padding-left: 45pt;text-indent: 0pt;text-align: center;">1<span class="s4"> </span><span class="s5">Telenor A/S, Aalborg, Denmark</span></p><p style="padding-top: 1pt;padding-left: 45pt;text-indent: 0pt;line-height: 10pt;text-align: center;"><a href="mailto:mfea@telenor.dk">mfea@telenor.dk</a></p><p class="s3" style="padding-left: 83pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2<span class="s4"> </span><span class="s5">Cyber Security Group, Aalborg University, Copenhagen, Denmark</span></p><p class="s6" style="padding-left: 45pt;text-indent: 0pt;text-align: center;">{<span class="s7">jens,emv</span>}<span class="s7">@es.aau.dk</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 77pt;text-indent: 0pt;text-align: justify;">Abstract. <span class="s5">To prevent user exposure to a wide range of cyber security threats, organizations and companies often resort to deploying blacklists in DNS resolvers or DNS firewalls. The impact of such a deployment is often measured by comparing the coverage of individual blacklists, by counting the number of blocked DNS requests, or by counting the number of flows redirected to a benign web page that contains a warning to the user. This paper suggests an alternative to this by using NetFlow data to measure the e↵ect of a DNS-based blacklist deployment. Our findings suggest that only 38-40% of blacklisted flows are web traffic. Furthermore, the paper analyzes the flows blacklisted by IP address, and it is shown that the majority of these are potentially benign, such as flows towards a web server hosting both benign and malicious sites. Finally, the flows blacklisted by domain name are categorized as either spam or malware, and it is shown that less than 6% are considered malicious.</span></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 77pt;text-indent: 0pt;text-align: justify;"><b>Keywords: </b>Blacklist <span class="s8">· </span>DNS <span class="s8">· </span>NetFlow <span class="s8">· </span>Ipfix <span class="s8">· </span>ISP <span class="s8">· </span>RBL <span class="s8">· </span>Threat Intelligence.</p><p style="padding-top: 9pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="1"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Introduction</h2><p style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Threat Intelligence (TI) in the form of reputation-based blacklists of IP addresses and domain names have been made available by non-profit and commercial or- ganisations for decades [20], and has later been the subject of academic research as well [9]. Improving the accuracy and completeness of the blacklists by the careful selection of entries to maximize the amount of true positives and mini- mize the amount of false negatives remains a continuous struggle. These metrics describe the blacklist itself, however they do not describe the actual impact of deploying a blacklist in practice. If there is not impact, the time and money</p><p class="s9" style="padding-top: 7pt;padding-left: 58pt;text-indent: -7pt;text-align: justify;">?<span class="s10"> </span><span class="s5">Funded by Telenor A/S and Innovation Fund Denmark, 2021. This version of the contribution has been accepted for publication, after peer review but is not the Version of Record and does not reflect post-acceptance improvements, or any cor- rections. The Version of Record is available online at: https://doi.org/10.1007/978- 3-030-90019-9 24. Use of this Accepted Version is subject to the publisher’s Accepted Manuscript terms of use [18].</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">spent by the user deploying the blacklist can be considered wasted. Therefore, we argue that the impact is an important metric from a practical perspective.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">How to describe and measure the impact will naturally depend on the spe- cific use case in which the blacklist is applied<span class="s2">3</span>. The most prevalent use cases for blacklists fall in two categories, o↵ering protection to either the originating end of a connection (in antivirus software, in a web browser plugin, in a company firewall, in an Internet Service Providers (ISPs) DNS server, etc.) or the termi- nating end of a connection (a mail server, at a firewall protecting a web site, etc.). This paper focuses on the impact of deploying blacklists in DNS resolvers at ISPs. Deploying blacklists at ISPs is attractive as it can increase the security posture of all devices that default to use the ISP’s DNS resolvers.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Informal conversations with blacklist vendors suggest that a common method for assessing the impact is to let the DNS resolver count the number of performed DNS queries that match an entry on a blacklist. Some ISPs and DNS security vendors even refer to this number directly as the number of blocked threats [3,22]. This is similar to counting the number of emails flagged as phishing by an email server, or counting the number of requests towards a web server originating from an IP address known to be malicious. However a DNS request in itself is only a threat indicator. In order for a user to be at risk, an IP connection towards the malicious host is a minimum precondition, and we therefore consider an IP connection as a stronger threat indicator than a DNS resolution. In this paper, we propose a method based on NetFlow/IPFIX measurements to evaluate the impact of deploying blacklists at an ISP DNS resolver.</p><p style="padding-left: 63pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">Assessing the network-level impact of applying a blacklist at a DNS server</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">will, however, not in itself tell anything about the user-level impact perceived by the user. For instance, blocking a user’s connection attempt towards a shared web hosting environment that incidentally also hosts a known spam sender, is likely to be perceived as a nuisance rather than as protection against a threat. On the other hand, connecting to a web server known to solely host malicious payloads represents a high risk to the user. To supplement the measured network-level impact, it is necessary both to identify the cause for the entry to be blacklisted in order to assess the risk level of connecting to the blacklisted entity, and to assess the risk that a connection is in fact made towards the malicious entity.</p><p style="padding-left: 63pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">The contributions of this paper are twofold:</p><ul id="l2"><li data-list-text="–"><p style="padding-top: 7pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">We show how existing methods for measuring the impact of deploying do- main and IP address blacklists in DNS resolvers can be improved by including NetFlow measurements.</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: justify;">Using the NetFlow method, we quantify the number of malicious and non- malicious flows, and we quantify the number of flows blacklisted by IP ad- dress that may be benign.</p></li></ul><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">The paper is organised in 7 sections: Section 2 gives an overview of related work. Section 3 describes the concept of blacklisted flows and the method for merging DNS, NetFlow and blacklist data to identify blacklisted flows. Section</p><p class="s3" style="padding-top: 7pt;padding-left: 51pt;text-indent: 0pt;text-align: left;">3<span class="s4"> </span><span class="s5">The elaborated definition of impact used in this paper is presented in Section 4.3.</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">4 describes the 3 data sources used in the paper and the application of the previously described merging method. Section 5 categorizes the blacklisted flows by the type of maliciousness and Section 6 identifies IP addresses that may contain multiple (and possibly both malicious and benign) endpoints. Section 7 combines the results from the previous sections to describe the network-level and user-level impact. Lastly, Section 8 summarizes and concludes the paper.</p><p style="padding-top: 11pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Related work</h2><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: right;">As outlined in the introduction, the contribution of this paper is to show that existing measurement methods that <span class="s11">measure the impact </span>of implementing domain and IP address <span class="s11">blacklisting in DNS resolvers </span>can be improved by including <span class="s11">Net- Flow data </span>based measurements in addition to <span class="s11">DNS data </span>based measurements. We use the proposed measurement method together with information about the <span class="s11">type of maliciousness </span>and knowledge about the <span class="s11">type of endpoint </span>to identify if the endpoint may host both benign and malicious sites simultaneously. The columns of table 1 represent each of the aspects highlighted in the above paragraph, and this section elaborates how related works cover some, but not all, of the aspects. Many papers such as [24] focus on the creation, quality, accuracy or com- parison of blacklists. Bouwman et al. focus on the di↵erences between paid and free lists, and investigate the reasons (price, coverage, false positive rate, etc.) provided by operators/enterprises for choosing specific lists [2]. These topics are considered complementary to this paper, and such e↵orts will therefore not be the topic of this section. Similarly, papers such as [13, 16] focusing on using</p><p style="text-indent: 0pt;line-height: 12pt;text-align: right;">blacklists for spam filtering in mail servers are also considered complementary.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: left;">Mal<span class="s5">iciousness</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="text-indent: 0pt;line-height: 9pt;text-align: left;">Endpoint</p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="text-indent: 0pt;line-height: 9pt;text-align: left;">NetFlow data</p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="text-indent: 0pt;line-height: 9pt;text-align: left;">DNS data</p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="text-indent: 0pt;line-height: 9pt;text-align: left;">Resolver BL</p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="text-indent: 0pt;line-height: 8pt;text-align: left;">Impact</p><p style="text-indent: 0pt;text-align: left;"/><h4 style="padding-left: 271pt;text-indent: 0pt;text-align: left;">Focus area</h4><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:83.19pt" cellspacing="0"><tr style="height:15pt"><td style="width:84pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Author</p></td><td style="width:45pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Year</p></td><td style="width:148pt;border-bottom-style:solid;border-bottom-width:1pt" colspan="6"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:14pt"><td style="width:84pt;border-top-style:solid;border-top-width:1pt"><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">Sheng et al. [15]</p></td><td style="width:45pt;border-top-style:solid;border-top-width:1pt"><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">2009</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt;border-top-style:solid;border-top-width:1pt"><p class="s15" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">X</p></td><td style="width:24pt;border-top-style:solid;border-top-width:1pt"><p class="s15" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">X</p></td><td style="width:23pt;border-top-style:solid;border-top-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt;border-top-style:solid;border-top-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt;border-top-style:solid;border-top-width:1pt"><p class="s15" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: center;">X</p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Bermudez et al. [1]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2012</p></td><td style="width:37pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Connery [4]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2012</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Zhang et al. [23]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2013</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:18pt"><p class="s15" style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Ku¨hrer et al. [10]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2014</p></td><td style="width:37pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:18pt"><p class="s15" style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Foremski et al. [7]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2014</p></td><td style="width:37pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Satoh et al. [14]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2019</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Spacek et al. [17]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2019</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Wilde et al. [21]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2019</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Li et al. [11]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2019</p></td><td style="width:37pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:18pt"><p class="s15" style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td></tr><tr style="height:11pt"><td style="width:84pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Telenor Norway [19]</p></td><td style="width:45pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2020</p></td><td style="width:37pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:24pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:23pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:18pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:13pt"><td style="width:84pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Griffioen et al. [8]</p></td><td style="width:45pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2020</p></td><td style="width:37pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s15" style="padding-right: 7pt;text-indent: 0pt;line-height: 10pt;text-align: right;">X</p></td><td style="width:23pt;border-bottom-style:solid;border-bottom-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:24pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:23pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s15" style="text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td><td style="width:18pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s15" style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">X</p></td></tr></table><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Table 1. <span class="s16">Related work and their focus areas</span></h4><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l3"><li data-list-text="2.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Network-level impact of blacklisting</h3><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Although not focusing on malware and blacklists, the authors of [1] observe that around 50% of DNS responses have an associated flow. This suggests that a flow cannot be assumed to be associated with all <span class="s11">blacklisted </span>DNS responses either. This forms a motivation for focusing on flows rather than DNS responses.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: right;">Zhang et al. measure the impact of applying several (IP address) blacklists on NetFlow records obtained from the routers of a large regional ISP [23]. The paper di↵erentiates between di↵erent types of maliciousness and endpoints, and concludes that up to 17% of the traffic measured by volume could be considered tainted. Although this work blacklists NetFlow entries rather than DNS entries, we consider it to be one of the works that are most closely related to our paper. Sheng et al. evaluate blacklists in browser plugins to protect against phishing websites [15]. This approach represents several advantages to DNS-based filter- ing, as lists of URLs rather than lists of domain names or IP addresses can be used. The approach is, however, by nature very application and browser specific,</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">thus representing a disadvantage in relation to a DNS-based approach.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: right;">Li et al. use telescopes of scanning activities to determine list coverage, thus including some flow level data [11]. Furthermore, the paper uses IP ranges of known CDNs as a source to determine list accuracy. However, the focus is still on assessing the quality of the lists, rather than on the impact of applying them. Spacek et al. describe many practical considerations in deploying DNS based blacklisting, and elaborates on some of the consequences to the user [17]. These consequences focus on feedback about the blocked site, difficulties in relation to</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">the use of TLS, etc., and does not quantify the impact of the blacklist itself.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Deploying blacklists at an ISP or company DNS server is becoming a common security measure. Public statements such as [19] and [4] with limited descriptions of the impact of such measures exist. Both of these statements measure the im- pact in terms of visits to a website, to which a user is redirected instead of being blocked. Similarly, DNS firewall/resolver vendors, TI providers, etc. provide use case descriptions focusing on DNS-level measurements only. Furthermore, Wilde et al. examine the blocking behaviour of several publicly available resolvers and conclude that none of them block for security purposes [21]. They also use lists of URLs to quantify to which extent an RPZ enabled DNS resolver would block the list entries. However, no real world traffic is used in the quantification.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Academic papers describe the impact of blacklisting at the router and browser level, and to a certain extent at the DNS level, as outlined above. However, we are not aware of any work that quantifies the impact at the NetFlow level.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">User-level impact of blacklisting</h3><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Kuhrer et al. categorize both commercial and public blacklists entries to identify if an endpoint is a sinkhole or a parked domain [10]. The purpose of performing the categorization therefore relates more to the validity of a blacklist entry than to the impact experienced by the user. Furthermore, the paper evaluates the ability of blacklists deployed at a DNS server to detect known botnets.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Using DNS and flow information to determine the used application is the topic of [7]. The application of named flows (flows to which a DNS response can be associated) such as HTTP, Roblox and Skype is identified. This classification, however, focuses solely on the application rather than the type of endpoint.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Determining the type of maliciousness is the main focus of [14]. The authors use Word2Vec to group 388 malicious queries into three clusters, each comprising queries with a common cause. The study focus solely on DNS TXT records, which does not extend well to the majority of queries that do not have TXT records.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: right;">Some blacklist vendors and tools such as [12] provide the cause for an entry to be listed. This is in many cases directly related to the type of maliciousness. Griffioen et al. present several aspects related to our paper [8]. Their main emphasis is to compare open source blacklists, including the impact metric. NetFlow information from a Tier 1 provider is used to assess the timeliness of entries on the lists, but is not used to assess the impact of deploying the lists, which is the main topic of our paper. Instead, information from authoritative DNS servers is used to evaluate the impact of deploying the lists, by analyzing how many domain names were pointing to a particular IP address on the day it was marked as malicious. We will extend this by including other aspects, beyond a high domain name to IP address ratio, and by analysing the domain names</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">and IP addresses to identify di↵erent scenarios like shared web hosting.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Both [23] and [8] consider blacklisting on the IP level, for example in firewalls. In our paper, the focus is on invoking the blacklisting in a DNS server, thus considering both domain name and IP address based blacklists. Despite this conceptual di↵erence, we consider these the most closely related to our paper.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2.3"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Summary</h3><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Although related work exists, the idea of using NetFlow measurements for eval- uating a DNS-based blacklist deployment seems to be unexplored, and this will therefore be the topic of Section 3-4. Categorizing existing blacklist entries by type of maliciousness does not seem to be receiving a lot of academic attention, maybe because the categorization can be available as a supplement to the black- lists. Using knowledge about the type of maliciousness and endpoint to provide a risk based view of the blacklisted flows will be the topic of Section 5-6.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="3"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Method for identifying blacklisted flows</h2><p style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">The concept of blacklisted flows is central to the flow based measurement method proposed in this paper. The method to identify blacklisted flows requires three data sources and is comprised of several steps, as illustrated in Figure 1. The three data sources are NetFlow data, DNS data and blacklists containing domain names and IP addresses. The first steps, relating to the practical collection and pre-processing of the three individual data sources are illustrated in blue in Figure 1 and elaborated in Section 4. Combining the three data sources involves two additional processing steps, elaborated in the following subsections. First,</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Fig. 1. <span class="s16">The overall dataflow to identify blacklisted flows.</span></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">all blacklisted DNS records are identified (green in Figure 1). Then, all flows relating to the blacklisted DNS records are identified (red in Figure 1).</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l4"><li data-list-text="3.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Blacklisted DNS data</h3><p style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">All DNS records associated with a specific DNS response are considered black- listed if <span class="s11">any </span>of these conditions are satisfied for any of the records:</p><ul id="l5"><li data-list-text="–"><p style="padding-top: 6pt;padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: left;">The Qname or Rname of the DNS record matches a blacklisted domain name</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: left;">The Rdata of the DNS record matches a blacklisted IP address or a black- listed IP prefix</p><p class="s11" style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">The result of this is that </span>D<span class="s17">black</span> <span class="p">blacklisted DNS responses are identified.</span></p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li data-list-text="3.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Blacklisted flows</h3><p style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">A flow is considered blacklisted by a specific, blacklisted DNS record if <span class="s11">all </span>of the following conditions are satisfied:</p><ul id="l6"><li data-list-text="–"><p style="padding-top: 7pt;padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: left;">The DNS record has <span class="s11">rtype </span>= <span class="s11">A</span></p></li><li data-list-text="–"><p class="s11" style="padding-left: 65pt;text-indent: -10pt;text-align: left;"><span class="p">The DNS record and flow timestamps are less than 30 minutes apart (as elaborated below), </span>t<span class="s17">DNS</span> <span class="s18"> </span>t<span class="s17">NetF</span> <span class="s17">low</span> &lt; t<span class="s17">DNS</span> <span class="p">+ 30</span>m</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: left;">The blacklisted DNS record is the temporally closest DNS record where the two conditions below are satisfied</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: left;">The blacklisted DNS record client IP matches the flow source IP</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: left;">The blacklisted DNS record rdata matches the flow destination IP</p><p style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">This yields a number of blacklisted flows, <span class="s11">F</span><span class="s17">black</span>.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">Both the use of temporal correlation and anonymized IP addresses can cause a number of false positives and false negatives that are not immediately quantifi- able as no ground truth exists for verification. The limit of 30 minutes is based</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">on an analysis of the time di↵erence between the DNS record and the flow. This analysis suggests that the number of matched DNS records and flows converge towards 0 as a function of the time di↵erence between the records, with few matches with a time di↵erence of more than 15 minutes.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">In case a flow matches two di↵erent DNS records where the only di↵erence is the TTL, the DNS record with the highest TTL is considered a match.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><span class="h4">Fig. 2. </span>Flow aggregation illustration. In this example, <span class="s6">D</span>=3, <span class="s6">R</span>=10, <span class="s6">D</span><span class="s19">black</span>=1, <span class="s6">N</span>=11, <span class="s20">F</span><span class="s21">=7, </span><span class="s20">F</span><span class="s22">black</span><span class="s21">=5, </span><span class="s20">C</span><span class="s22">black</span><span class="s21">=2 and </span><span class="s20">C</span><span class="s22">black,DNS</span><span class="s21">=1</span></p><p style="padding-top: 10pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">The merging of NetFlow records into flows is described in Section 4.1. How- ever, a NetFlow emitter may view a single, actual flow as two or more flows due to the use of aggressive timeouts for detection of flow end, especially for UDP traffic. Often this is referred to as flow splitting in related works. The e↵ect is illustrated in Figure 2, where light blue represents the lifespan of actual flows and dark blue represents packets transmitted in the flow. Green represents the lifespan of flows as perceived and reported by the NetFlow emitter in successive flow records. Due to timeouts, the NetFlow emitter perceives the two actual flows as 5 di↵erent flows. Therefore, a further aggregation of flows is desirable.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">We choose to aggregate all blacklisted flows that are blacklisted by the same DNS record (considered unique by the qname, timestamp and clientip) and that have the same 5-tuple into a single flow, producing </span>C<span class="s17">black</span> <span class="p">flows. This aggregated entity is named an aggregated flow to distinguish it from the flow defined by the NetFlow emitter. The aggregated flows are represented in red in Figure 2, where two aggregated, blacklisted flows (red) related to 5 di↵erent NetFlows (green), related to 2 actual flows (blue), and related to the same (blacklisted) DNS response (white) are depicted. The aggregated flow record has a cumulative</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">bytes/packet count and the flow start timestamp that is the earliest timestamp found in the related flows.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li></ul></li></ol></li><li data-list-text="4"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Data sources and processing</h2><p style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">This section will provide details on the selection and pre-processing of the three data sources illustrated in blue in Figure 1 using data from Telenor Denmark’s network (Sections 4.1 to 4.3). Furthermore, the section will describe the results of performing the steps described in Section 3 on the data (Sections 4.4 to 4.6).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:77.294pt" cellspacing="0"><tr style="height:13pt"><td style="width:152pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Metric</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Symbol</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 8pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Week 1</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 8pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Week 2</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:77.294pt" cellspacing="0"><tr style="height:11pt"><td style="width:152pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Total DNS responses</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s23" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">D</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">2<span class="s23">, </span>15 <span class="s23">· </span>10<span class="s24">10</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">2<span class="s23">, </span>25 <span class="s23">· </span>10<span class="s24">10</span></p></td></tr><tr style="height:11pt"><td style="width:152pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Total relevant DNS records</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s23" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">R</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">1<span class="s23">, </span>85 <span class="s23">· </span>10<span class="s24">10</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">1<span class="s23">, </span>88 <span class="s23">· </span>10<span class="s24">10</span></p></td></tr><tr style="height:13pt"><td style="width:152pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Blacklisted DNS responses</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">D<span class="s26">black</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">6<span class="s23">, </span>81 <span class="s23">· </span>10<span class="s24">6</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">4<span class="s23">, </span>56 <span class="s23">· </span>10<span class="s24">6</span></p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:77.294pt" cellspacing="0"><tr style="height:11pt"><td style="width:152pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Total NetFlow records</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s23" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">N</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">4<span class="s23">, </span>63 <span class="s23">· </span>10<span class="s24">9</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">4<span class="s23">, </span>60 <span class="s23">· </span>10<span class="s24">9</span></p></td></tr><tr style="height:13pt"><td style="width:152pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Total relevant flows</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s23" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">F</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">3<span class="s23">, </span>92 <span class="s23">· </span>10<span class="s24">8</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">3<span class="s23">, </span>94 <span class="s23">· </span>10<span class="s24">8</span></p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:77.294pt" cellspacing="0"><tr style="height:12pt"><td style="width:152pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Blacklisted flows</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">F<span class="s26">black</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: right;">185460</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: right;">191923</p></td></tr><tr style="height:11pt"><td style="width:152pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Blacklisted, aggregated flows</p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">C<span class="s26">black</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">90796</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">86854</p></td></tr><tr style="height:13pt"><td style="width:152pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Unique DNS responses in <span class="s23">C</span><span class="s27">black</span></p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">C<span class="s26">black,DNS</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">78312</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">70134</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:77.294pt" cellspacing="0"><tr style="height:35pt"><td style="width:152pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Blacklisted DNS response ratio</p><p class="s23" style="padding-left: 1pt;text-indent: 0pt;text-align: left;"><span class="s14">Entries in </span>C<span class="s27">black</span> <span class="s14">matched by IP Entries in </span>C<span class="s27">black</span> <span class="s14">matched by domain</span></p></td><td style="width:47pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 1pt;padding-left: 13pt;padding-right: 16pt;text-indent: -8pt;line-height: 74%;text-align: left;"><u>D</u><u>black</u> D</p><p class="s25" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">C<span class="s26">ip</span></p><p class="s25" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">C<span class="s26">dom</span></p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: right;">0,000317</p><p class="s14" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">68045</p><p class="s14" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">22842</p></td><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: right;">0,000203</p><p class="s14" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">62683</p><p class="s14" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">24486</p></td></tr></table><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Table 2. <span class="s16">DNS and NetFlow data metrics</span></h4><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">The three data sources are all collected during two separate weeks for the 1,5M mobile and 100k broadband subscriptions of Telenor Denmark. Notice that multiple users can use the same subscription, such as a household where all members are the users of a single broadband subscription. The data set for week 1 represent 7 full days from 2020-10-29 to 2020-11-04, and the data set for week 2 represent 7 full days of from 2020-11-26 to 2020-12-02. Table 2 lists the key properties for data in these time periods and the following sections will elaborate on these numbers. The following sections will for readability refer to the data from week 1, unless explicitly stated otherwise.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l7"><li data-list-text="4.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">NetFlow data</h3><p style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">NetFlow data is collected at Telenor Denmark’s Border Gateway Protocol (BGP) Autonomous System (AS) border routers, representing all Internet traffic enter- ing and exiting Telenor’s network, as depicted in Figure 3. As indicated in the figure, two primary types of internal traffic not crossing the border routers exist:</p><ul id="l8"><li data-list-text="–"><p style="padding-top: 7pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">User-to-user traffic: The amount of user-to-user traffic is considered negli- gible compared to the amount of traffic crossing the border router and is therefore similarly considered negligible for the purpose of this paper.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: justify;">User-to-CDN traffic: A number of Content Delivery Network (CDN) nodes are deployed internally, and these serve a significant volume of traffic. How- ever the types of data hosted on these nodes (Netflix/Youtube videos and similar static content etc.) are considered irrelevant to this paper from a user threat and blacklist perspective.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 48pt;text-indent: 0pt;text-align: left;">Fig. 3. <span class="s16">A conceptual view of the Telenor network indicating the sources of DNS and NetFlow data.</span></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 14pt;text-align: left;">A (unidirectional) NetFlow record is created by the border routers at least every 60 seconds for each active 5-tuple flow in each flow direction. A sample</p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">Q</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">rate of Q=512 is used, therefore NetFlow records represent data from <span class="s32">&nbsp;</span><span class="s33">1</span></p><p style="padding-left: 3pt;text-indent: 0pt;text-align: left;">packets.</p><p style="padding-top: 2pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">The collected data contains <span class="s11">N </span>= 4<span class="s11">, </span>63 <span class="s18">· </span>10<span class="s2">9</span><span class="s34"> </span>NetFlow records.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">For the purpose of this paper, only connections initiated by users as a result of a DNS lookup are relevant. Therefore, only NetFlow records with an internal source address are considered, and for TCP connections only flows in which a SYN packet is seen are considered, as this will make sure that the flow start time actually represents the beginning of the flow. Multiple NetFlow records belonging to the same flow (defined by similar start-time and 5-tuple) are aggregated. As a result of this data reduction, <span class="s11">F </span>= 3<span class="s11">, </span>92 <span class="s18">· </span>10<span class="s2">8</span><span class="s34"> </span>flows are available for comparison with blacklisted DNS records. No application layer proxies are deployed.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">NetFlow data is anonymized for legal reasons by truncating the internal (user) IP address to a /24 prefix for non-NAT’ed users (or truncating the port for NAT’ed users), truncating the external IP address to a /16 prefix, reverse truncating the timestamp, as well as a number of other measures less relevant to this paper. The anonymization policy applied follows the guidelines of [6]. Table 3 contains a number of example NetFlow records.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:82.32pt" cellspacing="0"><tr style="height:13pt"><td style="width:57pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">srcip</p></td><td style="width:36pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">srcport</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">dstip</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">dstport</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">proto</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">packets</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">bytes</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:82.32pt" cellspacing="0"><tr style="height:11pt"><td style="width:57pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">129.142.227.0</p></td><td style="width:36pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">56065</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2.17.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">443</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">TCP</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">512</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">32768</p></td></tr><tr style="height:11pt"><td style="width:57pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">83.73.228.0</p></td><td style="width:36pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">49906</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">193.28.147.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">443</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">TCP</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">512</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">32768</p></td></tr><tr style="height:13pt"><td style="width:57pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">85.80.228.0</p></td><td style="width:36pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">45820</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">8.8.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">53</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">TCP</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">512</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">30720</p></td></tr></table><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Table 3. <span class="s16">Example NetFlow records. Timestamps are omitted for brevity.</span></h4><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li data-list-text="4.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: justify;">DNS data</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">DNS data is collected at Telenor Denmark’s DNS resolvers, as depicted in Figure</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">3. As the queried domain name is also a part of the DNS response packet, and as this study only focuses on syntactically valid DNS requests for which a response is always issued, only the response packets are collected (including for example NXDOMAIN responses). The resolvers are only accessible from Telenor Denmarks network, and are the default choice for all users. The collected data contains <span class="s11">D </span>= 215 <span class="s18">· </span>10<span class="s2">8</span><span class="s34"> </span>DNS responses. As a response can contain many Resource Records (RRs), the data is stored such that one record represents a unique RR augmented with the information common to all RRs in the same response.</p><p class="s35" style="text-indent: 0pt;line-height: 7pt;text-align: left;">(<span class="s31">QN  </span>+<span class="s31">D</span>)</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 14pt;line-height: 12pt;text-align: justify;">There are no mechanisms preventing the use of 3rd party DNS resolvers re- siding outside the Telenor network, and therefore it is relevant to assess the prevalence of that type of traffic. NetFlow data contains <span class="s11">N</span><span class="s17">DNS</span><span class="s11"> </span>= 5<span class="s11">, </span>92 <span class="s18">· </span>10<span class="s2">6</span><span class="s34"> </span>records for traffic from users towards port 53 (DNS) and 853 (DNS-over-TLS) (5<span class="s11">, </span>78 <span class="s18">· </span>10<span class="s2">6</span><span class="s34"> </span>and 1<span class="s11">, </span>3 <span class="s18">· </span>10<span class="s2">5</span><span class="s34"> </span>records respectively). It is not legally possible to inspect this traffic further to quantify how many and which queries this traffic repre- sents. Assuming that one NetFlow record represents one DNS query (yielding the worst-case flow sample likelihood of 1:Q), the 3rd party DNS traffic represents only <span class="s36">&nbsp; </span><span class="s37">QN</span><span class="s38">DNS &nbsp;&nbsp;&nbsp;&nbsp; </span><span class="s39"> </span>= 10<span class="s11">, </span>8% of all queries. The traffic towards the Telenor DNS re-</p><p class="s40" style="padding-left: 86pt;text-indent: 0pt;line-height: 2pt;text-align: left;">DNS</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">solvers is therefore considered sufficiently representative of the total DNS traffic,</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">and given the lack of legal basis for inspecting the 3rd party DNS resolver traf- fic, the 3rd party DNS traffic is disregarded for the purpose of this paper. Some anonymity services like TOR use private top level domains like ‘.onion’. These top level domains are not registered in the public DNS hierarchy. Therefore, such services are not considered relevant to this paper.</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">Only 0,1% of the DNS records, <span class="s11">R</span>, have an <span class="s11">rdata </span>field referring to a non-CDN IP address within the Telenor Denmark network. This supports the statement made in the NetFlow section that internal network traffic (both user-to-user and user-to-CDN) can be considered negligible to this paper.</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">DNS data is anonymized for legal reasons by truncating the client (user) IP address to a /24 prefix for non-NAT’ed users (or truncating the port for NAT’ed users), reverse truncating the timestamp, removing the domain name for the 15 most popular domains, and a number of other measures less relevant to this paper. The anonymization policy applied follows the guidelines of [6]. Discounting the anonymized records, <span class="s11">R </span>= 185<span class="s18">·</span>10<span class="s2">8</span><span class="s34"> </span>records are therefore available for comparison with blacklists. Table 4 contains a number of example records.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:59.928pt" cellspacing="0"><tr style="height:13pt"><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">clientip</p></td><td style="width:81pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">qname</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">rtype</p></td><td style="width:82pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">rname</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">rdata</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">ttl</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:59.928pt" cellspacing="0"><tr style="height:11pt"><td style="width:43pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">85.83.74.0</p></td><td style="width:81pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">a.config.skype.com.</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">A</p></td><td style="width:82pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">l-0014.l-msedge.net.</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">13.107.42.23</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">100-299</p></td></tr><tr style="height:11pt"><td style="width:43pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">85.83.65.0</p></td><td style="width:81pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">log.tiktokv.com.</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">A</p></td><td style="width:82pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: center;">a2047.r.akamai.net.</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">77.214.51.34</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">1-99</p></td></tr><tr style="height:13pt"><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">85.83.65.0</p></td><td style="width:81pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">log.tiktokv.com.</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">A</p></td><td style="width:82pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 1pt;text-indent: 0pt;line-height: 10pt;text-align: center;">a2047.r.akamai.net.</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">77.214.51.27</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">1-99</p></td></tr></table><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Table 4. <span class="s16">Example DNS records. The timestamp is omitted for brevity.</span></h4><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4.3"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Blacklists</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">Blacklists that are available for a fee generally outperform free lists [10]. There- fore, blacklists provided by two well-known, commercial DNS blacklist vendors are used for this paper. After a review of the paper, the vendors opted to stay anonymous. The vendors will therefore be referenced as <span class="s11">A </span>and <span class="s11">B</span>, and the indi- vidual lists provided by each vendor as <span class="s11">A</span><span class="s41">1</span>, <span class="s11">A</span><span class="s41">2</span>, etc. The lists contain both IP addresses, IP prefixes and domains. Some of the lists are updated every minute, and the most realistic result would therefore be produced by doing a real-time correlation of DNS data and blacklists. However, as the DNS data is collected independently of the blacklists for operational and privacy reasons, this has not been possible in practice. Instead, the lists are collected at 23:00 CEST each day and the aggregated list is used for comparison for the whole period. In week 1, the aggregated lists contain 11878657 unique IP addresses, 3389 unique prefixes and 989490 unique domains. In week 2, the aggregated lists contain 16286208 unique IP addresses, 3320 unique prefixes and 1002913 unique domains.</p><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">For this paper, the impact of a blacklist describes the e↵ect derived from a specific blacklist deployment. The impact of a blacklist with perfect accuracy and perfect completeness will be zero if a user never visits a malicious website. Conversely, if the completeness of a list is low, but deploying the list in practice would block the majority of traffic anyways, the impact will be high.</p><p style="padding-top: 9pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4.4"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Blacklisted DNS data</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">The result of the operation described in Section 3.1 is that <span class="s11">D</span><span class="s17">black</span><span class="s11"> </span>= 6<span class="s11">, </span>81 <span class="s18">· </span>10<span class="s2">6</span><span class="s34"> </span>blacklisted DNS responses are identified. This represents <span class="s37">D</span><span class="s38">black</span><span class="s39"> </span>=0,000317 of the total number of DNS responses. The impact of applying DNS based blacklisting is often measured by the magnitude of this number, with the interpretation that user were protected by 6<span class="s11">, </span>81 <span class="s18">· </span>10<span class="s2">6</span><span class="s34"> </span>threats.</p><p style="padding-top: 10pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4.5"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Blacklisted flows</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">The result of the operation described in Section 3.2 is that </span>F<span class="s17">black</span><span class="p">=185460 black- listed flows are identified. After performing aggregation, a total of </span>C<span class="s17">black</span><span class="p">=90796 blacklisted, aggregated flows are identified. Table 5 contains a number of exam- ples of blacklisted, aggregated flows. </span>C<span class="s17">black</span> <span class="p">represents the number of flows found in the sampled NetFlows that would have been blocked in the sample week, if DNS based blacklists had been activated for all users.</span></p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:50.611pt" cellspacing="0"><tr style="height:13pt"><td style="width:116pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">qname</p></td><td style="width:18pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">list</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">srcip</p></td><td style="width:48pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">dstip</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">dstport</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">proto</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">timedi↵</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:50.611pt" cellspacing="0"><tr style="height:11pt"><td style="width:116pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">www-pf-dk.filesusr.com.</p></td><td style="width:18pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-right: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">A<span class="s42">2</span></p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">94.145.224.0</p></td><td style="width:48pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 4pt;text-indent: 0pt;line-height: 10pt;text-align: center;">34.102.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">443</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">TCP</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:116pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">collection.decibelinsight.net.</p></td><td style="width:18pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-right: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">A<span class="s42">2</span></p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">94.145.230.0</p></td><td style="width:48pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 4pt;text-indent: 0pt;line-height: 10pt;text-align: center;">35.180.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">1789</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 4pt;text-indent: 0pt;line-height: 10pt;text-align: center;">UDP</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">434</p></td></tr><tr style="height:11pt"><td style="width:116pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">collection.decibelinsight.net.</p></td><td style="width:18pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-right: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">A<span class="s42">2</span></p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">94.145.230.0</p></td><td style="width:48pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 4pt;text-indent: 0pt;line-height: 10pt;text-align: center;">35.180.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">0</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">ICMP</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">768</p></td></tr><tr style="height:13pt"><td style="width:116pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">wahoofitness.com.</p></td><td style="width:18pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s25" style="padding-right: 3pt;text-indent: 0pt;line-height: 10pt;text-align: center;">A<span class="s42">2</span></p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">2.130.11.0</p></td><td style="width:48pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">151.101.0.0</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">443</p></td><td style="width:28pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-right: 5pt;text-indent: 0pt;line-height: 10pt;text-align: center;">TCP</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">93</p></td></tr></table><h4 style="padding-left: 48pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Table 5. <span class="s16">Example of the most relevant columns from blacklisted communication records.</span></h4></li><li data-list-text="4.6"><h3 style="padding-left: 74pt;text-indent: -26pt;line-height: 11pt;text-align: left;">Discussion</h3><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">The <span class="s11">C</span><span class="s17">black</span>=90796 blacklisted, aggregated flows contain <span class="s11">C</span><span class="s17">black,DNS</span>=78312 unique DNS responses (defined by DNS timestamp, clientip, qname and ipprotocol).</p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: left;">This represents <span class="s37">C</span><span class="s43">black,DNS</span></p><p class="s40" style="padding-left: 47pt;text-indent: 0pt;line-height: 4pt;text-align: right;">black</p><p style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">= 1<span class="s11">, </span>1% of all blacklisted DNS responses. However,</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 10pt;text-align: left;">as packet sampling is employed, this only accounts for the number of observed</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">flows, not the actual number of flows. Techniques exist for estimating the ac- tual number of flows based on the observed number of flows [5]. However, this</p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: left;">does not imply that <span class="s37">C</span><span class="s43">black,DNS</span></p><p class="s40" style="padding-left: 47pt;text-indent: 0pt;line-height: 4pt;text-align: right;">black</p><p style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">can be scaled by the same techniques, as the</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 10pt;text-align: left;">non-observed flows could in theory all be related to the DNS responses already</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">found in <span class="s11">C</span><span class="s17">black,DNS</span>. Therefore, the data available in this study does not allow</p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: left;">any further conclusions on the magnitude of <span class="s37">C</span><span class="s43">black,DNS</span><span class="s44"> </span>.</p><p class="s40" style="padding-left: 141pt;text-indent: 0pt;line-height: 3pt;text-align: center;">black</p><p style="padding-left: 63pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">The data sets from week 1 and 2 show that the amount of blacklisted DNS</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">responses in each week di↵er significantly from <span class="s11">D</span><span class="s17">black</span><span class="s11"> </span>= 6<span class="s11">, </span>81 <span class="s18">· </span>10<span class="s2">6</span><span class="s34"> </span>to 4<span class="s11">, </span>56 <span class="s18">· </span>10<span class="s2">6</span>, a drop of 33%. The collected data cannot o↵er an explanation for this di↵erence, which may simply be attributed to varying activity levels of the malicious actors.</p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">As a consequence of this, the fraction <span class="s37">D</span><span class="s38">black</span></p><p style="padding-left: 3pt;text-indent: 0pt;text-align: left;">di↵er proportionately.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">It is, however, interesting to note that although </span>D<span class="s17">black</span> <span class="p">di↵er by 33%, the amount of observed flows blocked, </span>C<span class="s17">black</span><span class="p">, only show a drop of 4%, from 90796 to 86854. The estimated ratio of blacklisted DNS requests that result in a TCP flow,</span></p><p class="s31" style="text-indent: 0pt;line-height: 7pt;text-align: left;">D</p><p style="text-indent: 0pt;text-align: left;"/><p class="s47" style="padding-left: 49pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><span class="s45">C</span><u>black,DNS</u> <span class="p">, does not vary much between the weeks either. This could indicate</span></p><p class="s40" style="padding-left: 65pt;text-indent: 0pt;line-height: 3pt;text-align: left;">black</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">that the amount of blacklisted flows may be a temporally less variable metric</p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">than the amount of blacklisted DNS responses.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">For readability, this paper will refer to the set of aggregated flows that are considered blacklisted because of an IP address entry on the blacklist as </span>C<span class="s17">ip</span> <span class="p">(68045 entries), the set of aggregated flows that are considered blacklisted be- cause of a domain name entry on the blacklist as </span>C<span class="s17">dom</span> <span class="p">(22842 entries), and the set of aggregated flows that are considered blacklisted because of both a domain name and IP address entry on the blacklist as </span>C<span class="s17">both</span> <span class="p">(91 entries), where </span>C<span class="s17">ip</span> <span class="s18">[ </span>C<span class="s17">dom</span> <span class="p">= </span>C<span class="s17">black</span> <span class="p">and </span>C<span class="s17">ip</span> <span class="s18">\ </span>C<span class="s17">dom</span> <span class="p">= </span>C<span class="s17">both</span><span class="p">. As </span>C<span class="s17">both</span> <span class="p">contains an insignificant number of entries, this category will not be analysed separately in this paper.</span></p><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="5"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Type of maliciousness</h2><p class="s11" style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">Two sets of blacklisted flows, </span>C<span class="s17">ip</span> <span class="p">and </span>C<span class="s17">domain</span><span class="p">, were identified in the previous section. These are the flows that would have been blocked if DNS based black- lists had been deployed, thus representing a network-level impact of blacklist deployment (subject to scaling due to NetFlow sampling). However, as outlined in the introduction, some blocked flows do not represent a threat to the user</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">due to di↵erent types of maliciousness, and these may be seen as a nuisance instead. To quantify this user-level impact of blacklist deployment, this section will categorize the flows by the type of maliciousness.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">Di↵erent types of malicious behaviour can cause a domain name or IP address to be blacklisted, but only some of the types should be considered a threat to the user connecting to the blacklist entry. The observations turn out to be di↵erent for </span>C<span class="s17">ip</span> <span class="p">and </span>C<span class="s17">domain</span><span class="p">, therefore the observations will be described separately.</span></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l9"><li data-list-text="5.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Flows blacklisted by domain name</h3><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Both the <span class="s11">A </span>and <span class="s11">B </span>lists provide categories for phishing/malware/botnet related domains, as well as a more general spam category. The latter category includes for example domains in unsolicited mails promoting pills, counterfeits, dating sites etc., and is therefore in terms of badness distinct from malware/phishing domains. Although the sites and goods promoted in the spam category may not be desired to most users, they do not represent a cyber security threat. On the other hand, the phishing and malware related domains in what we will define as the malicious category clearly represent a cyber security threat to the user. In <span class="s11">C</span><span class="s17">dom</span>, 3% of the flows are in the malicious category, and the remaining 97% of the flows are in the spam category.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="5.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Flows blacklisted by IP address</h3><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Determining the type of maliciousness for entries in <span class="s11">C</span><span class="s17">ip</span>, requires di↵erent ap- proaches for each list used.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: right;"><span class="p">The </span>B <span class="p">lists provide a cause for an IP address to be blacklisted, and 99% of all IP address entries in the </span>B <span class="p">lists are in the malicious category. However, only 5 entries in </span>C<span class="s17">ip</span> <span class="p">are blacklisted by B list entries (109 entries in the week 2 data set). As this is an insignificant amount compared to the total amount of entries in </span>C<span class="s17">ip</span><span class="p">, no further analysis of the type of maliciousness of these entries is made. Two </span>A <span class="p">lists contain IP addresses: The </span>A<span class="s41">1</span><span class="s34"> </span><span class="p">and </span>A<span class="s41">2</span><span class="s34"> </span><span class="p">lists. The </span>A<span class="s41">1</span><span class="s34"> </span><span class="p">registers only spam emitters, and the 18292 flows blacklisted only by the </span>A<span class="s41">1</span><span class="s34"> </span><span class="p">list (and not also</span></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">the <span class="s11">A</span><span class="s41">2</span><span class="s34"> </span>list) are therefore considered in the spam category.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">The type of maliciousness is not immediately available for the <span class="s11">A</span><span class="s41">2</span><span class="s34"> </span>list. Two distinct groups of <span class="s11">A</span><span class="s41">2</span><span class="s34"> </span>related flows (including flows that relate to both <span class="s11">A</span><span class="s41">2</span><span class="s34"> </span>and <span class="s11">A</span><span class="s41">1</span>) are therefore categorized by other means:</p><ul id="l10"><li data-list-text="–"><p style="padding-top: 6pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">A subset of <span class="s11">A</span><span class="s41">2</span>, called <span class="s11">A</span><span class="s41">3</span><span class="s34"> </span>is available as a separate list. 3179 entries in <span class="s11">C</span><span class="s17">ip</span></p><p style="padding-left: 65pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">are marked by the <span class="s11">A</span><span class="s41">3</span><span class="s34"> </span>(5%) and are therefore in the malicious category.</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: justify;">A substantial amount of entries (13634, 20% of <span class="s11">C</span><span class="s17">ip</span>) relate to a single IP address owned by a laundry company. A manual lookup reveals that this IP address is in the spam category [12].</p></li></ul><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">An informal conversation with list <span class="s11">A </span>representatives concluded that the vast majority of <span class="s11">A</span><span class="s41">2</span><span class="s34"> </span>related flows not accounted for above are likely to be in the spam category as well. However, as we cannot quantify this, we will categorize the remaining flows as having unknown type of maliciousness.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="5.3"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Discussion</h3><p class="s11" style="padding-top: 7pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">The type of maliciousness for the </span>C<span class="s17">ip</span> <span class="p">and </span>C<span class="s17">domain</span> <span class="p">flow sets are listed in Table 6. An important note is that if Telenor Denmark had only deployed domain name based blacklists, and only blocked the flows that are considered malicious to the user, a total of 1360 observed flows would have been blocked during week 2. The unknown </span>C<span class="s17">ip</span> <span class="p">entries are expected to mostly be in the spam category, with an informed guess setting the fraction of malicious flows in </span>C<span class="s17">ip</span> <span class="p">to less than 10%.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:94.466pt" cellspacing="0"><tr style="height:14pt"><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">Type</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:68pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s48" style="padding-top: 1pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">C<span class="s49">ip</span></p></td><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:71pt;border-top-style:solid;border-top-width:1pt"><p class="s48" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">C<span class="s49">dom</span></p></td></tr><tr style="height:13pt"><td style="width:41pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Week 1</p></td><td style="width:68pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 16pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Week 2</p></td><td style="width:36pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Week 1</p></td><td style="width:71pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 18pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Week 2</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:94.466pt" cellspacing="0"><tr style="height:11pt"><td style="width:41pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Spam</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">31926 (47%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">46918 (75%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">22061 (97%)</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">23126 (94%)</p></td></tr><tr style="height:11pt"><td style="width:41pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Malicious</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">3184 (5%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">1151 (2%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">781 (3%)</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">1360 (6%)</p></td></tr><tr style="height:13pt"><td style="width:41pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Unknown</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">32935 (48%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">14614 (23%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">0</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">0</p></td></tr></table><h4 style="padding-left: 45pt;text-indent: 0pt;text-align: center;">Table 6. <span class="s16">Type of maliciousness for blacklisted flow sets.</span></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="text-indent: 0pt;text-align: center;">Type         C<span class="s50">ip</span><span class="s51">      </span>C<span class="s50">dom</span></h4><p class="s5" style="padding-left: 120pt;text-indent: 0pt;text-align: center;">Week 1 Week 2 Week 1 Week 2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:118.968pt" cellspacing="0"><tr style="height:11pt"><td style="width:75pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Spam</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">20%</p></td><td style="width:32pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">13%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">40%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">37%</p></td></tr><tr style="height:11pt"><td style="width:75pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Malicious</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">11%</p></td><td style="width:32pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">47%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">72%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">61%</p></td></tr><tr style="height:13pt"><td style="width:75pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Entire data group</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">39%</p></td><td style="width:32pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">18%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">40%</p></td><td style="width:33pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">38%</p></td></tr></table><p class="s21" style="padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="h4">Table 7. </span><span class="s16">Port 80/443 (HTTP/HTTPS) fraction of flows. In the group of flows that </span>are blacklisted by IP address (is in <span class="s20">C</span><span class="s22">ip</span>) in the week2 data set, 13% of the spam-related <span class="s16">flows in the group use port 80/443, and 18% of all flows in the group use port 80/443.</span></p><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 14pt;text-align: justify;">Some DNS based blocking implementations redirect the user to a web page warning the user that he has been blocked for security reasons. Web traffic, de- fined as traffic towards port 80 and 443, accounts for 40% of the entries in <span class="s11">C</span><span class="s17">dom</span>, and 72% of malware/phishing entries in <span class="s11">C</span><span class="s17">dom</span>. Further numbers are available in Table 7. Measuring the impact of the DNS based blocking by the number of visits to the warning web site will therefore underestimate the efficiency.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="6"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Misaligned endpoints</h2><p style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">In some scenarios where a user connects to a blacklisted IP address, there is a chance that the user does not in fact connect to the entity that caused the IP address to be blacklisted. A popular example is when a user connects to a web site hosted in a shared web hosting environment. The IP address of the shared hosting environment may be on the blacklist, but it may be included on the blacklist even though only one of the hosted sites serves malicious content. In this case, it is not possible to determine from either NetFlow or DNS data if</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">the web site actually accessed by the user is benign or malicious. From a user perspective, this will likely be perceived as a nuisance, as the blacklist will then prevent access to benign sites not representing any risk. To assess the user-level impact of deploying DNS based blacklisting, it is therefore relevant to quantify the fraction of flows in </span>C<span class="s17">ip</span> <span class="p">where the endpoint of the flow and the endpoint causing the IP address to be blacklisted can di↵er. We shall refer to these flows as potentially having misaligned endpoints.</span></p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">An analysis of each individual endpoint IP prefix would be impractical. In order to identify the most prominent groups of </span>C<span class="s17">ip</span> <span class="p">flows, we choose to focus the analysis on the groups of flows where:</span></p><ul id="l11"><li data-list-text="–"><p style="padding-top: 4pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">Many domain names are associated with a single destination IP prefix (high</p><p class="s11" style="padding-left: 65pt;text-indent: 0pt;line-height: 12pt;text-align: left;">qname/dstip <span class="p">ratio)</span></p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: justify;">Many destination IP prefixes are associated with a single domain name (high</p><p class="s11" style="padding-left: 65pt;text-indent: 0pt;line-height: 12pt;text-align: left;">dstip/qname <span class="p">ratio).</span></p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;line-height: 11pt;text-align: justify;">A popular destination IP prefix is used (high <span class="s11">dstip </span>count)</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;line-height: 12pt;text-align: justify;">A popular domain name is used (high <span class="s11">qname </span>count)</p></li></ul><p class="s11" style="padding-top: 5pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">Based on this analysis, three di↵erent scenarios that can cause misaligned end- points has been identified in the </span>C<span class="s17">ip</span> <span class="p">data set, and these three scenarios are elaborated in the following three subsections.</span></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l12"><li data-list-text="6.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Shared content providers</h3><p class="s11" style="padding-top: 5pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">The entries in </span>C<span class="s17">ip</span> <span class="p">with a high </span>qname/dstip <span class="p">ratio all have a </span>dstip <span class="p">owned by a CDN, shared web hosting or similar cloud content provider like Amazon, Mi- crosoft Azure, Google Cloud, DigitalOcean or Tencent. A total of 29556 entries ( 43% of </span>C<span class="s17">ip</span><span class="p">) are related to such servers and we consider these flows to poten- tially having misaligned endpoints.</span></p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">An number of <span class="s11">dstip</span>s are owned by Virtual Private Server (VPS) service providers and regular ISP customers. 516 entries are considered ISP customers as well, as they relate to a server with a dynamic IP address, identified by the use of a .duckdns.org domain name, a service used for assigning a permanent domain name to a dynamic IP address. These will not be considered as potentially misaligned endpoints.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">It could be argued that all destination IP addresses could easily be enumer- ated by the use of BGP AS numbers. In practice, however, this turns out not to be viable for a number of reasons. First, only the /16 prefix address is available due to anonymization, and such a prefix may cover several AS numbers. Second, some providers share the AS number between the ISP and hosting part of the company (like OVH). Third, some providers reserve smaller prefixes for specific customers (like Amazon). Fourth, some providers use IP space assigned to other entities (like Tencent using ChinaUnicom owned IP prefixes).</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">VPN service providers</h3><p style="padding-top: 5pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">VPN service provider (PrivateInternetAccess, Hula, NorthGhost etc.) traffic identified by the <span class="s11">qname </span>accounts for 12469 ( 18%) of all entries in <span class="s11">C</span><span class="s17">ip</span>. The</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">specific implementations by the di↵erent providers is not known. However, it seems unlikely that a user creating a connection towards such an IP address will be relayed to a host residing behind the VPN service. A connection towards such a server seems more likely to be an attempt to use the service. The VPN provider IP addresses are likely to have been blacklisted because hosts using the service generated traffic that triggered a blacklisting. We shall therefore consider the VPN provider IP addresses as potentially having misaligned endpoints.</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6.3"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">NTP Pool</h3><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Traffic towards hosts registered in the ntppool project<span class="s2">4</span><span class="s34"> </span>is identified by the <span class="s11">qname </span>containing .pool.ntp.org. This traffic accounts for 4006 ( 6%) of all entries in <span class="s11">C</span><span class="s17">ip</span>. A DNS request for a .pool.ntp.org domain will return a number of IP addresses, where each IP address belongs to a pool member. If the IP address of one of the pool members in the DNS response is blacklisted, the entire DNS response is considered blacklisted. Therefore, a connection towards a di↵erent pool member will be considered part of <span class="s11">C</span><span class="s17">ip</span>. This is not considered a flaw in the data analysis, as it reflects how DNS based blacklisting is implemented in practice. Blacklist- ing relates to the entire DNS request/response pair, not just to single response resource records. It is therefore likely that these flows have misaligned endpoints.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6.4"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Discussion</h3><p class="s11" style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="p">Table 8 summarizes the amount of flows that may have misaligned endpoints and lists the 3 identified scenarios causing the potential misalignment. As seen in the table, we consider at least 45698 of 68045 </span>C<span class="s17">ip</span> <span class="p">entries (67%) as potentially having misaligned endpoints. Blocking these flows involves a risk of blocking benign sites. Although the specific IP address on the blacklist may be correct by reflecting a malicious endpoint using that IP address (a true positive), the user may perceive it as a false positive. When a provider considers deploying DNS based blacklists that includes IP addresses, the willingness of both operators and users to accept this risk should therefore be carefully considered up front.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:116.688pt" cellspacing="0"><tr style="height:13pt"><td style="width:103pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Cause</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Week 1</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s13" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Week 2</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:116.688pt" cellspacing="0"><tr style="height:11pt"><td style="width:103pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Shared content providers</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">29556 (43%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">19370 (31%)</p></td></tr><tr style="height:11pt"><td style="width:103pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">VPN service providers</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">12469 (18%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">13710 (22%)</p></td></tr><tr style="height:11pt"><td style="width:103pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">NTP pool</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">4006 (6%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">3505 (6%)</p></td></tr><tr style="height:13pt"><td style="width:103pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Total</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">45698 (67%)</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s14" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: left;">36336 (58%)</p></td></tr></table><p class="s21" style="padding-left: 48pt;text-indent: 0pt;text-align: justify;"><span class="s52">Table 8. </span>Amount of entries in <span class="s20">C</span><span class="s22">ip </span>with di↵erent causes for potential endpoint mis- <span class="s16">alignment. Note that the total is less than the sum, as for example an NTP pool entry may also be a shared content provider entry, and this only counts as 1 in the total.</span></p><p style="padding-top: 7pt;padding-left: 48pt;text-indent: 14pt;text-align: left;">Of the 45698 entries, only 5 are tagged by the <span class="s11">B </span>lists, while the rest is tagged by <span class="s11">A </span>lists. This highlights that the choice of blacklists represent an important</p><p class="s3" style="padding-top: 6pt;padding-left: 51pt;text-indent: 0pt;text-align: left;">4<span class="s4"> </span><a href="http://www.ntppool.org/" class="s53" target="_blank">https://www.ntppool.org/</a></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">limitation to the results presented in this section. The numbers presented are unlikely to be representative of other blacklists. However, looking outside the scope of this paper, this also suggests that when considering deploying DNS based blacklisting, the concept of IP address blacklists should not necessarily be deselected upfront. The risk of blocking benign sites due to endpoint mis- alignment can be decreased significantly by the careful selection of IP address blacklists.</p><p class="s11" style="padding-left: 48pt;text-indent: 14pt;text-align: justify;"><span class="p">As outlined in Section 2, we are only aware of one other paper that evaluates the risk of misaligned endpoints for the individual blacklist entries [8]. However, it is important to notice that the results presented in this section would not be directly comparable, as they relate to the blacklisted flows (</span>C<span class="s17">black</span><span class="p">), not the blacklisted DNS responses (</span>D<span class="s17">black</span> <span class="p">) or the individual entries on a blacklist (the latter being the focus of [8]). The primary purpose of our work is to present the method of using NetFlow to measure the impact of deploying blacklists using a specific set of blacklists as examples, and not to compare blacklists. Hence, we consider evaluating a larger number of blacklists as an extension to this paper.</span></p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="7"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Impact</h2><p style="padding-top: 10pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Sections 3-6 identify blacklisted flows, identify the type of maliciousness and assess the risk of endpoint misalignment. This section combines the result of the previous sections to quantify impact of deploying DNS-based blacklists seen from the network perspective and from the user perspective. Furthermore, this section describes interesting future works.</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l13"><li data-list-text="7.1"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">Network-level impact</h3><p style="padding-top: 6pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">The network-level impact of DNS based blocking is usually practically measured by counting the number of blocked DNS requests or by counting the number of visits to a warning page to which a user has been redirected. In this paper, the impact is instead measured using the number of blocked flows instead, and this reveals the fraction of web related flows.</p><ul id="l14"><li data-list-text="–"><p style="padding-top: 6pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">Approximately 0,02-0,03% of all DNS responses match a blacklist entry, and 1,1-1,5% of these blacklisted DNS responses can be associated with an ob- served flow, denoted a blacklisted flow. The use of sampled flow data was found to hinder the estimation of the actual fraction of blacklisted DNS re- sponses that can be associated with a flow. Researchers or ISPs with access to non-sampled NetFlow and DNS data should assess the fraction of black- listed DNS responses that can be associated with a flow. Given a known amount of blacklisted DNS responses, this would make it possible to more accurately assess impact of doing DNS based blocking.</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: justify;">Some DNS based blocking implementations redirect the user to a website containing a message warning the user that he has been blocked for security reasons. Therefore, such implementations measure only the part of the traf- fic that is web traffic. Of the flows blacklisted by domain name, 38-40% are</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">web traffic. Of the flows blacklisted by domain name <span class="s11">and </span>considered having a high threat level, 61-72% are web traffic. Therefore, this paper shows that measuring the impact of blacklisting by the number of visits to the warning web site underestimates the impact. ISPs and company system administra- tors should implement measures to also count non-web related connections, in order to get a more correct assessment of the blacklist impact.</p><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">These results are specific to a particular week, use particular blacklist vendors, and a particular ISP. Despite the listed limitations, we find the results significant enough to suggest that the method of using NetFlow to measure the impact of applying DNS based blacklists represents an improvement to existing methods.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li data-list-text="7.2"><h3 style="padding-left: 74pt;text-indent: -26pt;text-align: left;">User-level impact</h3><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">Approximately 25% of the blacklisted flows relate to a blacklisted domain name, whereas the remaining 75% of the blacklisted flows relate to a blacklisted IP address.</p><ul id="l15"><li data-list-text="–"><p style="padding-top: 7pt;padding-left: 65pt;text-indent: -10pt;text-align: justify;">The flows blacklisted by domain name are, using the threat type categories provided by the blacklist vendors, divided into two groups. First, a group relating to general spam, considered a nuisance rather than a cyber security threat, accounts for 94-97% of the flows. Second, a group relating to phishing, malware and botnet accounts for the remaining 3-6%. When deploying DNS based blacklisting, it is therefore important to consider if both or only one of these types of traffic should be blocked, as this will have a significant impact on the amount of blocked connections experienced by the user.</p></li><li data-list-text="–"><p style="padding-left: 65pt;text-indent: -10pt;text-align: justify;">Of the flows blacklisted by IP address, this paper shows that 58-67% may be flows towards benign sites, primarily due to the prevalence of shared web hosting, whereby multiple web sites / domain share the same IP address. From a user and operator perspective, the willingness to risk blocking benign sites must be considered before deploying IP address based blacklists. This study shows that carefully selecting the IP address blacklist vendor can be a significant contribution to minimizing this risk.</p><p style="padding-top: 8pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">These results are also specific to particular blacklist vendors and a particular ISP. Here, however, we show that the specific measurements depend a lot on the particular blacklist used, and therefore it is a clear limitation that these results cannot be generalized to di↵erent blacklists.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li></ul></li></ol></li><li data-list-text="8"><h2 style="padding-left: 68pt;text-indent: -20pt;text-align: left;">Conclusion</h2></li></ol><p style="padding-top: 11pt;padding-left: 48pt;text-indent: 0pt;text-align: justify;">In this paper, we propose a method to measure the impact of deploying blacklists by combining NetFlow and DNS data. We evaluate the method on real data, containing anonymised NetFlow and DNS records collected by Telenor Denmark for two weeks, and combine these with blacklists containing IP addresses and domain names provided by two commercial vendors.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">The measurements show that 0,02-0,03% of all DNS responses match a black- list entry, however only 1,1-1,5% of these blacklisted DNS responses can be asso- ciated with an observed flow. Furthermore, only 38-40% of the blacklisted flows are web traffic. These observations suggest that the use of flow data can be used to make a more precise impact assessment than counting the amount of DNS re- sponses matching a blacklist entry or counting the amount of visits to a warning web page.</p><p style="padding-left: 48pt;text-indent: 14pt;text-align: justify;">For flows blacklisted by domain name, 3-6% of the flows related to phishing, malware and botnet domains, while the remaining flows relate to spam domains. For the flows blacklisted by IP address, 58-67% may be flows towards benign sites. These observations show that it the careful consideration of the choice of blacklist type (domain name or IP address) and category (spam, malware etc.) before deployment is essential to avoid undesired impact seen from a user perspective when deploying DNS-based blacklists.</p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 48pt;text-indent: 0pt;text-align: left;">References</h2><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l16"><li data-list-text="1."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;text-align: justify;">Bermudez, I.N., Mellia, M., Munaf`o, M.M., Keralapura, R., Nucci, A.: DNS to the Rescue: Discerning Content and Services in a Tangled Web. IMC: Internet Measurement Conference (2012), <span class="s7">https://doi.org/10.1145/2398776.2398819</span></p></li><li data-list-text="2."><p class="s7" style="padding-left: 65pt;text-indent: -12pt;text-align: justify;"><a href="http://www.usenix.org/system/files/" class="s53" target="_blank">Bouwman, X., Griffioen, H., Egbers, J., Doerr, C., Klievink, B., van Eeten, M.: A di↵erent cup of TI? The added value of commercial threat intelligence. USENIX Security Symposium (2020), </a>https://www.usenix.org/system/files/ sec20-bouwman.pdf</p></li><li data-list-text="3."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;line-height: 107%;text-align: justify;">Cisco Umbrella: Better intelligence drives better security (2020), <span class="s7">https:// umbrella.cisco.com/solutions/reduce-security-infections</span></p></li><li data-list-text="4."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;line-height: 11pt;text-align: justify;">Connery, H.: DNS: Response Policy Zone (2012), <span class="s7">https://dnsrpz.info/</span></p><p class="s7" style="padding-left: 65pt;text-indent: 0pt;text-align: left;">spamhaus-rpz-case-study.pdf</p></li><li data-list-text="5."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;text-align: justify;">Duffield, N., Lund, C., Thorup, M.: Properties and prediction of flow statistics from sampled packet streams. IMW: ACM SIGCOMM Internet Measurement Workshop (2002), <span class="s7">https://doi.org/10.1145/637201.637225</span></p></li><li data-list-text="6."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;text-align: justify;">Fejrskov, M., Pedersen, J.M., Vasilomanolakis, E.: Cyber-security research by ISPs: A NetFlow and DNS Anonymization Policy. International Conference on Cyber Security And Protection Of Digital Services (2020), <span class="s7">https://doi.org/10.1109/ CyberSecurity49315.2020.9138869</span></p></li><li data-list-text="7."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;line-height: 109%;text-align: justify;">Foremski, P., Callegari, C., Pagano, M.: DNS-Class: immediate classification of IP flows using DNS. ACM Internation Journal of Network Management (2014), <span class="s7">https://doi.org/10.1002/nem.1864</span></p></li><li data-list-text="8."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;line-height: 10pt;text-align: justify;">Griffioen, H., Booij, T., Doerr, C.: Quality Evaluation of Cyber Threat Intelligence</p><p class="s5" style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">Feeds. ACNS: International Conference on Applied Cryptography and Network Security (2020), <span class="s7">https://doi.org/10.1007/978-3-030-57878-7_14</span></p></li><li data-list-text="9."><p class="s5" style="padding-left: 65pt;text-indent: -12pt;text-align: justify;">Jung, J., Sit, E.: An empirical study of spam traffic and the use of DNS black lists. IMC: Internet Measurement Conference (2004), <span class="s7">https://doi.org/10.1145/ 1028788.1028838</span></p></li><li data-list-text="10."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 109%;text-align: justify;">Ku¨hrer, M., Rossow, C., Holz, T.: Paint It Black: Evaluating the E↵ectiveness of Malware Blacklists. RAID: Research in Attacks, Intrusions and Defenses (2014), <span class="s7">https://doi.org/10.1007/978-3-319-11379-1_1</span></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="11."><p class="s7" style="padding-left: 65pt;text-indent: -16pt;text-align: justify;"><a href="http://www.usenix.org/system/files/" class="s53" target="_blank">Li, V.G., Dunn, M., Pearce, P., McCoy, D., Voelker, G.M., Savage, S., Levchenko, K.: Reading the Tea leaves: A Comparative Analysis of Threat Intelligence. USENIX Security Symposium (2019), </a>https://www.usenix.org/system/files/ sec19-li-vector_guo.pdf</p></li><li data-list-text="12."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 11pt;text-align: justify;">MXToolbox: Blacklist check (2021), <span class="s7">https://mxtoolbox.com/blacklists.aspx</span></p></li><li data-list-text="13."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;text-align: justify;">Ramachandran, A., Feamster, N.: Understanding the Network-Level Behavior of Spammers. ACM SIGCOMM Computer Communication Review (2006), <span class="s7">https:</span></p><p class="s7" style="padding-left: 65pt;text-indent: 0pt;line-height: 10pt;text-align: left;">//doi.org/10.1145/1159913.1159947</p></li><li data-list-text="14."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;text-align: justify;">Satoh, A., Nakamura, Y., Fukuda, Y., Sasai, K., Kitagata, G.: A Cause-Based Classification Approach for Malicious DNS Queries Detected Through Blacklists. IEEE Access (2019), <span class="s7">https://doi.org/10.1109/ACCESS.2019.2944203</span></p></li><li data-list-text="15."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Sheng, S., Wardman, B., Warner, G., Cranor, L., Hong, J., Zhang, C.: An empirical</p><p class="s5" style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">analysis of phishing blacklists. CEAS: Conference on Email and Anti-Spam (2009),</p><p class="s7" style="padding-top: 1pt;padding-left: 65pt;text-indent: 0pt;line-height: 10pt;text-align: left;">https://doi.org/10.1184/R1/6469805.V1</p></li><li data-list-text="16."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;text-align: justify;">Sinha, S., Bailey, M., Jahanian, F.: Shades of grey: On the e↵ectiveness of reputation-based ”blacklists”. MALWARE: International Conference on Mali- cious and Unwanted Software (2008), <span class="s7">https://doi.org/10.1109/MALWARE.2008. 4690858</span></p></li><li data-list-text="17."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Spacek, S., Lastovicka, M., Horak, M., Plesnik, T.: Current Issues of Malicious</p><p class="s5" style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">Domains Blocking. IFIP/IEEE International Symposium on Integrated Network Management (2019), <span class="s7">https://ieeexplore.ieee.org/document/8717891</span></p></li><li data-list-text="18."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">SpringerNature:  Accepted  manuscript  terms  of  use  (2021),</p><p class="s7" style="padding-top: 1pt;padding-left: 65pt;text-indent: 0pt;line-height: 107%;text-align: left;">https://www.springernature.com/gp/open-research/policies/ accepted-manuscript-terms</p></li><li data-list-text="19."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Telenor Norway: Stanset over 80.000 besøk p˚a falske nettsider p˚a ´en</p><p class="s7" style="padding-left: 65pt;text-indent: 0pt;line-height: 107%;text-align: left;"><a href="http://www.mynewsdesk.com/no/telenor/pressreleases/" class="s53" target="_blank">m˚aned  (2020),  </a>https://www.mynewsdesk.com/no/telenor/pressreleases/ stanset-over-80-dot-000-besoek-paa-falske-nettsider-paa-en-maaned-2986773</p></li><li data-list-text="20."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Wikipedia: Domain Name System-based Blackhole List (2020), <span class="s7">https://en.</span></p><p class="s7" style="padding-left: 65pt;text-indent: 0pt;line-height: 10pt;text-align: left;">wikipedia.org/wiki/Domain_Name_System-based_Blackhole_List</p></li><li data-list-text="21."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;text-align: justify;">Wilde, N., Jones, L., Lopez, R., Vaughn, T.: A DNS RPZ Firewall and Current American DNS Practice. ICISA: International Conference on Information Science and Applications (2019), <span class="s7">https://doi.org/10.1007/978-981-13-1056-0_27</span></p></li><li data-list-text="22."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Williamson,   R.:   What   do   Canada   and   New   Zealand</p><p class="s5" style="padding-left: 65pt;text-indent: 0pt;line-height: 107%;text-align: left;">have   in   common?   (2020),   <span class="s7">https://internetnz.nz/blog/ dns-firewall-what-do-canada-and-new-zealand-have-in-common/</span></p></li><li data-list-text="23."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 9pt;text-align: justify;">Zhang, J., Chivukula, A., Bailey, M., Karir, M., Liu, M.: Characterization</p><p class="s5" style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">of Blacklists and Tainted Network Traffic. PAM: International Conference on Passive and Active Network Measurement (2013), <span class="s7">https://doi.org/10.1007/ 978-3-642-36516-4_22</span></p></li><li data-list-text="24."><p class="s5" style="padding-left: 65pt;text-indent: -16pt;line-height: 10pt;text-align: justify;">Zhauniarovich, Y., Khalil, I., Yu, T., Dacier, M.: A survey on malicious domains</p></li></ol><p class="s5" style="padding-left: 65pt;text-indent: 0pt;text-align: justify;">detection through DNS data analysis. ACM Computing Surveys (2018), <span class="s7">https:</span></p><p class="s7" style="padding-left: 65pt;text-indent: 0pt;text-align: left;">//doi.org/10.1145/3191329</p></body></html>
