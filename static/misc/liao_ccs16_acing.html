<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>liao_ccs16_acing</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 18pt; }
 .s1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt; }
 .s3 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 3pt; }
 .s4 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s5 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .p, p { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s6 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s7 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s8 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s9 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s11 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s12 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .a, a { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s13 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s14 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s15 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 h3 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s16 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s17 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s18 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 1pt; }
 .s19 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s20 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s21 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s22 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s25 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s26 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s27 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s28 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6.5pt; }
 .s29 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 5.5pt; }
 .s30 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; }
 .s32 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s33 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s34 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s35 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s36 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: -1pt; }
 .s37 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s38 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s39 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s40 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s41 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s42 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s45 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s46 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s47 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s48 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 2pt; }
 .s49 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 2pt; }
 .s50 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s51 { color: #F00; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s52 { color: #0070C0; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s53 { color: black; font-family:"Apple Symbols", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s54 { color: black; font-family:"Apple Symbols", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2.5pt; vertical-align: -1pt; }
 .s55 { color: black; font-family:"Apple Symbols", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s56 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s57 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s58 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s59 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: -4pt; }
 .s60 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: -4pt; }
 .s61 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s62 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s63 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 9pt; }
 .s64 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 5pt; }
 .s65 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s66 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 5pt; }
 .s67 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 5pt; }
 .s68 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s69 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s70 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 4pt; }
 h4 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s75 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; vertical-align: 1pt; }
 .s76 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, decimal)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "✓ "; color: black; font-family:"Lucida Grande", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l3 {padding-left: 0pt; }
 #l3> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 #l4 {padding-left: 0pt;counter-reset: c2 1; }
 #l4> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 #l5 {padding-left: 0pt;counter-reset: c2 1; }
 #l5> li>*:first-child:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: c2 0;  }
 li {display: block; }
 #l6 {padding-left: 0pt;counter-reset: f1 4; }
 #l6> li>*:first-child:before {counter-increment: f1; content: counter(f1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l7 {padding-left: 0pt; }
 #l7> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l8 {padding-left: 0pt;counter-reset: f3 1; }
 #l8> li>*:first-child:before {counter-increment: f3; content: counter(f3, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 #l8> li:first-child>*:first-child:before {counter-increment: f3 0;  }
 li {display: block; }
 #l9 {padding-left: 0pt;counter-reset: g1 4; }
 #l9> li>*:first-child:before {counter-increment: g1; content: counter(g1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l9> li:first-child>*:first-child:before {counter-increment: g1 0;  }
 #l10 {padding-left: 0pt;counter-reset: g2 1; }
 #l10> li>*:first-child:before {counter-increment: g2; content: counter(g1, decimal)"."counter(g2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l10> li:first-child>*:first-child:before {counter-increment: g2 0;  }
 #l11 {padding-left: 0pt;counter-reset: h1 1; }
 #l11> li>*:first-child:before {counter-increment: h1; content: "("counter(h1, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: h1 0;  }
 #l12 {padding-left: 0pt;counter-reset: g3 1; }
 #l12> li>*:first-child:before {counter-increment: g3; content: "("counter(g3, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: g3 0;  }
 li {display: block; }
 #l13 {padding-left: 0pt;counter-reset: i1 5; }
 #l13> li>*:first-child:before {counter-increment: i1; content: counter(i1, decimal)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: i1 0;  }
 #l14 {padding-left: 0pt;counter-reset: i2 1; }
 #l14> li>*:first-child:before {counter-increment: i2; content: counter(i1, decimal)"."counter(i2, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l14> li:first-child>*:first-child:before {counter-increment: i2 0;  }
 li {display: block; }
 #l15 {padding-left: 0pt;counter-reset: j1 1; }
 #l15> li>*:first-child:before {counter-increment: j1; content: "["counter(j1, decimal)"] "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 #l15> li:first-child>*:first-child:before {counter-increment: j1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><h1 style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: center;">Acing the IOC Game: Toward Automatic Discovery and Analysis of Open-Source Cyber Threat Intelligence</h1><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s2" style="padding-left: 60pt;text-indent: 0pt;line-height: 89%;text-align: center;"><span class="s1">Xiaojing Liao</span>1<span class="s3">∗</span><span class="s1">, Kan Yuan</span>2<span class="s3">∗</span><span class="s1">, XiaoFeng Wang</span>2<span class="s1">, Zhou Li</span>3<span class="s1">, Luyi Xing</span>2<span class="s1">, Raheem Beyah</span>1<span class="s4"> </span>1<span class="s1">Georgia Institute of Technology, </span>2<span class="s1">Indiana University Bloomington, </span>3<span class="s1">ACM member</span></p><p style="padding-left: 32pt;text-indent: 0pt;line-height: 11pt;text-align: center;"><a href="mailto:lzcarl@gmail.com" class="s5" target="_blank">{xliao, rbeyah}@gatech.edu, {kanyuan, xw7, luyixing}@indiana.edu, lzcarl@gmail.com</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">ABSTRACT</h2><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">To adapt to the rapidly evolving landscape of cyber threats, secu- rity professionals are actively exchanging <i>Indicators of Compro- mise </i>(IOC) (e.g., malware signatures, botnet IPs) through public</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">“Alina makes use of the HKCU\Software\Microsoft</p><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">\Windows\CurrentVersion\Run registry key”</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</p><p class="s8" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">Header</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">&lt;OpenIOC xmlns:xsi= … … &gt;</p><p class="s7" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">&lt;description&gt;This IOC detects ...&lt;/description&gt;</p><p class="s7" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">&lt;authored_by&gt;@iocbucket&lt;/authored_by&gt;</p><p class="s7" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">&lt;authored_date&gt;2014-02-07T14:35:14&lt;/authored_date&gt;</p><p class="s7" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">&lt;definition&gt;</p><p class="s7" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">&lt;Indicator id=&quot;1a0ee12e-dc16-4ae9-b508-d7728df81a5e&quot; operator=&quot;OR&quot;&gt;</p><p class="s9" style="padding-left: 5pt;text-indent: 6pt;line-height: 119%;text-align: left;">&lt;IndicatorItem id=&quot;ac152ab7-370a-48cb-ad7a-042e9bdf4bc2&quot; condition=&quot;contains&quot; preserve-case=&quot;false&quot; negate=&quot;false&quot;&gt;</p><p class="s9" style="padding-left: 14pt;text-indent: 0pt;line-height: 4pt;text-align: left;">&lt;Context document=&quot;RegistryItem&quot; <b>search=&quot;RegistryItem/KeyPath&quot;</b></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">sources (e.g. blogs, forums, tweets, etc.). Such information, of- ten presented in articles, posts, white papers etc., can be converted into a machine-readable OpenIOC format for automatic analysis and quick deployment to various security mechanisms like an in- trusion detection system. With hundreds of thousands of sources in the wild, the IOC data are produced at a high volume and veloc- ity today, which becomes increasingly hard to manage by humans. Efforts to automatically gather such information from unstructured text, however, is impeded by the limitations of today’s Natural Lan- guage Processing (NLP) techniques, which cannot meet the high standard (in terms of accuracy and coverage) expected from the IOCs that could serve as direct input to a defense system.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">In this paper, we present <i>iACE</i>, an innovation solution for fully automated IOC extraction. Our approach is based on the obser- vation that the IOCs in technical articles are often described in a predictable way: being connected to a set of context terms (e.g., “download”) through stable grammatical relations. Leveraging this observation, iACE is designed to automatically locate a putative IOC token (e.g., a zip file) and its context (e.g., “malware”, “down- load”) within the sentences in a technical article, and further an- alyze their relations through a novel application of graph mining techniques. Once the grammatical connection between the tokens is found to be in line with the way that the IOC is commonly pre- sented, these tokens are extracted to generate an OpenIOC item that describes not only the indicator (e.g., a malicious zip file) but also its context (e.g., download from an external source). Running on 71,000 articles collected from 45 leading technical blogs, this new approach demonstrates a remarkable performance: it gener- ated 900K OpenIOC items with a precision of 95% and a coverage over 90%, which is way beyond what the state-of-the-art NLP tech- nique and industry IOC tool can achieve, at a speed of thousands of articles per hour. Further, by correlating the IOCs mined from the articles published over a 13-year span, our study sheds new light on</p><p class="s11" style="padding-top: 8pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">1<span class="p">The two lead authors are ordered alphabetically.</span></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="mailto:permissions@acm.org" class="a" target="_blank">Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full cita- tion on the first page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re- publish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from </a><a href="mailto:permissions@acm.org" target="_blank">permissions@acm.org.</a></p><p class="s13" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: justify;">CCS’16, October 24-28, 2016, Vienna, Austria</p><p class="s14" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"> <span class="s12">c 2016 ACM. ISBN 978-1-4503-4139-4/16/10. . . $15.00</span></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="http://dx.doi.org/10.1145/2976749.2978315" class="a" target="_blank">DOI: </a><a href="http://dx.doi.org/10.1145/2976749.2978315" class="s15" target="_blank">http://dx.doi.org/10.1145/2976749.2978315</a></p><p class="s9" style="padding-left: 110pt;text-indent: 0pt;text-align: left;">type=&quot;mir&quot;/&gt;</p><p class="s8" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">Definition</p><p style="text-indent: 0pt;text-align: left;"/><p class="s9" style="padding-left: 119pt;text-indent: 0pt;text-align: left;">&lt;Content type=&quot;string&quot;&gt;<b>Windows\CurrentVersion\Run</b>&lt;/C ontent&gt;</p><p class="s9" style="padding-left: 117pt;text-indent: 0pt;text-align: left;">&lt;/IndicatorItem&gt;</p><p class="s7" style="padding-left: 117pt;text-indent: 0pt;text-align: left;">… …</p><p class="s7" style="padding-left: 114pt;text-indent: 0pt;text-align: left;">&lt;/Indicator&gt;</p><p class="s7" style="padding-left: 114pt;text-indent: 0pt;text-align: left;">… …</p><p class="s7" style="padding-left: 112pt;text-indent: 0pt;text-align: left;">&lt;/definition&gt;</p><p class="s7" style="padding-left: 110pt;text-indent: 0pt;text-align: left;">&lt;/OpenIOC&gt;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 48pt;text-indent: 0pt;text-align: justify;">Figure 1: Example of OpenIOC schema.</h3><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">the links across hundreds of seemingly unrelated attack instances, particularly their shared infrastructure resources, as well as the im- pacts of such open-source threat intelligence on security protection and evolution of attack strategies.</p><ol id="l1"><li data-list-text="1."><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">INTRODUCTION</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">According to Gartner, <i>Cyber Threat Intelligence </i>(CTI) is defined as “evidence-based knowledge, including context, mechanisms, in- dicators, implications and actionable advice, about an existing or emerging menace or hazard to assets that can be used to inform decisions regarding the subject’s response to that menace or haz- ard” [42]. Such knowledge is essential for an organization to gain visibility into the fast-evolving threat landscape, timely identify early signs of an attack and the adversary’s strategies, tactics and techniques, and effectively contain the attack with proper means. Given its importance, CTI has been aggressively collected and in- creasingly exchanged across organizations, often in the form of <i>In- dicators of Compromise </i>(IOC) [35], which are forensic artifacts of an intrusion such as virus signatures, IPs/domains of botnets, MD5 hashes of attack files, etc. Once collected, these IOCs can be automatically transformed and fed into various defense mecha- nisms (e.g., intrusion detection systems) when they are formatted in accordance with a threat information sharing standard, such as OpenIOC [9], that enables characterization of sophisticated attacks like drive-by downloads. The challenge, however, comes from the effective gathering of such information, which entails significant burdens for timely analyzing a large amount of data.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Finding IOCs online: challenges<span class="p">. While IOCs can be extracted from traditional blacklists, like CleanMX [22] and PhishTank [37], the information delivered by such IOCs is rather thin: only a small number of IOC classes are covered (URL, domain, IP and MD5), the relation between IOCs is not revealed and no context informa- tion is provided (e.g., the criminal group behind malfeasance). An- alyzing the cyber-attack campaigns and triaging incident responses become quite difficult when relying on such information. Instead, IOCs from articles in technical blogs and posts in forums are more favorable to security practitioners and extensively harvested, since comprehensive descriptions of the attack are often found there. Such</span></h3><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">descriptions are typically informal, in natural languages, and need to be analyzed semantically to recover related attack indicators, be-</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">dobj</p><p class="s16" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">nmod:from</p><p class="s16" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">case</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IOC token</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">fore they can be converted into the standard IOC format such as</p><p class="s18" style="padding-left: 5pt;text-indent: 0pt;line-height: 4pt;text-align: left;">det nsubj   <span class="s16">det compound</span></p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;line-height: 4pt;text-align: left;">det</p><p class="s16" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">C<span class="s19">ontext term</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">OpenIOC, as illustrated in Figure 1. For years, this has been done manually by security analysts. Increasingly, however, the volume and velocity of the information generated from these sources be- come hard to manage by humans in a cost-effective way. As an example, in our research, we studied over 71,000 articles from 45 technical blogs extensively used by security professionals and found that the number of articles posted here has grown from merely a handful back 10 years ago to over 1,000 every month since last year (see Section 4.1). Note that these blogs are just a drop in the bucket: for example, Recorded Future is reported to utilize over 650,000 open web sources in 7 languages to harvest IOCs [41]. With the huge amount of information produced by those sources, new technologies are in dire need to <i>automate </i>the identification and extraction of valuable CTI involved.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Automatic collection of IOCs from natural-language texts is chal- lenging. Simple approaches like finding IP, MD5 and other IOC- like strings in an article, as today’s IOC providers (AlienVault, Recorded Future) do, does not work well in practice, which eas- ily brings in false positives, mistaking non-IOCs for IOCs: e.g., as illustrated in Figure 2, although three zip files show up in attack- related articles, MSMSv25-Patch1.zip is clearly not an IOC while the other two are. Further, even for a confirmed IOC, we need to know its context, e.g., whether it is linked to drive-by download (ok.zip in the figure) or Phishing (clickme.zip), in order to convert it to the IOC format and help an organization determine its response. This can only be done by establishing a relation between the IOC token and other content in the article, such as the terms “downloads”, “attachment” in the example.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Identifying semantic elements (called <i>Named Entity Recognition </i>or NER [33]) and extracting relations between them (called <i>Rela- tion Extraction</i>, or RE [18]) have been extensively studied in the Natural Language Processing (NLP) community. However, ex- isting NLP techniques <i>cannot </i>be directly applied for IOC and its context discovery. NER systems are known to be brittle, highly domain-specific — those designed for one domain hardly work well on the other domain [45]. So far, we are not aware of any NER techniques developed specifically for recognizing IOCs and a direct use of the state-of-the-art tools like Stanford NER [26] leads to low precision (around 70%) and recall (less than 50%) (see Sec- tion 4). Further, the current study on RE focuses on the relation between two known entities, which are typically nominals [24], whereas the relations between an IOC and the terms describing its context (which we call <i>context terms</i>) are way more compli- cated: e.g., “downloads” and ok.zip has a verb-noun relation. Also important, the accuracy and coverage offered by the existing RE tools are typically low. For example, the classic tree kernel ap- proach [24] reports a precision between 50 and around 90% and a recall between 10 and 50%. As another example, a recent proposal for extracting events among genes and proteins from biomedical literature [45] has a precision and recall around 50%. This level of performance cannot meet the demand for high-quality IOCs, which could go straight to a security system to offer immediate protection for an organization.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>iACE</b>. A key observation from the open intelligence sources pro- ducing high-quality IOCs is that technical articles and posts tend to describe IOCs in a simple and straightforward manner, using a fixed set of context terms (e.g., “download”, “attachment”, “PE”, “Reg- istry”, etc.), which are related to the <i>iocterms </i>used in OpenIOC to label the types of IOCs [9]. Further, the grammatical connections between such terms and their corresponding IOCs are also quite</p><ul id="l2"><li data-list-text="✓"><p class="s20" style="padding-left: 20pt;text-indent: -13pt;text-align: left;">The Trojan downloads a file ok.zip from the server.</p></li><li data-list-text="✓"><p class="s20" style="padding-top: 5pt;padding-left: 19pt;text-indent: -13pt;text-align: left;">All e-mails collected have had attachments clickme.zip.</p></li><li data-list-text="✓"><p class="s21" style="padding-top: 4pt;padding-left: 18pt;text-indent: -12pt;text-align: left;">I<span class="s20">t contains a shellcode at offset 3344 that downloads and execute a PE32 file from the server.</span></p></li></ul><ul id="l3"><li data-list-text="•"><p class="s22" style="padding-top: 5pt;padding-left: 18pt;text-indent: -12pt;text-align: left;">The malware does <u>not modify AndroidManifest.xml</u> in such a way.</p></li><li data-list-text="•"><p class="s22" style="padding-top: 4pt;padding-left: 18pt;text-indent: -12pt;text-align: left;">It’s available as a Free <u>30</u> day trial <u>download</u><span class="s20">.</span></p></li><li data-list-text="•"><p class="s20" style="padding-top: 5pt;padding-left: 20pt;text-indent: -13pt;text-align: left;">Microsoft has already released an out-of-band patch <u>MSMSv25-Patch1.zip</u></p></li></ul><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 21pt;text-align: left;"><b>Figure 2: Examples of sentences with/without IOC. </b>stable: e.g., the verb “downloads” followed by the nouns “file” and ok.zip (the IOC) with a compound relation; “attachments” and clickme.zip also with the compound relation. This allows us to leverage such relations to identify an IOC and its context tokens, combining the NER and RE steps together. To this end, we devel- oped a new approach, called <i>iACE </i>(IOC Automatic Extractor), in our research, which tailors NLP techniques to the unique features of IOC discovery. More specifically, after preprocessing articles</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">(using <i>topic-term classification </i>to find those likely involving IOCs and converting figures to text), iACE utilizes a set of regular expres- sions (regex) and common context terms extracted from iocterms to locate the sentences within the articles that contain <i>putative IOC to- kens</i>, such as IP, MD5-like string. Within each of such sentences, our approach attempts to establish a relation between the IOC token and the context term: it converts the sentence into a <i>Dependency Graph </i>(DG) to describe its grammatical structure and extracts the shortest paths linking each pair of a context token and the putative IOC token; over each path, a <i>graph mining </i>technique is applied to analyze the relation between the tokens, which cannot be handled by existing RE techniques, for the purpose of determining whether they indeed include an IOC and its context.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">This simple approach leverages the known “anchors” (context and regex terms) to locate potential IOC-carrying sentences and the predictable relations among them to capture IOCs, avoiding the complexity of direct application of existing NLP techniques, which needs to solve the NER first to identify an IOC token before ad- dressing the RE problem to find its context. Our evaluations on a prototype we built show that this new technique is very effective in practice: it achieved a precision of 95% at a coverage over 90%. In the meantime, our system is also highly efficient, capable of ana- lyzing four articles per second even with a single process.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Our discoveries<span class="p">. Running on all 71,000 articles collected from the 45 blogs (including AlienVault, Malwarebytes, Webroot, etc.) in the past 13 years (from 2003/01 to 2016/04), iACE automatically extracted 900K IOC tokens together with their context. By inspect- ing these items and correlating them across different blogs over the long time frame, we were able to gain an unprecedented un- derstanding of the relations between different attacks reported, the impact of open-source threat intelligence on attack evolutions, the defense responses it triggered, as well as the qualities of these blogs and effectiveness of the IOCs they document. More specifically, we found that some apparently unrelated attack instances were actually connected, sharing the same attack assets and infrastructures such as command and control (C&amp;C) hosts. Particularly, by linking to- gether 396 articles and more than 7,000 IOCs, our study reveals that a C&amp;C campaign continued to evolve over a four-year span, chang- ing the targets of exploits from one vulnerability (CVE-2010-1885) to another (CVE-2013-0422). Also interestingly, we observed that the attackers might adjust their strategies in response to the release of IOCs: e.g., we found that the IOCs receiving intensive reports tend to be short-lived, typically disappearing after a month.</span></h3><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">On the other hand, organizations do not seem to react quickly to the release of IOCs: it could take around 2 days for AV scanners to</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">include the hash of new malware and over 12 days for web scanners to update their domain and IP blacklists, after related information was made public by the blogs. Also, we found that a buffer over- flow vulnerability CVE-2012-0158 was first reported by AlienVault in April, 2012 for APT attacks on the military and aerospace indus- try and then showed up again in an article on TrendMicro, Septem- ber 2012, for an attack on political organizations; later the same vulnerability was found in malware distribution (2013) and Spear Phishing campaigns on the film industry (2014) and banks (2015), indicating that such a long-standing IOC was not adopted timely.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">In terms of the qualities of open-source intelligence, we found that <i>Hexacorn </i>and <i>Naked Security </i>often provide timely and com- prehensive information about new attacks. For example, articles from Naked Security first reported three malicious name servers m.sea.sy, mod.sea.sy and sea.sy under the control of the Syrian Electronic Army for DNS hijacking. Also, some IOCs apparently are more predictive than others. An example is the name server “132.248.49.112”, which was reported by 19 blogs for the multiple- theme Spear Phishing attack and remained unchanged for 140 days.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Contributions<span class="p">. The contributions of the paper are as follows:</span></h3><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 6pt;text-align: left;">Novel IOC discovery technique<span class="p">. We present iACE, the first fully- automated technique for generating OpenIOC compatible, semantic- rich intelligence, which addresses the emerging challenge in the effective analysis of massive open-source data for timely CTI gath- ering. Our approach leverages the unique features of IOCs and the way they are described in mainstream technical articles to come up with a specialized, scalable information extraction technique that achieves high accuracy and coverage. Our evaluation shows that iACE can effectively recover valuable attack indicators from popu- lar technical blogs and convert it into industry-standard, machine- readable threat intelligence, which cannot be done by any existing techniques, to the best of our knowledge.</span></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: left;">New findings<span class="p">. Running iACE on over 71,000 articles from 45 most popular technical blogs across 13 years, our study sheds new light on the effectiveness of such open-source intelligence exchange, and the impact that it may have on the security industry and the adversary’s strategies. The new understandings are invaluable for improving the IOC release, discovery and utilization process, con- tributing to the better protection of organizations’ information as- sets.</span></p></li><li data-list-text="2."><h2 style="padding-top: 9pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">BACKGROUND</h2><ol id="l4"><li data-list-text="2.1"><h2 style="padding-top: 1pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Cyber Threat Intelligence</h2><h3 style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">CTI gathering<span class="p">. As mentioned earlier, CTI is a collection of infor- mation that details the current and emerging security threats, which enables an organization to determine its responses at the strategic, operational and tactical levels [42]. At the center of CTI are IOCs, which elaborate the forensic artifacts of an attack and can therefore be used to analyze the attack once it happens or counter it during its execution. An IOC includes not only individual data fingerprints involved in a specific attack, such as an attack domain, the MD5 of the malware delivered, but also the context of the attack and an analysis of the adversary’s behavior, like the type of the attack or the specific technique deployed (e.g., change to the Windows Reg- istry). To find out such information, CTI gathering includes identi- fication of the adversary’s tools, techniques and attack procedures, which, together with the fingerprints, helps an organization’s secu- rity team to understand their security posture, detect early signs of threats and continuously improve their security controls.</span></h3><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">The sources of CTI can be closed, e.g., a corporation’s internal network traces, or public, such as technical blogs or online forums. Examples of public sources include the blogs of AlienVault, Fire-</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Table 1: Examples of iocterms and their corresponding general type and context terms.</h3><table style="border-collapse:collapse;margin-left:5.798pt" cellspacing="0"><tr style="height:17pt"><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">General</p><p class="s26" style="text-indent: 0pt;line-height: 8pt;text-align: center;">type</p></td><td style="width:134pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">iocterms</p></td><td style="width:67pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="padding-top: 3pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">context terms</p></td></tr><tr style="height:49pt"><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">IP</p><p class="s27" style="padding-left: 6pt;padding-right: 6pt;text-indent: 0pt;line-height: 16pt;text-align: center;">Hash Datetime</p></td><td style="width:134pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">Email/ReceivedFromIP, PortItem/remoteIP</p><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">ServiceItem/serviceDLLsha1sum, FileItem/Md5sum</p><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">Email/Date, EventLogItem/genTime</p></td><td style="width:67pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 6pt;text-indent: 0pt;text-align: center;">email, IP, received, remote, port service, dll, sha1, md5</p><p class="s27" style="padding-left: 7pt;padding-right: 6pt;text-indent: 0pt;line-height: 8pt;text-align: center;">email, date, event, log, generation</p></td></tr></table><p style="padding-top: 9pt;text-indent: 0pt;text-align: right;">Eye, Malwarebytes and Webroot. With the surge of cyber attacks in recent years, a large number of attack artifacts have emerged, which has been extensively reported by the public online sources and ag- gressively collected by different organizations. To bootstrap this research, we reached out to a security company and obtained a list of 45 blogs which were operated by renowned organizations and practitioners. These blogs altogether covered major security inci- dents in the world and were consistently publishing verified IOCs. We monitored these 45 blogs and were able to download as many as 71,000 articles. Also noteworthy is that the number of IOC-</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">related articles there continued to grow in the past 13 years (2003/01 to 2016/04), from 20 to 1,000 per month, with an increased rate of 500% (see Figure 5a). While the volume of articles we have col- lected is substantial, it only constitutes a small piece of the IOC landscape. Rapidly collecting and sharing such information, and deploying it to various security systems is the key to quickly detect- ing, responding and containing different kinds of security threats organizations face, which requires the descriptions of IOCs to be standardized and machine digestible. To this end, multiple IOC frameworks have been proposed, including OpenIOC [9], STIX [8] and yara [12], with each format easily convertible to the others. In our research, we utilized OpenIOC for automatic extraction of CTIs from technical articles.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>OpenIOC framework</b>. OpenIOC is an extensible XML schema created by Mandiant to record technical characteristics that iden- tify a known threat, an attacker’s methodology, or other evidence of a compromise. As an example, Figure 1 shows how to use the OpenIOC format to describe a family of POS malware, <i>Alina </i>[30]. Such a description includes two components, a header and a def- inition. The header part has a summary of the attack (under the description tag) and the source of the information (under au thored_by and authored_date). The definition contains a set of indicator items (under Indicator Item), each represent- ing an IOC (Content) and its context (Context). Two such items are illustrated in Figure 1. In each of them, the document attribute under Context gives the main category of an IOC (e.g., process, event, file, registry, etc.) and search elaborates on its subcategory using an <i>iocterm</i>, essentially a concatenation of com- mon terminologies (e.g., process, name, etc.) security profession- als use to describe the IOC. The OpenIOC standard provides 600 such iocterms, covering various types of artifacts left by differ- ent attacks, such as cookie history, DNS entry, Email informa- tion, Hook items and others.  The examples of iocterms related to IP, hash and datetime are shown in Table 1. For example, In the case of IP, its iocterms describe 15 different contexts, such as spammer’s IP (Email/ReceivedFromIP), IP in malicious infras- tructure (RouteEntryItem/Destination), or C&amp;C attack’s remote IP (ProcessItem/PortList/PortItem/remoteIP).</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">In Figure 1, the two indicator items record the registry change made by the Alina malware: the first shows the location where the change happens, i.e., the path Windows\CurrentVersion\Run with the context RegistryItem/KeyPath, and the second identifies the name of the code dropped there, i.e., ALINA.</p></li><li data-list-text="2.2"><h2 style="padding-top: 4pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Information Extraction</h2><p class="s28" style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Blog Scraper (BS)</p><p class="s28" style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Relevant Content Picker (RCP) Relation Checker (RC)</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 11pt;text-align: justify;">To collect IOCs automatically, we leveraged a set of NLP tools. Also, due to the unique characteristics of this open problem, the generic information extraction techniques cannot achieve good per-</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 3pt;text-align: left;">Blog Archive Crawler</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Update Monitor</p><p class="s20" style="padding-top: 2pt;padding-left: 8pt;text-indent: -2pt;text-align: left;">Sentence Splitter</p><p class="s20" style="padding-top: 3pt;padding-left: 12pt;text-indent: -9pt;text-align: left;"><span class="s29"> &nbsp;&nbsp; </span> QC/Context Terms Locator</p><p class="s30" style="padding-top: 2pt;padding-left: 37pt;text-indent: 0pt;line-height: 115%;text-align: left;">candidate sentences</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: center;">Dependency Parser</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;line-height: 5pt;text-align: center;">Graph Kernel</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">formance for our tasks, and therefore we also applied <i>graph mining </i>techniques to analyze relations between context terms and IOC an- chors. These techniques are briefly introduced here.</p><h3 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Dependency parsing<span class="p">. Dependency parsing is an NLP technique for describing grammatical relations between words in a sentence.</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 5pt;text-indent: 0pt;line-height: 115%;text-align: center;"> echnical blog articles</p><p class="s20" style="padding-left: 9pt;text-indent: 0pt;line-height: 4pt;text-align: center;">Special Content</p><p class="s20" style="padding-left: 9pt;text-indent: 0pt;text-align: center;"> xtractor/QCR</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 5pt;text-indent: 0pt;line-height: 115%;text-align: left;">IOC-relevant articles</p><p class="s20" style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;text-align: center;">Topic Classifier</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">KLR Classifier</p><p class="s30" style="padding-top: 2pt;padding-left: 21pt;text-indent: 1pt;line-height: 115%;text-align: left;">raw IOCs &amp; context terms</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Definition Generator</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s30" style="text-indent: 0pt;line-height: 3pt;text-align: left;">formatted</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Such relations include direct object, determinant, noun compound modifier and others. Also, the content of a relative clause is fur-</p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Template</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Removing</p><p class="s20" style="padding-left: 7pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Content</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Sanitizing</p><p class="s20" style="padding-left: 5pt;text-indent: 3pt;text-align: left;">Header Generator</p><p class="s30" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;"><u> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IOC</u> files</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">ther analyzed to identify the dependencies between the words it in-</p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Blog Preprocessor (BP)</p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">IOC Generator (IG)</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">cludes. For example, the sentence in Figure 2 is parsed into depen- dency relations, such as the determinant relation between “trojan” and “the”, det(Trojan-2, the-1) (where the number shows the position of the word in the sentence), and the nominal-subject relation between “trojan” and “download”, nsubj(downloads-3, Trojan-2). Each of the formulae represents a binary relation be- tween a <i>governor </i>(the first term) and a <i>dependent </i>(the second one).</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Such dependency relations within a sentence form a directed and weighted graph (<i>V, E, W </i>), where each token is a vertex in <i>V </i>, and the relation between them is represented by a set of edges in <i>E</i>. Each arc connecting two tokens can also be assigned a <i>weight W </i>to differentiate the relation between them from others. Figure 2 further illustrates the dependency graph for the example sentence. The state-of-the-art dependency parser (e.g., Stanford’s typed de- pendencies system [20]) can achieve a 92.2% unlabeled attachment score (UAS) in discovering the grammatical relations in a sentence. In our research, we utilized the relations discovered by the parser to capture the semantic links between context terms and an IOC to- ken. For example, the dependency of clickme.zip on “attach- ments” in the sentence “all e-mails collected have had attachments clickme.zip” reveals a compound relation between the terms (the content of the “attachment” is clickme.zip), which falls in line with the descriptions typically explaining the security issues related to email attachments.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Content term extraction<span class="p">. Another set of techniques extensively utilized in information extraction is content term extraction, which automatically determines important terms within a given piece of text. It includes parts-of-speech (POS) tagging that labels a word corresponding to a particular part of speech (such as nouns and verbs), and phrase parsing that divides sentences into phrases logi- cally belonging together. Specifically, after parsing phrases from the given content, a POS tagger labels its terminological candi- dates, such as syntactically plausible terminological noun phrases. Then, these candidates are analyzed using statistical approaches (e.g., point-wise mutual information) to find out important terms.</span></h3><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">→</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">∈</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">{  |  ∈ }</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">{ · · · }</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">∈</p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Graph mining</b><span class="p">. Our approach tailors graph mining techniques to analyze the dependency graphs constructed from sentences of in- terest. Graph mining is a structural data mining problem with the purpose of identifying distinguishing characteristics (such as com- mon subgraph) of graphs. The problem can be stated as follows. </span><span class="s32">Given a dataset of graphs </span>G<span class="s34">i  </span>D<span class="s32">, with </span>i <span class="s32">= 1</span>...N <span class="s32">, each graph </span>G<span class="s34">i </span><span class="s32">= (</span>V<span class="s34">i</span>, E<span class="s34">i</span><span class="s32">) is a collection of vertices </span>V<span class="s34">i </span><span class="s32">= </span>v<span class="s34">i</span><span class="s35">1</span>,  , v<span class="s34">in </span><span class="s32">and </span><span class="p">edges </span><span class="s6">E</span><span class="s36">i</span><span class="s6"> </span><span class="p">= (</span><span class="s6">v</span><span class="s36">a</span><span class="s6">, v</span><span class="s36">b</span><span class="p">) </span><span class="s6">v</span><span class="s36">a</span><span class="s6">, v</span><span class="s36">b</span><span class="s6">  V</span><span class="s36">i</span><span class="s6"> </span><span class="p">. </span><span class="s6">G</span><span class="s36">i</span><span class="s6"> </span><span class="p">may also have labels on its nodes and edges, which are drawn from a common label set of </span><span class="s32">the whole dataset </span>D<span class="s32">. Also, each graph </span>G<span class="s34">i </span><span class="s32">is in a </span>class <span class="s32">with a label </span>c<span class="s34">i  </span>C<span class="s32">. The goal of the </span>graph classification <span class="s32">problem is to learn a </span><span class="p">model </span><span class="s6">f </span><span class="p">: </span><span class="s6">D  C </span><span class="p">that predicts the class label for any graph, that is, classifying the graph to a class based on its similarity to other graphs as measured by various </span><span class="s6">graph kernel </span><span class="p">methods, such as di-</span></p><h3 style="padding-top: 3pt;padding-left: 57pt;text-indent: 0pt;text-align: justify;">Figure 3: The architecture of iACE.</h3><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">rect product kernel [27] and subtree kernel [39]. In our research, we utilize graph mining to determine whether a sentence involving context terms and an IOC token indeed contains IOC.</p></li></ol></li><li data-list-text="3."><h2 style="padding-top: 10pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">IACE: DESIGN AND IMPLEMENTATION</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">Although the generic problem of information extraction from natural language text is hard, particularly when high accuracy and coverage are required (see Section 7), articles documenting IOCs tend to utilize common technical terminologies (e.g., IP, process, etc.) and present the artifacts and their context in a predictable way (e.g., utilizing compound dependency, see the example in Fig- ure 2), thereby making identification of IOCs more manageable. These unique features were fully leveraged in the design of iACE, which utilizes high-confidence context terms from iocterms and a set of regexes to locate the sentences likely containing IOCs. Then iACE analyzed the relations just between those anchors (the con- text terms and the putative IOC token) against a model learned off- line to accurately and efficiently capture IOCs. Below we present the high-level design of this technique and explicate how it works through an example.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Architecture<span class="p">. Figure 3 illustrates the architecture of iACE, in- cluding a blog scraper (BS), a blog preprocessor (BP), a relevant- content picker (RCP), a relation checker (RC) and an IOC generator (IG). The BS first automatically collects (“scrapes”) technical arti- cles from different technical blogs, removing irrelevant information (e.g., advertisements) from individual blog pages. These articles are then inspected by the BP, using NLP techniques to filter out those unlikely to contain IOCs. For each article considered to be IOC-relevant, the RCP converts all its content, including pictures, to text when possible, breaks the content into sentences and other special content elements (tables and lists) and then searches among the sentences for those likely involving IOCs with a set of context terms and regexes, which describe the formats of IOCs such as IP addresses (Section 3.1). The context terms here are automatically extracted from iocterms and can also come from other manually labeled sources, and the regex is built specifically for each IOC type and its consistency with the content terms is first checked be- fore the sentence is selected. For each sentence, the RC analyzes its grammatical structure connecting the context anchors (context terms) and the IOC anchor (the string matched by the regex), using a learned model to determine whether the latter is indeed an IOC, and if so, mark the IOC and the context terms (Section 3.2). Using such labeled content, the IG automatically creates the header and the definition components, including the indicator items for all the IOCs identified, according to the OpenIOC standard.</span></h3><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">An example<span class="p">. Here, we use the excerpts of an article posted on Trustwave (Figure 1) to go through the whole IOC extraction proce- dure. From the title and other keywords identified from the article,</span></h3><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">using content term extraction (an NLP technique), iACE detects that the article is likely to contain IOCs for a malware infection, and then marks the link content and summarizes the article using <i>TextRank </i>[32] to construct the header component. After that, it converts the figures in the article into text using <i>Tesseract </i>[6], and searches for the context terms and IOC token on each sentence.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: left;">Among all the sentences captured, the following one is found to include a string fitting the description of a key path of registry, along with the context terms “registry” and “path”: “It includes the addition of the registry value on the path HKCU\Software\Microsoft\ Windows\CurrentVersion\Run that virus use to maintain persistence.” This sentence is then analyzed against the IOC recognition model built through relation analysis, which confirms that the connec- tion across the terms and the IOC anchor here (“HKCU\Software\ Microsoft\Windows\CurrentVersion\Run” ) is indeed commonly used to describe the key path of an injected registry item. As a result, these terms and the IOC are labeled. From such content, the tech- nical details of the attack reported by the article are automatically extracted and presented in the OpenIOC format (Figure 1).</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Assumptions</b>. The current design of our system is for analyzing technical blogs, under the assumptions that the blog writers present their findings in a professional fashion. Such assumption is rea- sonable intuitively, as the blogs are written by security profession- als and their purpose is to quickly share technical details to their peers<span class="s11">1</span>. It was also confirmed by our analysis of the labeled dataset DS-Labeled (see Section 4.1 for description). All their descrip- tions of IOCs were found to be in line with our assumptions (Sec- tion 3.1), involving professional terms and predictable grammatical structures. On the other hand, the effectiveness of the technique on other types of IOC open sources like online forums needs to be further studied (Section 6).</p><ol id="l5"><li data-list-text="3.1"><h2 style="padding-top: 7pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Relevant Content Identification</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">As mentioned earlier, to automatically extract IOCs from tech- nical blogs, we first need to scrape related web pages from blog sites, pre-process their content and remove noise, before filtering out those irrelevant and identifying from the remaining articles the sentences that may carry IOCs for the follow-up relationship check and IOC extraction. Here we elaborate on these individual steps.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Blog scraping and pre-processing<span class="p">. Our blog scraper is essentially a crawler designed to continuously monitor a list of technical blogs to collect their articles. For each blog site, the BS first scraps all its existing articles before it is set to monitoring mode to look for new ones. Specifically, the scraper performs breadth-first crawling on the blog, starting from its homepage to explore each link it discov- ers, until no new link can be found. A problem here is that the web pages gathered in this way may not all be articles, and may also contain login pages, contact pages, and others. To automatically remove these unrelated pages, we leverage two unique observa- tions: the articles posted on the blog are all framed within the same HTML template, which is very different from those used by other pages such as login, contact, and others; also, on any blog site, more article pages are hosted than other types of pages. Based on the ob- servations, the BS compares each page’s DOM tree with those of others to find out a small set of pages framed over the templates unlike the ones used by the majority of the pages. These pages are considered to be outliers and dropped from the dataset scraped</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">1<span class="s38">Note that asking those professionals to directly post formalized IOCs may not be realistic in the near future, due to the complexity of manually creating the content and their intent to get humans involved in the discussion. As a supporting evidence, we examined all 45 blog sites and found only one of them export IOCs in some articles (AlienVault).</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">from the blog site. In our implementation, the BS uses the python library beautifulsoup [2] to extract from each page its HTML template (with tags and attributes but no content) and groups the pages using their templates’ hash values to identify those unrelated to articles (the ones outside the group).</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Even on those indeed relevant web pages, there still is content unrelated to the technical articles, such as blog contributors’ pic- tures, advertisements, featured content, etc. Such content needs to be removed before the pages can be used for IOC identifica- tion. This purpose is served by another pre-processing step the BS takes to get rid of such non-UGC (<i>user-generated-content</i>) data from each page. Specifically, our approach compares all pages’ DOM trees to find out the nodes with the non-UGC, character- ized by their largely unchanged content across these pages (e.g., blog contributors’ photos will be the same across different arti- cles). This is different from the article content generated by the user, which varies significantly between pages. Such a difference is captured by an information-theoretic metric called <i>composite im- portance </i>(CI) [47] that is used by the BS to measure the uniqueness of each node on each page’s DOM tree with regards to other pages: the nodes found to be less unique (rather common across different pages) are discovered and dropped from the DOM tree, using an algorithm proposed in the prior research [47].</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Under such a “sanitized” DOM tree, still some content cannot be directly analyzed by our text-based approach, including images and embedded PDF files. So, the last pre-processing step is to con- vert such content into text, if it indeed involves text information. To this end, we incorporated into our implementation of an optical character recognition engine <i>Tesseract</i>. Tesseract [6] is capable of discovering texts within an image with an accuracy of 99% in gen- eral. However, for the images collected from blogs, we found that the accuracy went down to merely 70%, due to the low quality of the images and the non-dictionary words they often have. To ad- dress this issue, we used <i>Gimp </i>[4] to resize the blog image a for better image quality, and add to Tesseract the new words (e.g., IP, MD5, HTTP) discovered from the text of an article. We tested this approach on 100 randomly sampled images from 10 blogs, which was found to push the accuracy of Tesseract to above 95%.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Topic filtering</b>. Once all the article pages have been selected and pre-processed, we start looking into their content, first removing those not including any IOCs. Examples of such articles are those for product promotion, news or software update, which we call <i>non- IOC articles</i>. To separate the non-IOC articles from those with IOCs (called <i>IOC articles</i>), iACE runs the TC, a classifier using a set of features as described below:</p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;">Topic words<span class="p">: Intuitively, an IOC article focuses on security risks and vulnerabilities, whose theme is reflected by its </span>topic terms <span class="p">(e.g., malware, exploit). These terms are less likely to appear in a non- IOC article. </span>Topic term extraction <span class="p">is an extensively studied NLP technique. In our implementation, we utilized an open-source tool topia.termextract [10] to collect the terms within each ar- ticle. The top 20 terms discovered, together with their frequencies, are part of the features for the classification.</span></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;">Article length<span class="p">: Since the blog sites are meant to be the channels for IOC exchanges, the IOC article it contains tends to be longer, including detailed descriptions of IOCs and their context, while non-IOC articles in technical blogs are often news and digests, and hence tend to be shorter.</span></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;">Dictionary-word density<span class="p">: Compared with non-IOC articles, IOC articles tend to have a lower dictionary-word density, because most IOCs are non-dictionary words (e.g., IP, hash values, file path). Our implementation employs the enchant library [15] to find dictio-</span></p><h3 style="padding-top: 4pt;padding-left: 68pt;text-indent: 0pt;text-align: left;">Table 2: Examples of regexes.</h3><table style="border-collapse:collapse;margin-left:9.158pt" cellspacing="0"><tr style="height:9pt"><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">General type</p></td><td style="width:181pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Regex</p></td></tr><tr style="height:16pt"><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">IPv4</p></td><td style="width:181pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)\{3\}(?:25[0-5]</p><p class="s27" style="padding-left: 9pt;text-indent: 0pt;line-height: 7pt;text-align: left;">|2[0-4][0-9]|[01]?[0-9][0-9]?)(/([0-2][0-9]|3[0-2]|[0-9]))?</p></td></tr><tr style="height:9pt"><td style="width:50pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">hash</p></td><td style="width:181pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">\b[a-fA-F\d]{32}\b|\b[a-fA-F\d]{40}\b|\b[a-fA-F\d]{64}\b</p></td></tr><tr style="height:8pt"><td style="width:50pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">int number</p></td><td style="width:181pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">((?&lt;=[\s([\s\(\[\{:\+\-=\\])|^)(\+|-)?\d+(?!([a-zA-Z0-9]|\.\S))</p></td></tr><tr style="height:17pt"><td style="width:50pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">float number</p></td><td style="width:181pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">((?&lt;=[\s\(\[\{:</p><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">\+\-=\\])|^)(\+|-)?(\d+)?\.(\d+)(?!([a-zA-Z0-9]|\.\S))</p></td></tr></table><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">nary words in an article. Then, its density within the article is cal- culated as the ratio of the dictionary words with regards to all the words the article contains.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Using these features, we ran a support vector machine (SVM) to train a classification model over DS-Labeled, including 150 IOC articles and 300 non-IOC articles. The model was evaluated through a 10-fold cross validation, and found to achieve a precision of 98% and a recall of approximate 100%. We further used this TC to analyze all 71,000 articles from the unknown set DS-Unknown (described in Section 4.1) and manually validated 500 instances randomly selected from the classified results (Section 4.2). The validation shows that the classifier had a high accuracy (96%) and coverage (99%).</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>IOC sentence identification</b>. From each IOC article, the relevant content picker identifies the sentences, tables, and lists likely to in- clude IOCs before they are further evaluated by the relation checker (Section 3.2). Such content is selected from the article based on the <i>anchors </i>they contain, i.e., context terms and putative IOC to- kens. Specifically, the RCP parses the HTML content of each arti- cle, breaking the text into sentences and detecting tables and lists. From each sentence, we look for the presence of both the string matched by the regex and its compatible context terms: e.g., “hash” goes with an MD5 checksum. From tables and lists, we increase the search scope for context terms also to table headers, captions and the nearest sentences (see supplementary material). Figure 2 shows an example.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">The OpenIOC standard specifies 600 categories of IOCs using a list of iocterms [9]. We further summarized these IOCs into 19 dif- ferent data types, including IP, hash, int, float, and others. The regex for each of these categories was manually constructed and carefully examined. As we can see here, such expressions could introduce false positives (e.g., the string type matching many IOC strings, even though oftentimes, we only seek non-dictionary words), if we do not also look at the context terms and the rela- tions between identified tokens. These terms are automatically col- lected from the 600 iocterms through tokenizing dictionary-word elements within each iocterm and by removing common terms like “item” . We further used <i>Semanticlink </i>[14] to recover other seman- tic related terms, e.g., “portable executable” (related to PE).</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Altogether, we gathered 5,283 context terms in our research, which were found to indeed provide good coverage of the com- mon terminologies used by technical blogs. In our research, we gathered 80 public IOC files and their corresponding blog articles</p><p style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">the third one does. Fundamentally, the coincidence of relevant to- kens (context term and IOC token) does not necessarily indicate the presence of an IOC-related description. Most important here is the consistency between the <i>relation </i>of these tokens and what is expected from the narrative of IOCs: in the above example, 3344 is supposed to be the <i>offset</i>, not the <i>PE </i>file. Actually, in the case that such a relation is incorrect, even when the IOC extracted is in- deed an attack indicator, its context can be wrong and as a result, the OpenIOC record created can be erroneous. The third sentence in the figure is such an example.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">As mentioned earlier, identifying IOCs is essentially an NER problem and connecting them to their context is an RE issue. In the NLP community, solutions to the problems are pipelined: individ- ual name entities within a sentence are first recognized (i.e., NER) and then their relation is established (i.e., RE). For our problem, however, this pipeline becomes unnecessary, since the putative to- kens for an IOC and its context are already located in a sentence, and all we need to do is check the consistency of their relation with what is expected to happen between them. In other words, we are in the position to address both the NER and RE together. On the other hand, existing RE techniques are inapplicable here, because they are designed to work on the nominal relation between two nouns, whereas the links between an IOC and its context terms are more diverse, including nominal, verb and adjective (e.g., “attachment”, “download” and “injected”). To handle such diverse relations, we came up with an idea that models the analysis on the grammatical connection between the IOC candidate and its context as a <i>graph mining </i>problem [23]. This allows us to apply graph similarity comparisons to detect the presence of the desired relation, which achieves both a high accuracy (95%) and a high coverage (above 90%) that the more generic RE techniques cannot attain [24]. Be- low we present how the approach works.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Relation representation</b>. To analyze the relation between an IOC candidate and a context term, our approach first uses a <i>dependency parser </i>to transform a sentence into a dependency graph (DG). A DG describes the grammatical connections between different lin- guistic tokens, with verbs being the structural center of a clause and other tokens directly or indirectly depending on the center. Such a dependency describes the grammatical connection among tokens such as direct object, determinant, noun compound modifier, etc. Formally, a DG is a directed and weighted graph <i>g </i>= (<i>V, E, W </i>), where words in the sentence are nodes <i>V </i>, two related nodes are connected by an edge <i>E </i>and the specific grammatical relation link- ing them together is modeled as an edge weight <i>W </i>. In our research, the DG was constructed using the Stanford dependency parser [20], the state-of-the-art open-source tool that converts text to simplified grammatical patterns suitable for relations extraction.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Unlike the more generic RE techniques, which work on the DG of the whole sentence, our approach takes advantage of the known</p><p class="s32" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: justify;">anchors to focus on the smallest dependency graph <i>g</i><span class="s34">n ,n </span>connect-</p><p class="s39" style="text-indent: 0pt;line-height: 0pt;text-align: right;">i c</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">(according to their description tags) from labeled dataset. By man- ually inspecting the sentences carrying the IOCs, we found that all such sentences also contain at least one context term and all such terms are on the list we created.</p></li><li data-list-text="3.2"><h2 style="padding-top: 7pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Relation Checking and IOC Creation</h2></li></ol></li></ol><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">Although context terms and regexes can find us the sentences likely involving IOCs, they are <i>insufficient </i>for detecting true IOCs with high accuracy. For example, Figure 2 shows four sentence pairs collected from two articles posted on AlienVault. As we can see, each pair contains both context terms, like “download”, and the strings fitting the descriptions of their corresponding IOCs, such as “3344”; however, the fifth one does not include any real IOC while</p><p class="s32" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">ing an IOC candidate <i>n</i><span class="s34">i </span>and a context term <i>n</i><span class="s34">c </span>together. This is <span class="p">because the information carried by this subgraph (called </span><i>core</i><span class="p">) is most relevant to the understanding of the relations between the an- chors, which is all we care about (see an example in Figure 4). Note that we also add negation dependencies as child nodes or sib- ling nodes of the nodes on the core to capture IOC-related negative descriptions. As an example, in the fourth sentence in Figure 2, the relation between the context term “modify” and the IOC token “AndroidManifest.xml” is affected by the word “not”, which adds a negation dependency on the verb “modify”.</span></p><p class="s34" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 86%;text-align: justify;"><span class="s40">Similarity comparison</span><span class="s32">. Over a dependency subgraph </span><span class="s33">g</span>n<span class="s41">i</span>,n<span class="s41">c </span><span class="s32">mod- </span><span class="p">eling the relation between a context term and an IOC candidate, we</span></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 80pt;text-indent: 0pt;text-align: left;">The Trojan <span style=" color: #0070C0;">downloads </span>a file <span style=" color: #F00;">ok.zip </span>from the server.</p><p class="s42" style="padding-top: 4pt;padding-left: 60pt;text-indent: 0pt;text-align: center;">Direct Product Kernel</p><p class="s8" style="text-indent: 0pt;line-height: 4pt;text-align: left;">X</p><p style="text-indent: 0pt;text-align: left;"/><p class="s45" style="padding-top: 4pt;padding-left: 58pt;text-indent: 0pt;text-align: center;">k<span class="s8">(</span>g<span class="s46">1</span>,g<span class="s46">2</span><span class="s8">) =  [(</span>I<span class="s47">  </span>A<span class="s8">)</span><span class="s48"> </span><span class="s49">1</span><span class="s8">]</span></p><p class="s50" style="padding-top: 1pt;padding-left: 55pt;text-indent: 0pt;text-align: center;">i,j</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s50" style="text-indent: 0pt;text-align: left;">i,j</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 11pt;text-indent: 4pt;text-align: left;">3. Generate Kernel Matrices</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l6"><li data-list-text="4."><p class="s42" style="padding-left: 29pt;text-indent: -5pt;text-align: left;">Predicting</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l7"><li data-list-text="•"><p class="s51" style="padding-left: 48pt;text-indent: -7pt;text-align: left;">IOC: ok.zip</p></li><li data-list-text="•"><p class="s52" style="padding-left: 48pt;text-indent: -7pt;line-height: 4pt;text-align: left;">Context term:</p><ol id="l8"><li data-list-text="1."><p class="s42" style="padding-left: 71pt;text-indent: -5pt;text-align: left;">Generate Dependency</p><p class="s42" style="padding-left: 72pt;text-indent: 0pt;text-align: left;">Graph</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2."><p class="s42" style="padding-left: 24pt;text-indent: -5pt;text-align: left;">Extract Shortest Path</p></li></ol></li></ul></li></ol><p class="s42" style="padding-top: 5pt;padding-left: 42pt;text-indent: -2pt;text-align: right;">Training Model</p><p class="s42" style="padding-top: 5pt;padding-left: 32pt;text-indent: 0pt;text-align: center;">Predictive Matrix</p><p class="s53" style="padding-top: 5pt;padding-left: 28pt;text-indent: 0pt;text-align: center;">! &quot;, $<span class="s54">%</span> ,! &quot;, $<span class="s54">%</span> , … , !(&quot;, $<span class="s54">%</span>)</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s42" style="text-indent: 0pt;text-align: right;">Positive</p><p class="s52" style="padding-top: 1pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">downloads</p><p class="s53" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">!($<span class="s54">%</span>,$<span class="s54">%</span>) !($<span class="s54">%</span>, $<span class="s54">)</span>) …</p><p class="s53" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">!($<span class="s54">)</span>, $<span class="s54">%</span>) !($<span class="s54">)</span>, $<span class="s54">)</span>) …</p><p class="s53" style="text-indent: 0pt;line-height: 5pt;text-align: right;">⋮   ⋮  ⋱</p><p class="s53" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: center;">!($<span class="s54">%</span>, $<span class="s54">,</span>)</p><p class="s53" style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;text-align: center;">!($<span class="s54">)</span>, $<span class="s54">,</span>)</p><p class="s53" style="padding-left: 4pt;text-indent: 0pt;line-height: 5pt;text-align: center;">⋮</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s55" style="padding-left: 54pt;text-indent: 8pt;line-height: 123%;text-align: left;">-./ 0123345467</p><p class="s42" style="padding-left: 15pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Negative</p><p class="s53" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">!($<span class="s54">,</span>, $<span class="s54">%</span>) !($<span class="s54">,</span>, $<span class="s54">%</span>) … !($<span class="s54">,</span>, $<span class="s54">,</span>)</p><h3 style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: center;">Figure 4: Workflow of the relation checker (RC).</h3><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">want to find out whether another subgraph is similar, which indi- cates that the same relation also exists between its anchors. This similarity comparison is important, since it is the foundation for classifying a sentence, determining whether IOC relations are in- deed there to bind anchors or they are not. Given the fact that now we only need to work on simple subgraphs with a few labeled nodes (see Figure 4), the focus is to compare the paths linking cor- responding nodes (with identical labels) across the subgraphs. For this purpose, we customize a well-known graph mining technique, called <i>direct product kernel</i>, a function that measures the similar- ity of two graphs by counting the number of all possible pairs of arbitrarily long random walks with identical label sequences [27].</p><p class="s33" style="padding-left: 5pt;text-indent: 8pt;text-align: justify;"><span class="s32">Specifically, let </span>g<span class="s35">1 </span><span class="s56">= (</span>V<span class="s35">1</span>, E<span class="s35">1</span>, W<span class="s35">1</span><span class="s56">) and </span>g<span class="s35">2 </span><span class="s56">= (</span>V<span class="s35">2</span>, E<span class="s35">2</span>, W<span class="s35">2</span><span class="s56">) be directed weighted graphs. The direct product between </span>g<span class="s35">1 </span><span class="s56">and </span>g<span class="s35">2 </span><span class="s56">is a directed weighted graph </span>G <span class="s32">= </span>g<span class="s35">1 </span><span class="s57">× </span>g<span class="s35">2 </span><span class="s56">= (</span>V, E, W <span class="s32">), where</span></p><p class="s33" style="padding-top: 2pt;padding-left: 75pt;text-indent: 0pt;text-align: left;">V <span class="s32">= </span><span class="s57">{</span><span class="s32">(</span>v<span class="s35">1</span>, v<span class="s35">2</span><span class="s56">) </span><span class="s57">∈ </span>V<span class="s35">1 </span><span class="s57">× </span>V<span class="s35">2</span><span class="s57">}</span></p><p class="s58" style="text-indent: 0pt;line-height: 9pt;text-align: left;"> </p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-left: 46pt;text-indent: -41pt;line-height: 16pt;text-align: left;">E <span class="s32">= </span><span class="s57">{</span><span class="s32">(</span>u<span class="s35">1</span>, u<span class="s35">2</span><span class="s56">)</span>, <span class="s32">(</span>v<span class="s35">1</span>, v<span class="s35">2</span><span class="s56">) </span><span class="s57">∈ </span>V <span class="s57">× </span>V <span class="s32">: (</span>u<span class="s35">1</span>, v<span class="s35">1</span><span class="s56">) </span><span class="s57">∈ </span>E<span class="s35">1</span>, <span class="s32">(</span>u<span class="s35">2</span>, v<span class="s35">2</span><span class="s56">) </span><span class="s57">∈ </span>E<span class="s35">2</span><span class="s57">} </span><span class="s59">W </span><span class="s60">=  </span><span class="s32">1</span>, <span class="s32">if </span>W<span class="s35">1</span><span class="s56">(</span>u<span class="s35">1</span>, v<span class="s35">1</span><span class="s56">) = </span>W<span class="s35">2</span><span class="s56">(</span>u<span class="s35">2</span>, v<span class="s35">2</span><span class="s56">)</span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 8pt;text-align: center;">0<i>, otherwise</i></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">| |</p><p style="text-indent: 0pt;text-align: left;"/><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">| |</p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-top: 2pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;"><span class="s32">In other words, for each pair of nodes (</span>u<span class="s35">1</span>, u<span class="s35">2</span><span class="s56">) and (</span>v<span class="s35">1</span>, v<span class="s35">2</span><span class="s56">) in </span><span class="s61">the new graph </span><span class="s6">G</span><span class="p">, they are adjacent (connected by a directed edge) if and only if an edge with the </span><span class="s6">same </span><span class="p">direction and weight exists </span><span class="s32">both between </span>u<span class="s35">1 </span><span class="s56">and </span>v<span class="s35">1 </span><span class="s56">in </span>g<span class="s35">1 </span><span class="s56">and between </span>u<span class="s35">2 </span><span class="s56">and </span>v<span class="s35">2 </span><span class="s56">in </span>g<span class="s35">2</span><span class="s56">. It </span><span class="s61">is important to note that we bring the weights into the product to compare the </span><span class="s6">type </span><span class="p">of the grammatical relation between two nodes (words): only when the adjacent word pairs in two sentences have the same grammatical relation, will that relation be preserved in the new graph. Usually, it takes </span><span class="s6">O</span><span class="p">( </span><span class="s6">V </span><span class="s11">4</span><span class="p">) to compute this direct product. However, all the subgraphs we consider are just “paths” (after removing the directions) between a context term and an IOC candidate, whose direct product can be computed in </span><span class="s6">O</span><span class="p">( </span><span class="s6">V </span><span class="s11">2</span><span class="p">).</span></p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Over the direct-product graph <i>G</i>, we calculate the similarity be- <span class="s32">tween the two subgraph </span><i>g</i><span class="s35">1 </span><span class="s56">and </span><i>g</i><span class="s35">2 </span><span class="s56">as follows:</span></p><p class="s62" style="text-indent: 0pt;line-height: 6pt;text-align: left;">∞</p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-top: 5pt;padding-bottom: 3pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">k<span class="s32">(</span>g<span class="s35">1</span>, g<span class="s35">2</span><span class="s56">) = </span><span class="s63">X</span><span class="s32">[</span><span class="s63">X </span>λ<span class="s64">l</span>A<span class="s64">l</span><span class="s32">]</span><span class="s65">i,j </span><span class="s32">= </span><span class="s63">X</span><span class="s32">[(</span>I <span class="s57">− </span>λA<span class="s32">)</span><span class="s66">−</span><span class="s67">1</span><span class="s56">]</span><span class="s65">i,j</span></p><p class="s65" style="text-indent: 0pt;line-height: 6pt;text-align: left;">i,j</p><p class="s65" style="text-indent: 0pt;line-height: 6pt;text-align: left;">l<span class="s35">=0</span></p><p class="s65" style="text-indent: 0pt;line-height: 6pt;text-align: left;">i,j</p><p style="padding-left: 78pt;text-indent: 0pt;line-height: 6pt;text-align: left;"><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -1pt;"> 	</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s32" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">and <i>t</i><span class="s34">j </span>is the subgraph for the <i>j</i>th instance in the training set. In other words, each new instance <i>g</i><span class="s34">i </span>is classified into the positive set <span class="p">(with the IOC relation) or the negative set (without the relation) based on its similarity with every instance in the labeled set. This classification is executed efficiently with multi-threading in our im- plementation.</span></p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">The classifier can be trained with different kinds of machine learning algorithms. Our implementation utilizes logistic regres- sion, since the algorithm works well on a small labeled dataset. More specifically, it optimizes the log likelihood function to deter- mine a probability that is a logistic function of a linear combination of the training dataset, and every training point has a certain influ- ence on the estimated logistic regression function. In our research, we compared the recall and precision of five classification models on the labeled dataset through a 5-fold cross-validation. With the regularization parameter set to 3.0, our logistic regression classifier yielded the best results. On unknown set DS-Unknown , this clas- sification model achieved a high accuracy (with a precision of 95% and recall of 90%).</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">IOC creation<span class="p">. After identifying the IOC and its corresponding context terms, our IOC generator can automatically convert the CTI content of a technical blog to the OpenIOC record. Specifi- cally, each indicator item in the record is created by filling in the search attribute in the Context tag with a context term and the Content tag with its corresponding IOC. The content of other fields on the item can be derived from these two fields. For exam- ple, the type attribute of the Content tag and the document attribute of the Context tag are actually the iocterms of the IOC discovered.</span></h3><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">For the header of the record, the IG generates the content for the Description tag using the open-source automatic summariza- tion tool TextRank to create a summary for the blog article. Also, the original blog link address is used to fill the link tag, and the content of authored_by and authored_date tag are set to our prototype name and the file generation time.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="text-indent: 0pt;text-align: left;">4. EVALUATION</h2><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">×</p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 6pt;text-align: left;">min<span class="s35">(</span>d ,d <span class="s35">)</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s65" style="text-indent: 0pt;line-height: 80%;text-align: left;">min<span class="s35">(</span>d<span class="s68">i</span>,d<span class="s68">o</span><span class="s35">)</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">where each entry of </span><span class="s6">A</span><span class="s69">l</span><span class="s6"> </span><span class="p">is the number of the walks of length </span><span class="s6">l </span><span class="p">from </span>v<span class="s34">i </span><span class="s32">to </span>v<span class="s34">j </span><span class="s32">in the direct product graph </span>G <span class="s32">= </span>g<span class="s35">1  </span>g<span class="s35">2</span><span class="s56">, hence </span>A<span class="s70">l</span> <span class="s32">can </span><span class="p">be calculated as the </span><span class="s6">l</span><span class="p">-th power of the adjacency matrix of </span><span class="s6">G</span><span class="p">; </span><span class="s6">λ </span><span class="s32">is the decay constant and </span>λ <span class="s57">≤ </span><u>&nbsp;&nbsp;&nbsp; </u><u>1</u><u> &nbsp;&nbsp; </u><span class="s32"> with </span>d<span class="s34">i</span>, d<span class="s34">o </span><span class="s32">being the </span><span class="p">maximum in-degree and out-degree of </span><span class="s6">G</span><span class="p">, representatively. In our research, we set </span><span class="s6">λ </span><span class="p">= </span><u>&nbsp;&nbsp;&nbsp; </u><u>1</u><u> &nbsp;&nbsp; </u><span class="p"> .</span></p><p class="s39" style="text-indent: 0pt;line-height: 3pt;text-align: center;">i o</p><p class="s33" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Classification</b><span class="p">. Based on our customized direct-product kernel, we run a classifier (the relation checker) to determine the presence of IOC relations between a context term and an IOC candidate within a sentence. The classifier is trained over DS-Labeled with 1500 positive instances and 3000 negative instances. From the dataset, a model is learned to work on a kernel vector generated from the fea- </span><span class="s32">tures of a subgraph </span>g<span class="s34">i</span><span class="s32">: (</span>m<span class="s35">1</span>, <span class="s57">· · · </span>, m<span class="s34">j</span>, <span class="s57">· · · </span><span class="s32">), where </span>m<span class="s34">j </span><span class="s32">= </span>k<span class="s32">(</span>g<span class="s34">i</span>, t<span class="s34">j </span><span class="s32">)</span></p><ol id="l9"><ol id="l10"><li data-list-text="4.1"><h2 style="padding-left: 32pt;text-indent: -26pt;text-align: left;">Settings</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">In our study, we ran our implementation of iACE to automati- cally analyze 71,000 real-world technical articles, on an R730xd server with 40 of Intel Xeon E5-2650 v3 2.3GHz, 25M Cache CPUs and 16 of 16GB memories. Here we explain the datasets used in the study and the parameter settings of the system.</p><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Datasets<span class="p">. We utilized two datasets in our study: a labeled set for training our topic classifier (Section 3.1) and relation checker (Sec- tion 3.2), and an unknown set for evaluating our technique.</span></h3><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;">Labeled dataset (DS-Labeled)<span class="p">. The dataset contains 80 IOC files and their corresponding blog articles. These IOC files were collected in our research from two public feeds, iocbucket [29] and openiocdb [1], both providing threat intelligence through OpenIOC</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">items. Under the description tags of these items, we found the links pointing to these items’ sources and recovered 150 arti- cles from 22 blogs, including their HTML pages and image files. Also, we manually gathered, from the same blogs, 300 other arti- cles. Each of them was manually checked to ensure that they do <i>not </i>have any IOCs but contain some IOC-like strings (e.g., IP ad- dresses, MD5, etc.). Most of them are technical news or articles for product promotion.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">From these articles, we further extracted two kinds of sentences, those with IOCs (<i>true IOC sentences</i>) and those without but involv- ing IOC-like strings (<i>false IOC sentences</i>). More specifically, the</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l11"><li data-list-text="(a)"><h4 style="padding-left: 17pt;text-indent: -11pt;line-height: 94%;text-align: left;">The number of the articles per month.</h4><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="(b)"><h4 style="padding-left: 18pt;text-indent: -12pt;text-align: left;">ROC curve of iACE.</h4></li></ol><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">1,500 true IOC sentences were identified using the context terms and IOC tokens specified in the OpenIOC items we collected, and further manually inspected to ensure their correctness. The 3,000 false IOC sentences were those matched by the regular expressions and context terms used by iACE (Section 3.1) but did not include any IOCs, as confirmed by a manual check.</p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 6pt;text-align: left;">Unknown set (DS-Unknown)<span class="p">. As mentioned earlier, the dataset used for evaluating our system was gathered from 45 security-related technical blogs. These blogs are well recognized to be the leading sources for CTI collection, which includes AlienVault, Malware- bytes, and others (see supplementary material for the full list). On these blogs, we ran a crawler that scraped 71K articles posted there between 2003/04 and 2016/05. Figure 5a shows the increase of the number of the articles per month on these blogs over 13 years.</span></p><h3 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Parameter settings<span class="p">. In the experiments, the parameters of our pro- totype system were set as follow:</span></h3><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-top: 1pt;padding-left: 5pt;text-indent: 7pt;text-align: justify;">Kernel decay constant (λ)<span class="p">. The decay constant is a parameter for calculating a direct product when the impact of a long random walk needs to be discounted (Section 3.2). It was set according to the convention of evaluating the kernel function: </span>λ <span class="p">= 0</span>.<span class="p">9 if</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 4pt;text-align: left;"><u> &nbsp;&nbsp; </u><u>1</u><u> &nbsp;&nbsp;&nbsp;&nbsp; </u> = 1 and <i>λ </i>= <u>&nbsp;&nbsp;&nbsp; </u><u>1</u><u> &nbsp;&nbsp;&nbsp;&nbsp; </u> otherwise.</p><h3 style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 5: The increase in the number of articles over 13 years and the effectiveness of iACE.</h3><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">tracted, we sampled the unknown set using two different methods: we first grouped the articles in the unknown set according to their publication time (4 consecutive months per group), and then their publishers (45 blogs), and in each case, we randomly picked up a few articles from each group. Altogether, in this validation step, we manually inspected 820 articles and in total, 25K reported sen- tences, and concluded that iACE achieved a precision of 95% (23K out of 25K reported IOCs were correct), and a recall of 90% (across the articles, 90% of IOCs were reported).</p><h3 style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Table 3: The number of samples and average accuracy and re- call in each method.</h3><table style="border-collapse:collapse;margin-left:13.403pt" cellspacing="0"><tr style="height:9pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 8pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Method</p></td><td style="width:46pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;"># of Groups</p></td><td style="width:70pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Samples per Group</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Precision</p></td><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">Recall</p></td></tr><tr style="height:17pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Time span</p><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">Blog</p></td><td style="width:46pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">39</p><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">45</p></td><td style="width:70pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">10</p><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">10</p></td><td style="width:38pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">93%</p><p class="s27" style="padding-left: 12pt;text-indent: 0pt;line-height: 8pt;text-align: left;">96%</p></td><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="padding-left: 8pt;text-indent: 0pt;line-height: 7pt;text-align: left;">92%</p><p class="s27" style="padding-left: 8pt;text-indent: 0pt;line-height: 8pt;text-align: left;">91%</p></td></tr></table><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">To compare our approach with state-of-the-art alternatives, we ran iACE against the top-of-the-line NER tool Stanford NER [26] and the commercial IOC identifier integrated within AlienVault</p><p class="s65" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 7pt;text-align: left;">min<span class="s35">(</span>d<span class="s68">i</span>,d<span class="s68">o</span><span class="s35">)</span></p><p class="s65" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 7pt;text-align: left;">min<span class="s35">(</span>d<span class="s68">i</span>,d<span class="s68">o</span><span class="s35">)</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">OTX [17]. Note that none of them (actually none of the existing</p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-left: 5pt;text-indent: 6pt;text-align: justify;">Inverse of regularization strength (C)<span class="p">. Regularization is a param- eter for reducing the over-fitting to the labeled data when we built the relation models using logistical regression. In our implemen- tation, we utilized a </span>C <span class="p">= 3</span>.<span class="p">0, which gave the best performance among other </span>C <span class="p">values from 0.3 to 15.</span></p><p class="s25" style="text-indent: 0pt;line-height: 9pt;text-align: left;">•</p><p style="text-indent: 0pt;text-align: left;"/><p class="s6" style="padding-left: 5pt;text-indent: 7pt;text-align: justify;">Threshold of sentence length (l)<span class="p">. The current dependency parser is limited by its capability to process long sentences. When a sen- tence grows longer, the accuracy of parsing goes down and its over- head goes up. In our implementation, we set the maximum length of the sentence to 200 words. Given IOCs may exist in sentence length larger than 200 words, we directly extract IOCs from sen- tences longer than 200 words without building dependency graphs. In our implementation, we directly extract the IOCs from sentences longer than 200 words if the sentence has two continuous IOC to- kens or has more than five IOC tokens which were split by short terms (less than 5 characters) (see supplementary material).</span></p></li><li data-list-text="4.2"><h2 style="padding-top: 4pt;padding-left: 32pt;text-indent: -26pt;line-height: 14pt;text-align: left;">Results</h2><h3 style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Accuracy and coverage<span class="p">. In our study, we first evaluated the topic classifier (i.e., TC) over the 450 IOC and non-IOC articles, and the relevant content picker and the relation checker (i.e., RCP/RC) over 1,500 true IOC sentences and 3,000 false IOC sentences in DS-Labeled, both using a five-fold cross-validation. Our proto- type achieved a precision of 98% and a recall of 100% in finding IOC articles, and a precision of 98% and a recall of 92% in identi- fying true IOCs and its context. Figure 5b illustrates the ROC curve of the RCP and RC.</span></h3><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Further, we ran our system over DS-Unknown across all 71K articles. Altogether, iACE automatically extracted IOC tokens and their context terms, and further converted them into OpenIOC items. To understand the accuracy and coverage of the information ex-</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">systems we are aware of) can also identify the context for an IOC and therefore generate machine-readable OpenIOC items. In our experiment, Stanford NER was trained on our labeled <i>true/false IOC sentences </i>as describe in Section 4.1 (the same set for training iACE). For AlienVault OTX, we utilized its API to submit articles to their web service and retrieve the IOC tokens identified. This study shows that our relation-based approach is indeed much more effective. Specifically, we ran all three systems on 500 randomly selected articles from 25 blogs in DS-Unknown and compared their findings: iACE extracted the IOC items across 427 OpenIOC categories, such as FileDownload HistoryItem/FileName, Email/ReceivedFromIP, with a precision of 98% and a re- call of 93%, while OTX could only find the IOCs in 8 categories (IP, hash value, domain, etc.) with a precision of 72% and a recall of 56%, a performance mirrored by Stanford NER. Both OTX and Stanford NER tend to introduce a lot of false positives: for exam- ple, OTX treated the reference links of articles as malicious URLs. Table 4 summarizes the result of this study.</p><h3 style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Table 4: Accuracy and coverage comparison of iACE, Alien- Vault OTX and self-trained Stanford NER.</h3><table style="border-collapse:collapse;margin-left:61.848pt" cellspacing="0"><tr style="height:9pt"><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Tool</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Precision</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Recall</p></td></tr><tr style="height:8pt"><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">iACE</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">98%</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">93%</p></td></tr><tr style="height:8pt"><td style="width:57pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">AlienVault OTX</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">72%</p></td><td style="width:29pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">56%</p></td></tr><tr style="height:9pt"><td style="width:57pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Stanford NER</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">71%</p></td><td style="width:29pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">47%</p></td></tr></table><h3 style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Performance<span class="p">. To understand the performance of iACE, we mea- sured the time it spent on each real-world article in the unknown set and the breakdowns of the overhead in each analysis stage, BP, RCP, RC, and IG. In the experiment, our prototype was running on our R730xd server, using 40 threads. On average, it took around</span></h3><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">0.25 second to inspect one article, as illustrated in Table 5. This</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">result provides strong evidence that iACE can easily scale to the level expected for processing a massive amount of CTI generated every day.</p><h3 style="padding-top: 8pt;padding-left: 46pt;text-indent: 0pt;text-align: left;">Table 5: Running time at different stages.</h3><table style="border-collapse:collapse;margin-left:36.067pt" cellspacing="0"><tr style="height:9pt"><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Stage</p></td><td style="width:85pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">average time (ms/article)</p></td><td style="width:67pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Std Deviation (ms)</p></td></tr><tr style="height:8pt"><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">BP</p></td><td style="width:85pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">5</p></td><td style="width:67pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td></tr><tr style="height:8pt"><td style="width:27pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">RCP</p></td><td style="width:85pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">20</p></td><td style="width:67pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">2.5</p></td></tr><tr style="height:8pt"><td style="width:27pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">RC</p></td><td style="width:85pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">252.5</p></td><td style="width:67pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">37.5</p></td></tr><tr style="height:9pt"><td style="width:27pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">IG</p></td><td style="width:85pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">2.5</p></td><td style="width:67pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">-</p></td></tr><tr style="height:8pt"><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">total</p></td><td style="width:85pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">278.6</p></td><td style="width:67pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l12"><li data-list-text="(a)"><h4 style="padding-left: 49pt;text-indent: -13pt;text-align: left;">Cumulative distributions for<span class="p">(b) </span>Cumulative distribution of the <span class="s75">the numbers of IOCs and iocterms</span>numbers of articles and reference</h4></li></ol></li></ol></ol><p style="padding-top: 1pt;padding-left: 14pt;text-indent: 0pt;line-height: 9pt;text-align: left;">In the meantime, considering the DG parser is largely affected by</p><h4 style="padding-left: 14pt;text-indent: 0pt;text-align: left;">per article.</h4><h4 style="padding-top: 2pt;padding-left: 14pt;text-indent: 0pt;line-height: 8pt;text-align: left;">per cluster.</h4><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">sentence length, we measure the performance of the RC model in different sentence lengths. Figure 6 illustrates the average running time on sentences of different lengths. We found that the running time of iACE gradually increases when sentence length increases. This is because iACE only extracts the shortest paths linking each pair of a context token and the IOC token, which mitigates the im- pact of sentence length .</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 6: Average running time on the sentences in different lengths.</h3><ol id="l13"><li data-list-text="5."><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">MEASUREMENT AND ANALYSIS</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">The IOCs automatically extracted from the 71,000 articles on 45 blogs present to us a comprehensive view of the cyber threats that the world has been facing in the past 13 years. By analyzing these IOCs, looking at their relations and evolution over a large time frame, across thousands of articles, our study brings to light new findings of attacks’ strategies and evolution, as well as new insights into the impact of open-source intelligence. Particularly, we found that hundreds of apparently independent attacks were ac- tually related, sharing unique IOCs such as IP address, register’s email and domain, etc. Among them, a set of command and control (C&amp;C) servers were reported by 396 articles (with little reference among them) and linked to over 7,000 unique IOCs over a four- year span, indicating that these separate attacks could all be part of a massive, previously unknown campaign. Further, through corre- lating different articles, we observe that the same vulnerability has been continuously utilized for a long period of time. Also, the IOCs intensively reported tend to be short-lived, demonstrating the possi- ble impacts of the CTI on the adversaries. On the defender side, the response to the IOCs seems less timely than one hopes, taking days to get IOCs into malware scanners, blacklists etc. Also, our study reveals the quality of the IOCs reported by different blogs and the ways these blogs react to emerging threats, which helps better un- derstand the effectiveness of such intelligence sources. Below we elaborate on the details of this study.</p><ol id="l14"><li data-list-text="5.1"><h2 style="padding-top: 2pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Landscape</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">Our study shows that these technical blogs are indeed a gold mine for threat intelligence gathering: altogether, 900K IOCs and their context were recovered from 71,000 articles (20K IOC arti- cles), including 20K exploit hash values, 55K registry key, 58K malicious IPs, 180K FQDNs etc. Table 6 presents the 10 IOC</p><h3 style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 7: Distribution of IOCs across different articles and clusters across different blogs.</h3><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">types (described by their corresponding iocterms) with the most instances found by iACE. We observe the largest amount of IOCs with the type PortItem/remoteIP, which was related to the popu- larity of drive-by-download, Phishing and other web attacks in the wild.</p><h3 style="padding-top: 8pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">Table 6: Top-10 iocterms with the largest number of IOCs.</h3><table style="border-collapse:collapse;margin-left:25.151pt" cellspacing="0"><tr style="height:17pt"><td style="width:120pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">iocterm</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;"># of</p><p class="s26" style="text-indent: 0pt;line-height: 8pt;text-align: center;">IOCs</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">general</p><p class="s26" style="text-indent: 0pt;line-height: 8pt;text-align: center;">type</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">PortItem/remoteIP</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">18,243</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">IP</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">RegistryItem/ValueName</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">12,572</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">string</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">UrlHistoryItem/HostName</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">12,020</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">URL</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">RegistryItem/Path</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">11, 777</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">string</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">FileDownloadHistoryItem/SourceURL</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">10,324</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">URL</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">ServiceItem/serviceDLLmd5sum</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">9,908</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">hash</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">PortItem/remotePort</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">9,831</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">int</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">FileDownloadHistoryItem/FileName</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">8,720</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">string</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Email/ReceivedFromIP</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">8,225</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">IP</p></td></tr><tr style="height:9pt"><td style="width:120pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">FileItem/FileExtension</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">8,100</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">string</p></td></tr></table><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">We looked into the distribution of IOCs across different arti- cles and blogs, as illustrated by the cumulative distributions for the numbers of IOCs and iocterms displayed in Figure 7a. On average, each article contains 52 IOCs and 70% of the articles have more than 10 IOCs. Particularly, the blog <i>hpHost </i>has 350 IOCs per arti- cle, the largest one among the blogs we inspected. Also, an article on <i>CyberCrime </i>talking about a Google redirection Spam reported 3,417 IOCs. When it comes to the diversity of IOC context, we found that on average, each article includes 6 different iocterms and 30% of articles have more than 10 different iocterms. Also interestingly, the blog with more IOCs does not necessarily come with more diverse IOC types: for example, even though <i>hpHost </i>has the largest number of IOC per article, each article only has 8 iocterms.</p></li><li data-list-text="5.2"><h2 style="padding-top: 3pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Understanding Threats</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">Through mining the IOCs across articles and blogs, we gained new insights into reported attacks and discovered connections never known before. Such connections shed new light on the way the adversaries organize their campaigns and adapt their techniques. Further linking the reported IOCs to auxiliary data sources reveals the impact of such CTI on the responses to emerging threats.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Correlation analysis<span class="p">. To understand the relations across differ- ent attack campaigns reported by articles, we studied the sharing of critical attack resources in these campaigns, through measuring their common infrastructure-related IOCs, including IP, register’s email and domain. Specifically, using these IOCs, we were able to group all the articles into 527 clusters (each group with more than three articles): two articles were put in the same cluster if they share at least one IOC IP, email or domain. Note that we removed IP addresses in the private address ranges (10.*.*.*, 172.16.*.*, 192.168.*.* ). To find out whether those in the same cluster ac-</span></h3><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">tually refer to a common source, so they essentially talk about the same attack instance, we also looked at the URLs in each of the articles to identify those pointing to the 45 blogs and other well- known intelligent sources. Figure 7b illustrates the distribution of the clusters with various percentages of the articles involving such references. It turns out that many clusters (including thousands of articles) have low reference percentages: in other words, the au- thors of these articles apparently did not realize that the attacks they were documenting were related to other instances.</p><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">We further picked out 5 clusters with at least 25 articles but at most 5% of them include references to others. None of such</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span class="p">(a) </span>Distributions of the duration<span class="p">(b) </span>Cumulative distributions for <span class="s75">after an IOC was released and be-</span>the numbers of first-reported blog</h4><p style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;">reference-carrying articles were found to mention the relations among</p><h4 style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">fore it was uploaded for a scan.</h4><h4 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">per cluster.</h4><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">the attack instances reported by other articles in the same clusters. Also, a sampling of these articles did not show any references to other blogs not on our list. This indicates that the infrastructure re- lations linking all these attacks together have never been reported before, which was confirmed by our additional search for related literature across the Internet. Table 7 provides the information about those clusters. Most interestingly, we found that for the IOC “132.248.49.112”, a shared IP reported by 19 blogs, turned out to point to a C&amp;C campaign’s name server. We believe that all the independently documented attacks actually belonged to a massive campaign whose scale was not known before. Note that this corre- lation effort is highly important because it informs us of the critical resources attackers share, which are likely to be their weakest link.</p><h3 style="padding-top: 5pt;padding-left: 79pt;text-indent: 0pt;text-align: justify;">Table 7: The 5 Clusters.</h3><table style="border-collapse:collapse;margin-left:5.798pt" cellspacing="0"><tr style="height:17pt"><td style="width:33pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">Cluster</p></td><td style="width:46pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;"># of articles</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 8pt;text-indent: 0pt;line-height: 6pt;text-align: left;"># of IOCs of</p><p class="s26" style="padding-left: 10pt;text-indent: 0pt;line-height: 8pt;text-align: left;">mal. infra.</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;"># of IOCs of total</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 6pt;text-align: center;"># of</p><p class="s26" style="text-indent: 0pt;line-height: 8pt;text-align: center;">references</p></td></tr><tr style="height:9pt"><td style="width:33pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1</p></td><td style="width:46pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">396</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">7,363</p></td><td style="width:62pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">10,533</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">21</p></td></tr><tr style="height:9pt"><td style="width:33pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">2</p></td><td style="width:46pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">178</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">4,271</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">8,110</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">3</p></td></tr><tr style="height:9pt"><td style="width:33pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">3</p></td><td style="width:46pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">30</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">215</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">960</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">0</p></td></tr><tr style="height:9pt"><td style="width:33pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">4</p></td><td style="width:46pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">28</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">897</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1,302</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">0</p></td></tr><tr style="height:9pt"><td style="width:33pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">5</p></td><td style="width:46pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">25</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">897</p></td><td style="width:62pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1,222</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">0</p></td></tr></table><h3 style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Evolution<a href="mailto:gkook@checkjemail.nl" class="s76" target="_blank">. Looking into the C&amp;C campaign reported by 396 arti- cles and related to 7,000+ unique IOCs, we were surprised to find that it lasted for a long time (2009-2013), and continued to adapt its attack strategies and techniques. Specifically, it distributed mal- ware by sending Spam emails to users, compromising legitimate websites, and others, and the vulnerabilities it exploited evolved from CVE-2010-1885 to CVE-2013-0422. In the meantime, the campaign utilized a small set of IPs for its C&amp;C servers, and some of them share the same register email </a><span class="p">“gkook@checkjemail.nl”. Apparently, taking down these servers could significantly affect the effectiveness of this long lasting, large-scale attack.</span></h3><p style="padding-left: 5pt;text-indent: 8pt;text-align: justify;">Another step we took to correlate the attacks reported by differ- ent articles was to cluster them according to the indicators of their attack vectors, including malware hash, vulnerability CVE and the content of the registries. The purpose is to understand the evolu- tion of the vectors with regard to the releases of related IOCs. To this end, we looked at the shortest period of time, in terms of the number of consecutive months, during which a specific IOC (e.g., 132.248.49.112) was continuously covered by new articles. This period, which we call “decay time”, demonstrates how long the at- tack instances related to the IOC continue to pop up before they can be stopped (at least temporarily). As illustrated in Table 8, in gen- eral, we found that the IOCs reported by a large number of articles tend to disappear quickly, indicating that either the related prob- lems were quickly fixed or the adversaries reacted to the reports to change their strategies. However, there are long-lasting IOCs even though they are well known: as a prominent example, a buffer overflow vulnerability CVE-2012-0158 kept showing up in blog ar- ticles for four months, and after a few recesses, continues to appear in other attacks over a four year period! Specifically, it was used in APT attacks on the military and aerospace industry (2012/04),</p><h3 style="padding-left: 32pt;text-indent: 0pt;text-align: center;">Figure 8: IOC impacts and timeliness of blog.</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">and then on political organizations (2012/09), generic malware dis- tribution (2013), and more recently Spear Phishing attacks on the film industry (2014) and banks (2015). This clearly shows that or- ganizations have not done their due diligence to adequately respond to the problem.</p><h3 style="padding-top: 5pt;padding-left: 32pt;text-indent: 0pt;text-align: center;">Table 8: Decay time of IOCs.</h3><table style="border-collapse:collapse;margin-left:25.457pt" cellspacing="0"><tr style="height:17pt"><td style="width:70pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">Decay time (month)</p></td><td style="width:68pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 7pt;text-align: center;">Avg. # of articles</p><p class="s26" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 8pt;text-align: center;">per month</p></td><td style="width:60pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">% of total IOCs.</p></td></tr><tr style="height:9pt"><td style="width:70pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">0-1</p></td><td style="width:68pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 7pt;text-align: center;">68</p></td><td style="width:60pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">92%</p></td></tr><tr style="height:9pt"><td style="width:70pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1-2</p></td><td style="width:68pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 7pt;text-align: center;">23</p></td><td style="width:60pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">5%</p></td></tr><tr style="height:9pt"><td style="width:70pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">2-3</p></td><td style="width:68pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 7pt;text-align: center;">8</p></td><td style="width:60pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1%</p></td></tr><tr style="height:9pt"><td style="width:70pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">3-4</p></td><td style="width:68pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 7pt;text-align: center;">6</p></td><td style="width:60pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1%</p></td></tr><tr style="height:9pt"><td style="width:70pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">&gt;4</p></td><td style="width:68pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;line-height: 8pt;text-align: center;">3</p></td><td style="width:60pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">1%</p></td></tr></table><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>IOC impacts</b>. Further, we studied the impact of such open-source intelligence on security protection: whether the security industry (e.g., anti-virus service providers) quickly responded to the reports of IOCs. To this end, we estimated the possible time intervals be- tween the first release of the IOCs and their adoption by anti-virus (AV) tools and web scanners. In our research, we submitted a set of IOCs, including IPs and domains of malicious sources, and the hashes of malware to <i>VirusTotal </i>[11], a platform that hosts 56 main- stream AV scanners and CleanMX [22], an IP/URL scanner. From VirusTotal, we collected the time stamps for the first time when the submitted IOCs were seen by at least one of the AV systems. For CleanMX, we fetched its IP/URL blacklist database archived from 2009/01 to 2015/04. We found that 47% of the IOCs were updated to these systems before they were reported by the blogs. For the rest of them, Figure 8a shows the distributions of the duration after such an IOC was released and before it was first used for a scan. We observed days of delay before the IOCs were put in place for protection, if indeed the uploading time (or the time when the IOCs were first used for a scan) was close to the moment when the IOCs (IP, domains, hashes) were added to the systems. Particularly, for IPs and domains, the whole process often took more than 12 days. On the other hand, the malware hashes were often quickly added, in most cases within 2 days.</p></li><li data-list-text="5.3"><h2 style="padding-top: 4pt;padding-left: 32pt;text-indent: -26pt;text-align: left;">Understanding Intelligence Sources</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">The availability of the longitudinal data (the IOCs collected over a span of 13 years) also enables us to investigate the qualities of the indicators produced by different sources and their timeliness against new threats, as reported below.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Timeliness</b>. Using the aforementioned attack clusters (see Table 7), we analyzed the distribution of the articles first reporting the at- tacks over different blogs, as shown in Figure 8b. We found that 10 blogs were responsible for the first report of 60% the clusters (each cluster likely to be a campaign). For example, the blog <i>Dancho Danchev </i>first report 12 clusters, each time involving 45 IOCs on average, which later also showed up on other blogs.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 8pt;text-indent: 0pt;text-align: justify;">Table 9: Quality of selected intelligence sources (10 out of 45)</h3><table style="border-collapse:collapse;margin-left:15.869pt" cellspacing="0"><tr style="height:25pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 7pt;text-indent: 0pt;text-align: center;">Blog</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">% of</p><p class="s26" style="padding-left: 11pt;text-indent: -3pt;text-align: left;">covered IOCs</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">% of</p><p class="s26" style="padding-left: 6pt;padding-right: 6pt;text-indent: 1pt;text-align: left;">covered iocterms</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">% of</p><p class="s26" style="padding-left: 11pt;padding-right: 9pt;text-indent: -1pt;text-align: left;">timely IOCs</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s26" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">% of</p><p class="s26" style="padding-left: 11pt;text-indent: -1pt;text-align: left;">robust IOCs</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Dancho Danchev</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">42%</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">62%</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">14%</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">84%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Naked Security</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">43%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">55%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">54%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">45%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">THN</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">38%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">38%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">41%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">51%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Webroot</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">54%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">79%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">13%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">84%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">ThreatPost</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">26%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">37%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">52%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">29%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">TaoSecurity</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">57%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">61%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">31%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">68%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Sucuri</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">34%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">35%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">43%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">52%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">PaloAlto</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">39%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">44%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">15%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 7pt;text-align: center;">87%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Malwarebytes</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">32%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">48%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">26%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 7pt;text-align: center;">72%</p></td></tr><tr style="height:9pt"><td style="width:59pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">Hexacorn</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">49%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">57%</p></td><td style="width:40pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="text-indent: 0pt;line-height: 8pt;text-align: center;">59%</p></td><td style="width:39pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s27" style="text-indent: 0pt;line-height: 8pt;text-align: center;">76%</p></td></tr></table><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 8pt;text-align: left;">Table 9 shows the average percentage of IOCs first reported among all the IOCs finally discovered from a cluster (i.e., the number of first-reported IOCs and those only reported once vs. the total num- ber of IOCs in a cluster). We found that most IOCs reported first by <i>Hexacorn </i>and <i>Naked Security </i>were also mentioned by other blogs later. Also, they provide a large amount of IOCs not documented by other blogs. We observed that even though <i>Webroot </i>only has an average of 13% of the earliest-reported IOCs for the clusters we monitored, 84% of its IOCs were not reported by other sources.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Completeness</b>. On the other hand, the early reports often only contain a small portion of IOCs. In our study, we measured the percentages of the IOC tokens and their iocterms for different at- tack clusters that were included in the first report: 6 blogs reported more than 40% of the IOC tokens and 9 blogs covered more than 50% of iocterms (related to attack behavior) per cluster. We further checked the blogs whose articles give the most complete descrip- tions of attack clusters. Altogether, <i>TaoSecurity </i>were found to have the largest number of such articles.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Robustness<span class="p">. In our research, we compared the robustness of differ- ent IOC tokens, in terms of their stability across the whole period of an attack cluster (the clusters in Table 7). From the data men- tioned above, we found that the name server, C&amp;C server, registry email are the most robust indicators, which remained unchanged in 10 to 30 percent of the clusters we analyzed (see Table 9). Using such information, we further measured the blogs likely to report these tokens: the top blogs providing most of such tokens (i.e., the number of robust IOCs vs. the number of total IOCs in a cluster) are in Table 9. Interestingly, looking into the IPs of these servers, we found that many of them actually shared the same IP prefixes, which makes us believe that they might all come from a small set of malicious Autonomous Systems.</span></h3></li></ol></li><li data-list-text="6."><h2 style="padding-top: 8pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">DISCUSSION</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">Our study shows that iACE makes an important step toward fully automated cyber threat intelligence gathering. This is significant not only for the convenient collection of information, but also for effective analysis of such information, as demonstrated by our mea- surement study. With a large amount of IOCs automatically recov- ered from the wild and converted into a machine-readable form, their intrinsic relations can be quickly discovered and effectively utilized to counter emerging threats. For example, knowing the sharing of C&amp;C servers across multiple attack instances could en- able the defender to disable or block the servers to stop the attacks. On the other hand, our current design is still preliminary. Here, we discuss the limitations of our systems and potential follow-up research.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Error/missing analysis<span class="p">. Our study shows that iACE has a high ac- curacy and coverage, well beyond what standard NLP techniques can achieve. However, still our technique introduces some false</span></h3><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">discoveries and misses some IOCs. These problems mostly come from the limitations of underlying tools we use and abnormal ways of presentation. Specifically, Tesseract, the optical character recog- nizer, is less than perfect, and its accuracy affects the outcome of our analysis. Also, the state-of-the-art dependency parser still can- not maintain its accuracy when sentences become too long. Even though iACE only works on the shortest path between an IOC and its context token, which mitigates the problem, still there are sen- tences too long for the parser to understand the dependencies be- tween words correctly. Also, adding to the complication are typos: as an example, in the case that one forgets to put a space after the period, a sentence becomes stuck with the follow-up one, which could cause an error in IOC sentence identification. Another in- teresting observation is that in some articles, authors deliberately misspell URLs to prevent the readers from inadvertently clicking on them: e.g., changing “http” to “hxxp” or add “[]” among dot in a URL. iACE includes a list of typical obfuscation tricks to rec- ognize such transfers. However, there are always approaches we do not recognize, making IOC tokens fall through the cracks. Further- more, a large amount of polluted original contents of articles might also lead to false discoveries. For example, an active attacker can compromise the blog websites and inject fake IOCs into the arti- cles, so as to trigger iACE to report false IOCs. Further effort is needed to better address these issues.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Other intelligence sources and standards<span class="p">. The current design of iACE is for gathering threat intelligence from technical blogs, based on the unique ways that IOCs are described. We believe that it will also work well on other equally or more formal sources, such as white papers and other technical articles (e.g., research pa- pers), though further study is certainly needed here. What is less clear is the technique’s effectiveness on less formal sources, like technical forums (e.g., Google groups [5], SecurityFocus [7]). The writing styles there are bit different, particularly, the use of more diverse context terms and the sentences with irregular grammat- ical structures. Extending iACE to this setting needs further ef- fort. Also, the intelligence sources we use to feed iACE are all English articles. Considering the intelligence sources of other lan- guages, iACE should import new modules for language translation of context terms and re-trained dependency parser of different lan- guages. Further, as mentioned earlier, iACE is meant to support the OpenIOC CTI model. Although there are other models such as STIX [8] and yara [12], tools exist to convert the information across these standards.</span></h3></li><li data-list-text="7."><h2 style="padding-top: 5pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">RELATED WORK</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Threat intelligence exchange</b>. To help the organizations and se- curity community defend against the fast-evolving cyber attacks, there have been great efforts on threat intelligence sharing. Face- book ThreatExchange [25] and Defense Industrial Base voluntary information sharing program (dibnet) [3] are platforms developed for exchanging IOCs between certified participants. Meanwhile, AlienVault OTX [17], OpenIOC DB [1] and IOC Bucket [29] are established to share public (unclassified) IOCs. Regardless of the type of platform, public sources like blogs still contribute a big por- tion of IOCs. Our approach, <i>iACE</i>, will contribute to the establish- ment of a fast tunnel between these public sources and exchange platforms and help the participated organizations receive IOC up- dates timely. As far as we know, AlienVault [17] and Recorded Future [13] are the only two IOC providers that support automatic IOC extraction. Even though Recorded Future (which does not provide public services) utilized NER techniques [40], both tools are simply looking for IOC entities without linking them to at- tack context, and therefore cannot generate machine-readable Ope-</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">nIOC items. Instead, <i>iACE </i>customized graph mining techniques to capture the relation between entities, which produces high-quality IOCs and their attack context with high accuracy. IOC extraction from other sources were also studied recently. Catakoglu et al. [19] demonstrated a framework to extract external components (web IOCs) from web pages served in honeypots, which compared with our approach, is more in line with the work on automatic signature generation. Sabottke et al. [43] developed a warning system to alert the user of the ongoing attacks reported by tweets (i.e., looking for the tweets with “CVE”). This is different from our work, which aims at generating machine-readable IOCs from attack reports.</p><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">NER/RE<span class="p">. NER today mainly relies on a sequence of words to iden- tify the presence of pre-defined entities (such as PERSON, LOCA- TION). For example, Stanford NER [26] utilize a Hidden Markov model to find the most likely sequence of entities from unstructured text. Other examples include Illinois NER [21] (based on super- vised learning) and LIPI [16] (based on n-gram character language models, etc.). When it comes to RE, today’s approaches use the tree kernel with SVM [24], heuristic matches with self-supervised learning [46], open pattern templates [44] and other techniques to detect specific relations between two known entities. By compar- ison, iACE leverages the unique features of IOC-related articles, using the relation detection to help identify true IOCs and their context. This combines both NER and RE steps together, which has never been done before. Our customized graph mining algo- rithm also enriches the RE techniques.</span></h3><h3 style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">NLP for security and privacy<span class="p">. Compared with its application in other areas (e.g., bioinformatics), NLP has only been recently used for security and privacy research. Prior work utilized NLP for ana- lyzing web privacy policies (by extracting its key terms) [49], gen- erating privacy policies for Android apps [48], analyzing app de- scriptions to infer required permissions by Android apps [38, 36], detecting compromised websites [31] and identifying sensitive user input from apps [28, 34]. Our work showcases a new application of NLP, demonstrating that innovative NLP techniques need to be developed to address real-world security challenges.</span></h3></li><li data-list-text="8."><h2 style="padding-top: 5pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">CONCLUSION</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">In this paper, we present <i>iACE</i>, a novel technique for automatic extraction of IOCs from unstructured text. iACE is designed to spe- cialize NLP techniques to threat intelligence gathering, combining the NER and RE steps together based on the unique features of IOCs and the technical articles describing them. By anchoring a sentence with putative IOC tokens and context terms, our approach can efficiently validate the correctness of these elements using their relations, through a novel application of graph similarity compari- son. This simple technique is found to be highly effective, vastly outperforming the top-of-the-line industry IOC analyzer and NER tool in terms of precision and coverage. Our evaluation of over 71,000 articles released in the past 13 years further reveals intrin- sic connections across hundreds of seemingly unrelated attack in- stances and the impacts of open-source IOCs on the defense against emerging threats, which highlights the significance of this first step toward fully automated cyber threat intelligence gathering.</p></li><li data-list-text="9."><h2 style="padding-top: 5pt;padding-left: 26pt;text-indent: -20pt;text-align: left;">ACKNOWLEDGMENT</h2><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;text-align: justify;">This work was supported in part by the National Science Founda- tion (grants CNS-1223477, 1223495, 1527141 and 1618493). We</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">thank our anonymous reviewers for their useful comments.</p></li><li data-list-text="10."><h2 style="padding-top: 10pt;padding-left: 32pt;text-indent: -26pt;line-height: 13pt;text-align: left;">REFERENCES</h2></li></ol><ol id="l15"><li data-list-text="[1]"><p class="s12" style="padding-left: 21pt;text-indent: -12pt;line-height: 7pt;text-align: left;">A community OpenIOC resource. https://openiocdb.com/.</p></li><li data-list-text="[2]"><p style="padding-left: 21pt;text-indent: -12pt;line-height: 8pt;text-align: left;"><a href="http://www.crummy.com/software/BeautifulSoup/" class="a" target="_blank">Beautiful Soup. </a><a href="http://www.crummy.com/software/BeautifulSoup/" target="_blank">https://www.crummy.com/software/BeautifulSoup/.</a></p></li><li data-list-text="[3]"><p style="padding-top: 6pt;padding-left: 21pt;text-indent: -12pt;text-align: left;"><a href="http://dibnet.dod.mil/" class="a" target="_blank">Defense Industrial Base Cybersecurity Information Sharing Program. </a><a href="http://dibnet.dod.mil/" target="_blank">http://dibnet.dod.mil/.</a></p></li><li data-list-text="[4]"><p style="padding-left: 21pt;text-indent: -12pt;text-align: left;"><a href="http://www.gimp.org/downloads/" class="a" target="_blank">GIMP. </a><a href="http://www.gimp.org/downloads/" target="_blank">https://www.gimp.org/downloads/.</a></p></li><li data-list-text="[5]"><p class="s12" style="padding-left: 21pt;text-indent: -12pt;text-align: left;">Google groups. https://groups.google.com/.</p></li><li data-list-text="[6]"><p class="s12" style="padding-left: 21pt;text-indent: -12pt;text-align: left;">Open Source OCR Engine. https://github.com/tesseract-ocr/tesseract.</p></li><li data-list-text="[7]"><p style="padding-left: 21pt;text-indent: -12pt;text-align: left;"><a href="http://www.securityfocus.com/" class="a" target="_blank">SecurityFocus. </a><a href="http://www.securityfocus.com/" target="_blank">www.securityfocus.com/.</a></p></li><li data-list-text="[8]"><p class="s12" style="padding-left: 21pt;text-indent: -12pt;text-align: left;">Structured Threat Information eXpression. https://stixproject.github.io.</p></li><li data-list-text="[9]"><p style="padding-left: 21pt;text-indent: -12pt;text-align: left;"><a href="http://www.openioc.org/" class="a" target="_blank">The OpenIOC Framework. </a><a href="http://www.openioc.org/" target="_blank">http://www.openioc.org.</a></p></li><li data-list-text="[10]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">topia.termextract 1.1.0. https://pypi.python.org/pypi/topia.termextract.</p></li><li data-list-text="[11]"><p style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.virustotal.com/" class="a" target="_blank">Virustotal. </a><a href="http://www.virustotal.com/" target="_blank">https://www.virustotal.com/.</a></p></li><li data-list-text="[12]"><p style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://plusvic.github.io/yara/" class="a" target="_blank">YARA. </a><a href="http://plusvic.github.io/yara/" target="_blank">http://plusvic.github.io/yara/.</a></p></li><li data-list-text="[13]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.recordedfuture.com/" class="a" target="_blank">Real-Time Threat Intelligence. </a>https://www.recordedfuture.com/, 2016.</p></li><li data-list-text="[14]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://semantic-link.com/" class="a" target="_blank">Semantic Link: find related words. </a>http://semantic-link.com/, 2016.</p></li><li data-list-text="[15]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.abisource.com/projects/enchant/" class="a" target="_blank">Abiword. Enchant. </a>http://www.abisource.com/projects/enchant/, 2010.</p></li><li data-list-text="[16]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://alias-i.com/lingpipe" class="a" target="_blank">Alias-i. Lingpipe 4.1.0. </a>http://alias-i.com/lingpipe, 2008.</p></li><li data-list-text="[17]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">AlienVault. Open Threat Intelligence. https://otx.alienvault.com/, 2016.</p></li><li data-list-text="[18]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">N. Bach and S. Badaskar. A review of relation extraction. <i>Literature review for Language and Statistics II</i>, 2007.</p></li><li data-list-text="[19]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">O. Catakoglu, M. Balduzzi, and D. Balzarotti. Automatic extraction of indicators of compromise for web applications. In <i>WWW 2016</i>, 2016.</p></li><li data-list-text="[20]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">D. Chen and C. D. Manning. A fast and accurate dependency parser using neural networks. In <i>EMNLP</i>, pages 740–750, 2014.</p></li><li data-list-text="[21]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">J. Clarke, V. Srikumar, M. Sammons, and D. Roth. An nlp curator (or: How i learned to stop worrying and love nlp pipelines). In <i>LREC</i>, 5 2012.</p></li><li data-list-text="[22]"><p style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://lists.clean-mx.com/cgi-bin/mailman/listinfo/viruswatch/" class="a" target="_blank">CleanMX. </a><a href="http://lists.clean-mx.com/cgi-bin/mailman/listinfo/viruswatch/" target="_blank">http://lists.clean-mx.com/cgi-bin/mailman/listinfo/viruswatch/.</a></p></li><li data-list-text="[23]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">D. J. Cook and L. B. Holder. <i>Mining graph data</i>. John Wiley &amp; Sons, 2006.</p></li><li data-list-text="[24]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;line-height: 8pt;text-align: left;">A. Culotta and J. Sorensen. Dependency tree kernels for relation extraction. In</p><p class="s13" style="padding-left: 21pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Proceedings of ACL’04<span class="s12">.</span></p></li><li data-list-text="[25]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">Facebook. https://developers.facebook.com/products/threat-exchange.</p></li><li data-list-text="[26]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">J. R. Finkel, T. Grenager, et al. Incorporating non-local information into information extraction systems by gibbs sampling. In <i>Proceedings of ACL’05</i>.</p></li><li data-list-text="[27]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">T. Gärtner, P. Flach, and S. Wrobel. On graph kernels: Hardness results and efficient alternatives. In <i>Learning Theory and Kernel Machines</i>. 2003.</p></li><li data-list-text="[28]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">J. Huang, Z. Li, and X. Xiao. Supor: Precise and scalable sensitive user input detection for android apps. In <i>USENIX Security’15</i>.</p></li><li data-list-text="[29]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.iocbucket.com/" class="a" target="_blank">IOCbucket. IOCbucket. </a>https://www.iocbucket.com/, 2016.</p></li><li data-list-text="[30]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.trustwave.com/" class="a" target="_blank">Josh Grunzweig. Alina: Casting a Shadow on POS. </a>https://www.trustwave.com/ Resources/SpiderLabs-Blog/Alina--Casting-a-Shadow-on-POS/, 2013.</p></li><li data-list-text="[31]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: justify;">X. Liao, K. Yuan, X. Wang, et al. Seeking nonsense, looking for trouble: Efficient promotional-infection detection through semantic inconsistency search. In <i>Proceedings of S&amp;P’16</i>.</p></li><li data-list-text="[32]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">R. Mihalcea and P. Tarau. Textrank: Bringing order into texts. Association for Computational Linguistics, 2004.</p></li><li data-list-text="[33]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">D. Nadeau and S. Sekine. A survey of named entity recognition and classification. <i>Lingvisticae Investigationes</i>, 30(1):3–26, 2007.</p></li><li data-list-text="[34]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">Y. Nan, M. Yang, Z. Yang, et al. Uipicker: User-input privacy identification in mobile applications. In <i>USENIX Security’15</i>.</p></li><li data-list-text="[35]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">L. Obrst, P. Chase, and R. Markeloff. Developing an ontology of the cyber security domain. In <i>STIDS</i>, pages 49–56, 2012.</p></li><li data-list-text="[36]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">R. Pandita, X. Xiao, et al. Whyper: Towards automating risk assessment of mobile applications. In <i>USENIX Security’13</i>.</p></li><li data-list-text="[37]"><p style="padding-left: 21pt;text-indent: -16pt;text-align: left;"><a href="http://www.phishtank.com/" class="a" target="_blank">PhishTank. </a><a href="http://www.phishtank.com/" target="_blank">https://www.phishtank.com/.</a></p></li><li data-list-text="[38]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">Z. Qu, V. Rastogi, and X. Zhang. Autocog: Measuring the description-to-permission fidelity in android applications. CCS ’14.</p></li><li data-list-text="[39]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: justify;">J. Ramon and T. Gärtner. Expressivity versus efficiency of graph kernels. In <i>First international workshop on mining graphs, trees and sequences</i>, pages 65–74. Citeseer, 2003.</p></li><li data-list-text="[40]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: justify;"><a href="http://info.recordedfuture.com/Portals/252628/resources/" class="a" target="_blank">Recorded Future. </a>http://info.recordedfuture.com/Portals/252628/resources/ cyber-anatomy-white-paper.pdf.</p></li><li data-list-text="[41]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: justify;">Recorded Future. Recorded Future at SITA. https://go.recordedfuture.com/ hs-fs/hub/252628/file-2607572540-pdf/case-studies/sita.pdf, 2015.</p></li><li data-list-text="[42]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: justify;"><a href="http://www.gartner.com/doc/2487216/definition-threat-intelligence" class="a" target="_blank">Rob McMillan. Open Threat Intelligence. </a>https://www.gartner.com/doc/2487216/definition-threat-intelligence, 2013.</p></li><li data-list-text="[43]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">C. Sabottke, O. Suciu, et al. Vulnerability disclosure in the age of social media: Exploiting twitter for predicting real-world exploits. In <i>USENIX Security’15</i>.</p></li><li data-list-text="[44]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">M. Schmitz, R. Bart, S. Soderland, et al. Open language learning for information extraction. In <i>Proceedings of the JCEMNLP’12</i>.</p></li><li data-list-text="[45]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">B. Settles. Abner: an open source tool for automatically tagging genes, proteins and other entity names in text. <i>Bioinformatics</i>, 21(14):3191–3192, 2005.</p></li><li data-list-text="[46]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;line-height: 8pt;text-align: left;">F. Wu and D. S. Weld. Open information extraction using wikipedia. In</p><p class="s13" style="padding-left: 21pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Proceedings of ACL’10<span class="s12">.</span></p></li><li data-list-text="[47]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">L. Yi, B. Liu, and X. Li. Eliminating noisy information in web pages for data mining. In <i>Proceedings of ACM SIGKDD’03</i>.</p></li><li data-list-text="[48]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">L. Yu, T. Zhang, X. Luo, and L. Xue. Autoppg: Towards automatic generation of privacy policy for android applications. SPSM ’15, 2015.</p></li><li data-list-text="[49]"><p class="s12" style="padding-left: 21pt;text-indent: -16pt;text-align: left;">S. Zimmeck and S. M. Bellovin. Privee: An architecture for automatically analyzing web privacy policies. In <i>USENIX Security 14</i>, 2014.</p></li></ol></body></html>
