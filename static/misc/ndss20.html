<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>ndss20</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 24pt; }
 .s2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s4 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .p, p { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .s5 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s6 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .h2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s7 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s8 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .a, a { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 h1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s10 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 3pt; }
 .s11 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s12 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s13 { color: #2A3E5F; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s14 { color: #2A3E5F; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s15 { color: #2A3E5F; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s16 { color: black; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s17 { color: #FFF; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s18 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s19 { color: #2A3E5F; font-family:Verdana, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s20 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s21 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s22 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s23 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s24 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s25 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s26 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s27 { color: black; font-family:Helvetica, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s28 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s29 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 4pt; }
 .s30 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s31 { color: #F00; font-family:Helvetica, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 4pt; }
 .s32 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; }
 .s33 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; vertical-align: 1pt; }
 .s34 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; vertical-align: 1pt; }
 .s35 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3pt; }
 h4 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 4.5pt; }
 .s36 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s37 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s38 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2.5pt; }
 .s39 { color: black; font-family:Helvetica, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s40 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s41 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s42 { color: black; font-family:Menlo, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s43 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: underline; font-size: 5pt; }
 .s44 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -1pt; }
 .s45 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 2pt; }
 .s46 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 2pt; }
 .s47 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 1pt; }
 .s48 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt; }
 .s49 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt; }
 .s50 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s51 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s52 { color: black; font-family:Helvetica, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s53 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 2pt; }
 .s54 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 1pt; }
 h3 { color: #F00; font-family:Helvetica, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 5pt; }
 .s55 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -3pt; }
 .s56 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; }
 .s57 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; vertical-align: 1pt; }
 .s58 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3pt; }
 .s59 { color: #333; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s60 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s61 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s62 { color: #333; font-family:Helvetica, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 3.5pt; }
 .s63 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s64 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s66 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -1pt; }
 .s67 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s68 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; vertical-align: 1pt; }
 .s69 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s70 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s71 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 1pt; }
 .s72 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s73 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s74 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s75 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s76 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; vertical-align: 1pt; }
 .s77 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s78 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s79 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s80 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2.5pt; }
 .s81 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s82 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s83 { color: #1D1D1D; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s84 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s85 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: 2pt; }
 .s86 { color: black; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; vertical-align: -1pt; }
 .s87 { color: #1D1D1D; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s88 { color: #1D1D1D; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s89 { color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, upper-roman)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: "("counter(d1, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt;counter-reset: d2 1; }
 #l3> li>*:first-child:before {counter-increment: d2; content: counter(d2, decimal)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l4 {padding-left: 0pt;counter-reset: e1 1; }
 #l4> li>*:first-child:before {counter-increment: e1; content: counter(e1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: e1 0;  }
 #l5 {padding-left: 0pt;counter-reset: e2 1; }
 #l5> li>*:first-child:before {counter-increment: e2; content: "("counter(e2, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: e2 0;  }
 #l6 {padding-left: 0pt;counter-reset: f1 1; }
 #l6> li>*:first-child:before {counter-increment: f1; content: "("counter(f1, decimal)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l7 {padding-left: 0pt;counter-reset: g1 1; }
 #l7> li>*:first-child:before {counter-increment: g1; content: counter(g1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l7> li:first-child>*:first-child:before {counter-increment: g1 0;  }
 #l8 {padding-left: 0pt;counter-reset: h1 1; }
 #l8> li>*:first-child:before {counter-increment: h1; content: counter(h1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l8> li:first-child>*:first-child:before {counter-increment: h1 0;  }
 #l9 {padding-left: 0pt;counter-reset: h2 1; }
 #l9> li>*:first-child:before {counter-increment: h2; content: counter(h2, decimal)") "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l9> li:first-child>*:first-child:before {counter-increment: h2 0;  }
 #l10 {padding-left: 0pt;counter-reset: i1 1; }
 #l10> li>*:first-child:before {counter-increment: i1; content: counter(i1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l10> li:first-child>*:first-child:before {counter-increment: i1 0;  }
 #l11 {padding-left: 0pt;counter-reset: f1 4; }
 #l11> li>*:first-child:before {counter-increment: f1; content: "("counter(f1, decimal)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l12 {padding-left: 0pt;counter-reset: i2 1; }
 #l12> li>*:first-child:before {counter-increment: i2; content: "("counter(i2, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: i2 0;  }
 #l13 {padding-left: 0pt;counter-reset: j1 1; }
 #l13> li>*:first-child:before {counter-increment: j1; content: counter(j1, upper-latin)". "; color: black; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: j1 0;  }
 #l14 {padding-left: 0pt;counter-reset: k1 1; }
 #l14> li>*:first-child:before {counter-increment: k1; content: "("counter(k1, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l14> li:first-child>*:first-child:before {counter-increment: k1 0;  }
 #l15 {padding-left: 0pt;counter-reset: k2 1; }
 #l15> li>*:first-child:before {counter-increment: k2; content: "("counter(k2, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l15> li:first-child>*:first-child:before {counter-increment: k2 0;  }
 #l16 {padding-left: 0pt;counter-reset: j2 1; }
 #l16> li>*:first-child:before {counter-increment: j2; content: "("counter(j2, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l16> li:first-child>*:first-child:before {counter-increment: j2 0;  }
 #l17 {padding-left: 0pt;counter-reset: l1 1; }
 #l17> li>*:first-child:before {counter-increment: l1; content: "("counter(l1, lower-latin)") "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l17> li:first-child>*:first-child:before {counter-increment: l1 0;  }
 li {display: block; }
 #l18 {padding-left: 0pt;counter-reset: m1 1; }
 #l18> li>*:first-child:before {counter-increment: m1; content: "["counter(m1, decimal)"] "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l18> li:first-child>*:first-child:before {counter-increment: m1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p class="s1" style="padding-top: 3pt;padding-left: 43pt;text-indent: 0pt;text-align: left;">BLAG: Improving the Accuracy of Blacklists</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s2" style="padding-top: 4pt;padding-left: 41pt;text-indent: 0pt;line-height: 107%;text-align: center;">Sivaramakrishnan Ramanathan <a href="mailto:satyaman@usc.edu" class="s4" target="_blank">University of Southern California/ Information Sciences Institute satyaman@usc.edu</a></p><p class="s2" style="padding-top: 4pt;padding-left: 80pt;text-indent: 0pt;text-align: center;">Jelena Mirkovic</p><p style="padding-left: 80pt;text-indent: 0pt;line-height: 107%;text-align: center;"><a href="mailto:mirkovic@isi.edu" class="s5" target="_blank">University of Southern California/ Information Sciences Institute mirkovic@isi.edu</a></p><p class="s2" style="padding-top: 4pt;padding-left: 38pt;text-indent: 0pt;text-align: center;">Minlan Yu</p><p style="padding-left: 38pt;text-indent: 0pt;line-height: 107%;text-align: center;"><a href="mailto:minlanyu@g.harvard.edu" class="s5" target="_blank">Harvard University minlanyu@g.harvard.edu</a></p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-top: 6pt;padding-left: 5pt;text-indent: 13pt;text-align: justify;">Abstract<span class="h2">—IP address blacklists are a useful source of infor- mation about repeat attackers. Such information can be used to prioritize which traffic to divert for deeper inspection (e.g., repeat offender traffic), or which traffic to serve first (e.g., traffic from sources that are not blacklisted). But blacklists also suffer from overspecialization – each list is geared towards a specific purpose – and they may be inaccurate due to misclassification or stale information. We propose BLAG, a system that evaluates and aggregates multiple blacklists feeds, producing a more useful, accurate and timely </span>master blacklist<span class="h2">, tailored to the specific customer network. BLAG uses a sample of the legitimate sources of the customer network’s inbound traffic to evaluate the accuracy of each blacklist over regions of address space. It then leverages recommendation systems to select the most accurate information to aggregate into its master blacklist. Finally, BLAG identifies portions of the master blacklist that can be expanded into larger address regions (e.g. /24 prefixes) to uncover more malicious addresses with minimum collateral damage. Our evaluation of 157 blacklists of various attack types and three ground-truth datasets shows that BLAG achieves high specificity up to 99%, improves recall by up to 114 times compared to competing approaches, and detects attacks up to 13.7 days faster, which makes it a promising approach for blacklist generation.</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="I."><p style="padding-left: 105pt;text-indent: -14pt;text-align: left;"><a name="bookmark0">&zwnj;</a>Introduction</p><p class="s7" style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">IP blacklists <a href="#bookmark86" class="s5">(“blacklists” for short), which contain iden- tities of prior known offenders, are usually used to aid more sophisticated defenses, such as spam filters or security infor- mation and event management (SIEM) systems, in identifying traffic that warrants further analysis </a><span class="p">[15]. Blacklists do not have to be very accurate to be used in this </span>advisory <a href="#bookmark137" class="s5">mode, since they merely aid another, more sophisticated system, which decides traffic’s destiny. In fact, prior works </a><a href="#bookmark131" class="s5">[66], </a><a href="#bookmark134" class="s5">[60], </a><a href="#bookmark141" class="s5">[63], </a><a href="#bookmark145" class="s5">[70], </a><span class="p">[74] show that blacklists are often not very accurate or useful. They do not misclassify many legitimate sources, but they miss the majority of malicious sources.</span></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark136" class="s5">What if a network suffers a novel attack, which bypasses its sophisticated defenses? Or what if the attack has such a large volume that the more sophisticated system cannot keep up? In these situations, networks usually resort to crude defenses, such as rate-limiting traffic or filtering all incoming traffic to a given port number or a destination </a><a href="#bookmark138" class="s5">[65], </a><a href="#bookmark72" class="s5">[67], </a><a href="#bookmark125" class="s5">[1], [54].</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">IP blacklists could be used <i>as emergency response</i>, in case of a novel or large-scale attacks, to filter attacks from</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Network and Distributed Systems Security (NDSS) Symposium 2020 23-26 February 2020, San Diego, CA, USA</p><p class="s8" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ISBN 1-891562-61-4</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="http://www.ndss-symposium.org/" class="a" target="_blank">https://dx.doi.org/10.14722/ndss.2020.24232 </a><a href="http://www.ndss-symposium.org/" target="_blank">www.ndss-symposium.org</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">prior known malicious sources, and act as the first layer of defense. For example, an email server hit by a heavy phishing campaign, whose signature does not yet exist in the server’s spam filters, could use blacklists to drop emails sent by prior known malicious sources. Or a network under a distributed denial-of-service attack could use blacklists to drop all traffic sent by prior known malicious sources, to lessen its load. Blacklists are easy to implement since only the source IP address of incoming traffic is checked, which can be cheap at line speed. In this emergency mode, blacklists would have to be very accurate, since they would actively drop traffic. This means that blacklists should be able to identify the <i>majority of attack sources </i>while keeping <i>misclassification of legitimate sources low</i>. This paper explores how to generate sufficiently accurate blacklists for emergency use.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Individual blacklists today suffer from several drawbacks that limit their accuracy in malicious source identification. Firstly, individual blacklists miss many malicious sources. This effect may come from their limited vantage points – e.g., blacklist maintainers may have honeypots in the United States but not in India – or from their limited scope – e.g., blacklists are created for specific attack classes, like spam. On the other hand, compromised devices are constantly being drafted into botnets and misused for different attacks, such as sending spam one day and participating in denial-of-service attacks on a different day. <i>Aggregating blacklists from different maintainers and across various attack types </i>can improve the accuracy of malicious source identification over any individual blacklist.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark137" class="s5">Secondly, blacklists are snapshots of malicious sources at a given time. Attackers are known to evade blacklisting by staying dormant, only to resume malicious activities later </a>[66]. <i>Historical blacklist data can provide additional intelligence </i>on active past offenders that are likely to re-offend in the future.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark152" class="s5">Finally, malicious sources have historically been known to concentrate in a few mismanaged networks </a>[81]. Thus, <i>ex- panding certain blacklisted IP addresses into IP prefixes </i>could improve the accuracy of malicious source identification. But the aggregation of data from multiple lists and past periods, and expansion of addresses into prefixes may greatly increase misclassifications of legitimate traffic <i>if applied naïvely</i>. We propose BLAG (<b>BL</b>acklist <b>AG</b>gregator), which performs <i>smart aggregation of blacklist data</i><a href="#bookmark1" class="s5">, and tailors this data to the customer network</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">1</span>. BLAG’s blacklists have a much higher accuracy of malicious source identification and they keep collateral damage to legitimate sources low. BLAG overcomes problems of existing blacklists as follows:</p><p class="s10" style="padding-top: 8pt;padding-left: 13pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><a name="bookmark1">&zwnj;</a>1<span class="s11">A customer network is a network, which is deploying BLAG for its own</span></p><p class="s12" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">emergency <span class="s8">response.</span></p><p class="s13" style="padding-top: 3pt;padding-left: 84pt;text-indent: 0pt;text-align: left;"><a name="bookmark2">&zwnj;</a>routable /24  unique routable /24</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">(%) of blacklisted routable /24</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 55pt;text-indent: 0pt;text-align: left;">60                           <span class="s15">Blacklist category overlapping percentage</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">100</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">50</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">40</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">30</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">20</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">10</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">0</p><p class="s13" style="padding-top: 3pt;padding-left: 59pt;text-indent: 0pt;text-align: left;">0     50     100     150</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 94pt;text-indent: 0pt;text-align: left;">(#) of blacklists</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="text-indent: 0pt;text-align: right;">Attack</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="text-indent: 0pt;text-align: right;">Spam</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="text-indent: 0pt;text-align: right;">Reputation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="text-indent: 0pt;text-align: right;">Malware</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 6pt;text-indent: -1pt;line-height: 218%;text-align: left;"><span style=" color: #2A3E5F;">Malware Reputation  Spam  Attack </span>9.56%  <span style=" color: #FFF;">77.09%  </span>29.56%  <span style=" color: #FFF;">100%</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0.15%  7.08%  <span style=" color: #FFF;">100%  </span>0.37%</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.67%  <span style=" color: #FFF;">100%  71.6%  </span>9.87%</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">100%  <span style=" color: #000;">14.63%  13.2%  10.74%</span></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 39pt;text-indent: 0pt;text-align: left;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">(%) of /24</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 39pt;text-indent: 0pt;text-align: left;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 39pt;text-indent: 0pt;text-align: left;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 39pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 42pt;text-indent: 0pt;line-height: 4pt;text-align: left;">0</p><p class="s13" style="padding-left: 64pt;text-indent: 0pt;line-height: 4pt;text-align: left;">50   100   150   200   250</p><p class="s14" style="padding-left: 33pt;text-indent: 0pt;line-height: 118%;text-align: center;"><a name="bookmark3">&zwnj;</a>Number of blacklisted address in the same /24 prefix<a name="bookmark4">&zwnj;</a></p><ol id="l2"><li data-list-text="(a)"><p class="s8" style="padding-top: 3pt;padding-left: 54pt;text-indent: -12pt;text-align: left;">Blacklist coverage in routable /24 pre- fixes that are blacklisted.</p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 3pt;padding-left: 17pt;text-indent: -12pt;text-align: left;">Blacklist overlap across different black- list categories.</p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 3pt;padding-left: 17pt;text-indent: -12pt;text-align: left;">IP addresses blacklisted in the same /24 prefix.</p><p style="padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 1: Blacklists have low coverage and tend to overlap with other categories of blacklists. Therefore, aggregating blacklists of different types can improve coverage. Also blacklisted addresses tend to be collocated, thus expanding IP addresses to prefixes may further improve malicious source identification.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l3"><li data-list-text="1)"><h1 style="padding-top: 5pt;padding-left: 25pt;text-indent: -13pt;text-align: justify;">Aggregation: <span class="p">BLAG aggregates IP addresses from 157 blacklists of different attack types to improve coverage. BLAG also includes historical listings from these bla- cklists and assigns relevance score that determines which historical IP addresses are more likely to re-offend.</span></h1></li><li data-list-text="2)"><h1 style="padding-left: 25pt;text-indent: -13pt;text-align: justify;">Estimate misclassifications: <span class="p">BLAG uses a recommen- dation system, together with a sample of sources that send inbound traffic to a customer network to tailor its blacklist to this customer. BLAG identifies portions of individual blacklists that may lead to the legitimate source misclassifications and prunes them out. Other portions are aggregated into the master blacklist for this customer.</span></h1></li><li data-list-text="3)"><h1 style="padding-left: 25pt;text-indent: -13pt;text-align: justify;">Selective expansion: <span class="p">BLAG selects a subset of IP addresses on the master blacklist to expand into /24 prefixes. Only those IP addresses are expanded, where the expansion is not likely to increase legitimate source misclassifications for the given customer.</span></h1></li></ol></li></ol><p style="padding-top: 8pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark11" class="s5">We present three real-world deployment scenarios for BLAG</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">2</span><a href="#bookmark149" class="s5"> covering different attacks, where customer networks can reduce the burden on resource-intensive technologies. BLAG improves existing blacklisting approaches by increas- ing recall (malicious source identification) from 0.1–18.4% to 6.4–69.7%, while maintaining high specificity (legitimate source identification) of 95–99.5%. BLAG also outperforms PRESTA </a>[78], a proposed blacklist aggregation approach by achieving 11.5–84.4% higher specificity, with comparable re- call. BLAG also improves the detection delay, discovering malicious sources 8.8–13.4 days faster than competing ap- proaches.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="II."><p style="padding-left: 52pt;text-indent: -18pt;text-align: left;"><a name="bookmark5">&zwnj;</a>Problems With Current Blacklists<a name="bookmark10">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark12" class="s5">In this section, we illustrate the drawbacks that blacklists have, that limit their usefulness in emergency scenarios. We then discuss possible solutions to improve blacklisting and some challenges that we must address. We first show that bla- cklists generally have low coverage and blacklists of different attack types tend to overlap with one another (Section </a>II-A). This motivates the need for aggregating multiple blacklists</p><p class="s10" style="padding-top: 9pt;padding-left: 5pt;text-indent: 7pt;text-align: left;"><a name="bookmark11">&zwnj;</a>2<a href="https://steel.isi.edu/Projects/BLAG/" class="s18" target="_blank">Blacklist dataset and code to deploy BLAG can be found at https://steel. isi.edu/Projects/BLAG/</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark16" class="s5">of different attack types to improve coverage of malicious sources. We further show IP addresses that were blacklisted in the past get blacklisted again, and sometimes soon after they were removed from a blacklist (Section </a>II-B). This motivates the need for inclusion of historical blacklist data to further improve coverage of malicious sources. Finally, we show that blacklisted IP addresses are often collocated within the same</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark17" class="s5">/24 prefix, thus, expanding some IP addresses to prefixes can improve attack detection (Section II-C).</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark18" class="s5">In all cases, some addresses that appear on blacklists may be “wrongly accused”, i.e., they may be misclassified, legit- imate sources or they may be previously malicious sources, which were since cleaned. We illustrate this in Section </a>II-D to motivate the need for smart, selective aggregation and expansion only of those <i>portions </i>of blacklists that are unlikely to contain legitimate sources.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark39" class="s5">In this section, we leverage our Blacklist dataset, whose details are given in Section </a>IV-A. It consists of 157 publicly available, popular blacklists. We collected their data regularly for 11 months in 2016. We have roughly categorized each blacklist into four categories, based on the type of malicious activities they capture. <i>Spam </i>blacklists monitor email spam or emails that contain malicious content and <i>Malware </i>blacklists monitor IP addresses that host or distribute malware. <i>Attack </i>blacklists, on the other hand, contain IP addresses that initiate DDoS attacks, bruteforce or attacks on specific protocols such as VoIP or SSH. Finally, <i>Reputation </i>blacklists list IP addresses that have a low reputation, e.g., because they send unwanted traffic. The algorithm to calculate this reputation is known only to blacklist maintainers.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l4"><li data-list-text="A."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark6">&zwnj;</a>Fragmented Information<a name="bookmark12">&zwnj;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark2" class="s5">Monitoring the entire Internet accurately is impossible. By necessity, each blacklist will gather data from some limited area of the Internet, and thus information about malicious sources will be fragmented over many blacklists. Figure </a><a href="#bookmark142" class="s5">1(a) illustrates the coverage of individual blacklists in our Blacklist dataset and the unique contribution of blacklists over the dataset “Black24,” containing all routable /24 prefixes (ex- tracted from Routeviews </a>[71]) that have at least one blacklisted</p><p class="s13" style="padding-top: 3pt;text-indent: 0pt;text-align: right;"><a name="bookmark13">&zwnj;</a>Naïve aggregation  Naïve aggregation expansion</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-top: 1pt;padding-left: 25pt;text-indent: -24pt;line-height: 118%;text-align: left;">(%) of reported addresses that re­offend in the same blacklist</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">(%) of reoffenses</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;line-height: 3pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 104pt;text-indent: 0pt;text-align: left;">Scenario 1</p><p class="s13" style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;text-align: left;">20</p><p class="s13" style="padding-top: 3pt;padding-left: 53pt;text-indent: 0pt;text-align: left;">10</p><p class="s14" style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">(%) of misclassifications</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-top: 3pt;padding-left: 55pt;text-indent: 0pt;text-align: left;">0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 104pt;text-indent: 0pt;text-align: left;">Scenario 2</p><p class="s13" style="padding-top: 1pt;padding-left: 53pt;text-indent: 0pt;text-align: left;">60</p><p class="s13" style="padding-left: 53pt;text-indent: 0pt;text-align: left;">40</p><p class="s13" style="padding-left: 53pt;text-indent: 0pt;text-align: left;">20</p><p class="s13" style="padding-left: 55pt;text-indent: 0pt;text-align: left;">0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 104pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Scenario 3</p><p class="s13" style="padding-left: 55pt;text-indent: 0pt;line-height: 4pt;text-align: left;">9</p><p class="s13" style="padding-top: 1pt;padding-left: 55pt;text-indent: 0pt;text-align: left;">6</p><p class="s13" style="padding-top: 1pt;padding-left: 55pt;text-indent: 0pt;text-align: left;">3</p><p class="s13" style="padding-top: 1pt;padding-left: 55pt;text-indent: 0pt;text-align: left;">0</p><p class="s13" style="padding-left: 59pt;text-indent: 0pt;text-align: left;">0     50     100     150</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 97pt;text-indent: 0pt;text-align: left;">(#) of blacklists</p><ol id="l5"><li data-list-text="(a)"><p class="s8" style="padding-top: 4pt;padding-left: 54pt;text-indent: -12pt;text-align: left;">IP addresses in blacklists that re-offend.</p><p class="s13" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">0    50    100    150    200</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 52pt;text-indent: 0pt;text-align: left;"><a name="bookmark14">&zwnj;</a>Days between reoffense</p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 4pt;padding-left: 43pt;text-indent: -12pt;text-align: left;">Days between reoffense.</p><p class="s13" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">0      50     100     150</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 33pt;text-indent: 0pt;text-align: center;"><a name="bookmark15">&zwnj;</a>(#) of blacklist</p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 4pt;padding-left: 36pt;text-indent: -12pt;text-align: justify;">Misclassification observed in individual blacklists across three different legitimate addresses.</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Figure 2: Blacklisted addresses re-offend quickly. A possible solution is to expand addresses to prefixes, but this causes misclassification of legitimate sources.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">address. On average, a blacklist reports only 3.03% of Black24. <i>Nixspam </i><a href="#bookmark139" class="s5">blacklist </a>[68] has the highest coverage of 60.7% of Black24. Some blacklists also have unique contributions, i.e., they list addresses from prefixes that appear on no other blacklist. On average, a blacklist contributes unique addresses that belong to 0.16% of Black24. <i>Nixspam </i><a href="#bookmark145" class="s5">blacklist has the highest unique contribution – 10.9% of Black24. Previous studies observed similarly low coverage </a><a href="#bookmark131" class="s5">[74], </a>[60] of blacklists.</p><p style="padding-top: 8pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark3" class="s5">Another possible reason for fragmented information is the blacklists’ focus on a specific type of attacks. This is again by necessity as blacklists built from spam filter alerts will only see spam sources, while intrusion detection systems will only see sources of scans and network attacks. Figure </a>1(b) shows the overlap of blacklist categories on the y-axis with the blacklist categories on the x-axis. On average, blacklist categories have an overlap of 20.4% with other blacklist categories. The highest overlap is seen in the “attack” category (average 38.7% overlap) and the lowest overlap is seen with the “spam” category (average 2.5% overlap). Although our categorization may not be perfect, we observe that IP addresses are reported across different types of blacklists. Therefore, aggregating multiple blacklists across different attack types can increase blacklist coverage and detect sources of multiple attack types.</p><p style="padding-top: 9pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="B."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark7">&zwnj;</a>Re-offense Is Frequent<a name="bookmark16">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark13" class="s5">Figure </a>2(a) shows the percentage of blacklisted IP ad- dresses (in any blacklist) that have been removed and then appeared again on the same blacklist. On average, 29.3% of blacklisted IP addresses re-offend. Particularly, in two blacklists, <i>Bambenek Pushdo </i>and <i>Palevo</i><a href="#bookmark14" class="s5">, all IP addresses blacklisted re-offend. However, these are very small blacklists that have reported only 1 and 12 IP addresses during our monitoring period. Figure </a>2(b) shows the duration between each offense, that is, the number of days the IP addresses stay dormant before they are blacklisted again. On average, reoffenses occur within 9 days and about 91% of reoffense occurs within 30 days. This motivates the need for aggregation of historical blacklist information, especially over the recent past, to improve coverage of malicious sources.</p></li><li data-list-text="C."><p class="s7" style="padding-top: 4pt;padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark8">&zwnj;</a>Malicious Sources Are Co-located<a name="bookmark17">&zwnj;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark152" class="s5">Prior research has shown that attackers tend to concentrate in a few mismanaged networks </a><a href="#bookmark4" class="s5">[81]. Thus blacklisting an entire network (e.g., one or a set of IP prefixes) could improve coverage of malicious sources. Figure </a>1(c) shows the number of blacklisted IP addresses in the same /24 prefix, for all /24 prefixes that are present in the blacklist dataset observed during the entire monitoring period. About 57.5% of /24 prefixes have at least two blacklisted IP addresses in the same /24 prefixes. For about 1.7% of /24 prefixes, nearly half the /24 prefix (128 IP addresses) are blacklisted. Only a few /24 prefixes have (0.007%) all their IP addresses in a /24 prefix blacklisted. Identifying prefixes that harbor more malicious sources can increase the blacklist’s coverage of malicious sources.</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="D."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark9">&zwnj;</a>Careful Aggregation and Expansion<a name="bookmark18">&zwnj;</a></p></li></ol><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Not all IP addresses that appear on blacklists are necessar- ily malicious. Some may have been malicious and got cleaned, which means that the blacklist has stale information. Others may have been misclassified by the blacklisting algorithm. Since blacklists are built using proprietary algorithms, it is impossible to evaluate their accuracy and/or bias.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark15" class="s5">If we were to naïvely aggregate and expand blacklisted addresses, this would amplify bias and misclassification of legitimate sources. For example, Figure </a>2(c) illustrates, on the y-axis, the percentage of <i>legitimate addresses </i><a href="#bookmark38" class="s5">in our three Scenario datasets (see Section </a>IV for details on datasets) that appears on a blacklist. These address sets are mostly disjoint and are collected from regular inbound traffic in three different networks. The x-axis shows different blacklists in our Blacklist dataset. The order of blacklists is always the same on the x- axis. For this Figure, we used <i>naïvely aggregated historical data </i>of each blacklist, i.e, for a given blacklist we produced the list of all addresses that were listed on it up to the time of our Scenario (shown in blue). We make several observations. First, for each Scenario, all misclassifications are concentrated on a few blacklists. On average, about 0.14%, 0.17% and 0.016% of legitimate IP addresses are misclassified. Blacklists such as <a href="#bookmark87" style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt;">Cruzit </a>[16] and <a href="#bookmark75" style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt;">Chaos Reigns </a><a href="#bookmark15" class="s5">[4] have high misclassifications of 3.3% and 9.8% respectively. Figure </a>2(c) also shows that</p><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">MB</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-top: 3pt;text-indent: 0pt;text-align: right;"><a name="bookmark19">&zwnj;</a>Evaluate</p><p class="s21" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">Aggregate</p><p class="s21" style="padding-top: 3pt;padding-left: 109pt;text-indent: 0pt;text-align: left;">Expand</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist m</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">BL 1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">....</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">BL m</p><p class="s20" style="padding-top: 4pt;text-indent: 0pt;text-align: right;">..</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 3</p><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="2"><p class="s24" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">.. <span class="s25">0.8</span></p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.3</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.5</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.7</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.5</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.9</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.04</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.7</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.9</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.7</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">1</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.9</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">1</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s27" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">169.231.140.10</p><p class="s20" style="padding-top: 4pt;padding-left: 33pt;text-indent: 0pt;text-align: center;">..</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist 3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">Blacklist m-1</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="text-indent: 0pt;line-height: 4pt;text-align: left;">MB</p><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:29pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="2"><p class="s24" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">.. <span class="s25">0.78</span></p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.75</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.28</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.11</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.15</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.22</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.46</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.4</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.72</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.23</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.87</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.6</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.32</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.25</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.12</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.58</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.95</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.91</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.92</p></td></tr><tr style="height:11pt"><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.79</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.87</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s24" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">..</p></td><td style="width:14pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.81</p></td><td style="width:15pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">0.99</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:11pt"><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s29" style="padding-left: 7pt;text-indent: -4pt;line-height: 5pt;text-align: left;">Master blacklist candidates</p></td></tr><tr style="height:11pt"><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">169.231.140.68</p></td></tr><tr style="height:11pt"><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">193.1.64.5</p></td></tr><tr style="height:11pt"><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">193.1.64.8</p></td></tr><tr style="height:11pt"><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">216.59.0.8</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:11pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s29" style="padding-left: 9pt;text-indent: -5pt;line-height: 5pt;text-align: left;">BLAG master blacklist</p></td></tr><tr style="height:11pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">169.231.140.68</p></td></tr><tr style="height:11pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">193.1.64.0/24</p></td></tr><tr style="height:11pt"><td style="width:36pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s30" style="padding-top: 3pt;text-indent: 0pt;text-align: center;">216.59.0.0/24</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s31" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">169.231.140.10</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 31pt;text-indent: 2pt;line-height: 107%;text-align: left;">Currently and historically listed IP addresses <b>(B)</b></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">Relevance Score</p><p class="s20" style="padding-left: 36pt;text-indent: 0pt;text-align: left;">Calculation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s34" style="padding-left: 35pt;text-indent: -4pt;text-align: left;"><span class="s22">Known Legitimate </span><span class="s33">sources </span>(L<span class="s35">tr</span>)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">169.231.140.68</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">193.1.64.5</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">193.1.64.8</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">216.59.0.8</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">216.59.16.171</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">243.13.0.23</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">243.13.222.203</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 69pt;text-indent: 0pt;text-align: left;">169.231.140.68</p><h4 style="padding-top: 2pt;padding-left: 31pt;text-indent: 0pt;line-height: 5pt;text-align: left;">Recommendation</h4><p class="s36" style="padding-left: 42pt;text-indent: 0pt;line-height: 76%;text-align: left;">system<span class="s37">  </span><span class="s27">193.1.64.5</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 69pt;text-indent: 0pt;text-align: left;">193.1.64.8</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 70pt;text-indent: 0pt;text-align: left;">216.59.0.8</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 70pt;text-indent: 0pt;text-align: left;">216.59.16.171</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 70pt;text-indent: 0pt;text-align: left;">243.13.0.23</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="padding-left: 70pt;text-indent: 0pt;text-align: left;">243.13.222.203</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 31pt;text-indent: 0pt;text-align: left;">Prune</h4><p class="s38" style="padding-top: 3pt;padding-left: 35pt;text-indent: 0pt;text-align: left;">a</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 31pt;text-indent: 1pt;text-align: left;">Selective expansion</h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s39" style="padding-left: 256pt;text-indent: 0pt;text-align: left;">Likely to be a misclassiﬁcation    Unlikely to be a misclassiﬁcation</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 3: BLAG implementation consists of assigning relevance scores to IP addresses from different blacklists and creating a new <i>misclassification blacklist (MB)</i>. The MB contains all possible IP addresses, but a score is only assigned to those that are misclassifications from the known-legitimate sources dataset (L<i>tr</i>). Then, a recommendation system generates missing scores for IP addresses in the MB. IP addresses that have a score higher than <i>α </i>threshold (red blocks in <i>MB</i>) are pruned out and the remaining ones are used for aggregation. These IP addresses will be put on a new blacklist known as “Master blacklist candidates”. Finally, we selectively expand some candidates into /24 prefixes, if we estimate that this expansion will not severely increase misclassification.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">there is no single blacklist that has misclassifications across all three scenarios, thus removing certain blacklists will not solve the problem. Instead, we must <i>tailor </i>each blacklist to the customer that is going to use it, to identify and remove portions that may lead to misclassifications of the sources of customer’s inbound traffic.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Naïve expansion of blacklisted addresses into prefixes can also lead to misclassifications. We take the naïvely aggregated historical data described earlier, expand every address to its</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark15" class="s5">/24 prefix and show the percentage of misclassification in Figure </a>2(c) (yellow dotted lines). We see that the percentage of misclassifications further increases with naïve expansion. On average, about 0.66%, 6.6% and 1.03% of legitimate addresses are misclassified. Blacklists such as <a href="#bookmark85" style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt;">Cleantalk </a>[14] and <a href="#bookmark75" style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt;">Chaos Reigns </a>[4] have high misclassification of 67.2% and 22.6% respectively. Although blacklisted addresses are collocated, naïvely expanding them into /24 prefixes can increase mis- classifications.</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="III."><p style="padding-left: 111pt;text-indent: -24pt;text-align: left;"><a name="bookmark20">&zwnj;</a>BLAG D<span class="s41">ESIGN</span><a name="bookmark25">&zwnj;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark19" class="s5">We present BLAG’s design in this section and illustrate the system in Figure </a>3. BLAG collects historical data from multiple blacklists (B) and updates this dataset whenever a blacklist is updated by its maintainers. When a customer wants to use BLAG, our system uses its historical dataset (B) and a</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">intrusion detection system, a firewall, and a spam filter. These defenses will drop or quarantine some traffic during regular operation. Let us denote the sources of dropped or quarantined traffic as (D) and let (A) represent all sources that have recently sent inbound traffic to the customer. The customer can create (L<i>tr</i>) by starting with a set (A) and removing sources that appear in (D).</p><p style="padding-top: 6pt;padding-left: 20pt;text-indent: 0pt;text-align: left;">BLAG’s operation proceeds in the following steps:</p><ol id="l6"><li data-list-text="(1)"><p class="s7" style="padding-top: 6pt;padding-left: 38pt;text-indent: -17pt;text-align: justify;">Evaluate <a href="#bookmark26" class="s5">the relevance of every address on every blacklist in (B) (Section </a><a href="#bookmark149" class="s5">III-A), taking into account the listing’s age (similar to  </a><span class="p">[78]) and re-offense history. The relevance score is the function of the address’s history on a particular blacklist.</span></p></li><li data-list-text="(2)"><p style="padding-top: 6pt;padding-left: 36pt;text-indent: -16pt;text-align: justify;"><i>Aggregate </i>IP addresses and run the recommendation system using IP addresses in the (L<i>tr</i>) set. The system predicts relevance scores of IP addresses that are not in (L<i>tr</i>) but may be among legitimate sources for the customer network in the future (F <span class="s42">⊂ </span>L<i>te</i>). This step ends with a set of addresses that are likely legitimate and likely to communicate with the customer network in the future (F). BLAG then uses a threshold-based approach to prune out current and likely misclassifications (all addresses from (L<i>tr</i>) and most addresses from (F)) and the remaining IP addresses form the master blacklist <i>candidates</i>.</p></li><li data-list-text="(3)"><p class="s7" style="padding-top: 4pt;padding-left: 36pt;text-indent: -16pt;line-height: 11pt;text-align: justify;">Selectively expand <span class="p">some candidate IP addresses into prefixes to increase malicious source identification. During this</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">sample of the legitimate sources that send inbound traffic to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">the customer network (L<i>tr</i>) to curate a master blacklist tailored</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">expansion we use (L<i>tr</i>) and (F) sets to estimate the likely</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">to that customer.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">BLAG’s goal when producing the master blacklist is to include as much information about malicious sources from (B) as possible while ensuring that very few current (L<i>tr</i>) or future (L<i>te</i>) legitimate sources of the customer get blacklisted. To achieve this, we need a relatively accurate list of legitimate sources that communicate with the customer. One way a customer could build this list would be to leverage its existing, more sophisticated defenses. Many networks today run an</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark30" class="s5">increase in misclassification for each candidate if it were to be expanded into an IP prefix. Our expansion method is selective because it balances the gain in malicious source identification against potential future misclassifications (Section III-C).</a></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l7"><li data-list-text="A."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark21">&zwnj;</a>Relevance Scores: Evaluating Quality<a name="bookmark26">&zwnj;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Historical blacklist data can be a valuable source to detect potential re-offenders. Earlier, we have seen that about 29% of blacklisted IP addresses re-offend and 91% of these reoffenses</p><p class="s7" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark149" class="s5">occur within 30 days. We have also seen that blacklists of different attack types overlap. Existing work also agrees with our findings. PRESTA </a><span class="p">[78], a study on three paid-for blacklists shows that recent offenders are more likely to re-offend. BLAG starts its aggregation by generating a relevance score for each address </span>a <span class="p">listed in blacklist </span>b <span class="s42">∈ </span>B <span class="p">based on the formulation used by PRESTA. BLAG defines relevance score </span>r<span class="s40">a,b</span> <span class="p">as:</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s43" style="text-indent: 0pt;line-height: 6pt;text-align: left;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="padding-left: 137pt;text-indent: 0pt;line-height: 6pt;text-align: left;"/><p class="s45" style="padding-left: 102pt;text-indent: 0pt;text-align: left;"><span class="s7">r</span><span class="s44">a,b </span><span class="p">= 2 </span>t<span class="s46">−</span>t<span class="s47">out             </span><span class="p">(1)</span></p><p class="s7" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">where </span>l <a href="#bookmark62" class="s5">is a constant, which we set empirically (discussed in Section </a><span class="p">VII), </span>t<span class="s40">out</span> <span class="p">is the most recent de-listing (removal) time of </span>a <span class="p">at blacklist </span>b <span class="p">and </span>t <span class="p">is the time in days when the score is calculated. The exponential factor ensures that the score decays exponentially over time, giving higher weight to recently blacklisted IP addresses. The relevance score ranges from 0 to 1, and a higher score indicates a higher chance of reoffense. If the address </span>a <span class="p">is </span>currently <span class="p">listed in </span>b<span class="p">, we set its relevance score to 1.</span></p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="B."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark22">&zwnj;</a>Recommendation System: Estimating Future Misclassifica- tions<a name="bookmark27">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Ideally, if we knew all legitimate IP addresses in the Internet at any given time, or if we knew which currently blacklisted addresses are no longer malicious, we could prune out misclassifications during aggregation. However, it is im- possible to know this information. At best, a customer network has limited visibility into some set of its known-legitimate sources (L<i>tr</i>), which have recently communicated with the customer. We leverage this set to predict IP addresses (F</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 94%;text-align: justify;"><span class="s42">⊂ </span>L<i>te</i>) that may be future legitimate traffic sources for the customer network, and that would be misclassified in BLAG’s aggregation and expansion steps.</p><p class="s7" style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><span class="p">When all the relevance scores are calculated, BLAG places them into a </span>score matrix <a href="#bookmark28" class="s5">where blacklists from (B) are at the columns and all listed IP addresses (in any blacklist) are at the rows as shown in Figure </a><span class="p">4 (see </span>Evaluate <span class="p">step). Each cell in the score matrix holds the relevance score </span>r<span class="s40">a,b</span> <span class="p">for the given row (address </span>a<span class="p">) and given column (blacklist </span>b<a href="#bookmark28" class="s5">). BLAG adds a new, artificial blacklist to this matrix, called the “misclassification blacklist” (MB column in Figure </a><span class="p">4). MB contains all known-legitimate sources from the set (L</span><span class="s40">tr</span><span class="p">). BLAG assigns a relevance score </span>r<span class="s40">a,MB</span> <span class="p">of 1 to all IP addresses </span>a <span class="p">listed in the misclassification blacklist. This high score will help us identify likely future misclassifications (F).</span></p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">The misclassification blacklist column is sparse because many addresses that exist in (B) do not appear in (L<i>tr</i>) and we cannot know if they are legitimate or malicious. BLAG fills the empty cells of the misclassification blacklist column by using a recommendation system.</p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark130" class="s5">Recommendation systems are usually used to predict future product ratings by some users, given a set of past ratings of same or related products, by target users and other similar users. A well-known example is the Netflix recommendation system </a>[59], which may recommend a new movie <i>M </i>to user <i>U </i>by relying on the <i>U </i>’s past ratings of movies similar to <i>M </i>, and on ratings that users similar to <i>U </i>have given to <i>M </i>or movies similar to <i>M </i>. In our context, IP addresses are analogous to movies that are being evaluated, and blacklists are analogous</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">to users assigning the rating. We view the relevance score as the rating.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark140" class="s5">Two most commonly used types of recommendation sys- tems are content-based recommendation system </a><a href="#bookmark143" class="s5">[69] and collaborative filtering </a>[72]. A content-based recommendation system would require an explicit definition of features that a blacklist uses to determine if an IP address should be listed. Such features are hard to obtain since each blacklist maintainer has its private criteria for listing an address. <i>Collaborative filtering </i>infers information about the relationship between a blacklist and an address being listed in a blacklist, by using only the existing relevance scores. That is, it infers the relationship between blacklists and IP addresses, based on when the IP addresses were listed in blacklists and based on similarity in listing dynamics of different blacklists. It then uses the inferred relationships to predict relevance scores for missing cells in the score matrix. We use collaborative filtering in BLAG.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark28" class="s5">Figure </a>4 illustrates the recommendation system’s operation for a customer network. Let <i>M </i>and <i>N </i>represent the set of IP addresses and blacklists, respectively. Let <i>R </i>be a score matrix of size <span class="s42">|</span><i>MxN</i><span class="s42">| </span><a href="#bookmark28" class="s5">which consists of relevance scores quantifying the relevance of an address being listed by a given blacklist. For example, in Figure </a>4, score matrix <i>R </i>consists of four blacklists (<i>M </i>= 4), and five IP addresses (<i>N </i>= 5). Misclassification blacklist, curated from known- legitimate sources (L<i>tr</i>) for the customer network, is added as the last column in the matrix, and in this example, 128.0.0.5 (highlighted in red) is present in (L<i>tr</i>). Blacklisted IP addresses have been present at various times in different blacklists, which is reflected by the relevance score’s value. Address 128.0.0.1 listed in <i>nixspam </i>blacklist has a high score of 0.7 since it was the most recently listed address. Address 128.0.0.2, on the other hand, has a low score of 0.1 in <i>openbl </i>blacklist, since it was listed long ago. Finally, address 128.0.0.5, has a score of zero in <i>nixspam </i>blacklist, where it has never been listed and has a score of 1 in MB since it is known to send legitimate traffic (L<i>tr</i>) to the customer network. There are latent (unknown) features of blacklists and IP addresses that lead to an address being listed in a blacklist. Let the number of latent features that influence relevance scores of IP addresses in blacklists be <i>K </i><a href="#bookmark62" class="s5">(see Section </a>VII for how we choose the value of <i>K</i>). In this example, we set <i>K </i>= 2. Our goal is to estimate the relevance scores of IP addresses that are not present in MB, by estimating two matrices <i>P </i>(<span class="s42">|</span><i>MxK</i><span class="s42">|</span>) and <i>Q</i>(<span class="s42">|</span><i>NxK</i><span class="s42">|</span>), which are factors of the original matrix <i>R</i>, such that their cross product is approximately equal to known values in <i>R</i>. In other words, matrix factorization is used on <i>R </i>to obtain factor matrices <i>P </i>and <i>Q </i>such that:</p><p class="s7" style="padding-top: 5pt;padding-left: 92pt;text-indent: 0pt;text-align: left;">R <span class="s42">≈ </span>P <span class="s42">× </span>Q<span class="s48">T</span> <span class="p">= </span>R<span class="s49">0</span><span class="s50">         </span><span class="p">(2)</span></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">We obtain the values of latent matrices <i>P </i>and <i>Q </i><a href="#bookmark133" class="s5">using gradient descent </a>[62], which randomly assigns values to <i>P </i>and <i>Q </i>and estimates how different the product of <i>P </i>and <i>Q </i>is from the original score matrix <i>R</i><a href="#bookmark62" class="s5">. We use root mean squared error (RMSE) to estimate the difference. Gradient descent tries to minimize RMSE iteratively. We discuss in Section </a>VII the number of iterations required to have a small RMSE. After obtaining matrices <i>P </i>and <i>Q</i>, each row in <i>P </i>represents the association strength between IP addresses and latent features <i>K</i>, and each row in <i>Q </i>represents the association strength</p><p class="s51" style="padding-top: 2pt;padding-left: 82pt;text-indent: 0pt;text-align: left;"><a name="bookmark28">&zwnj;</a>Matrix R             Matrix P            Matrix Q                     Matrix R&#39;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">nixspam</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bambenek_c2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">openbl</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">MB</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">nixspam</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">bambenek_c2</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">openbl</p><p style="text-indent: 0pt;text-align: left;"/><p class="s51" style="text-indent: 0pt;line-height: 5pt;text-align: left;">MB</p><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.7</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.6</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.3</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.2</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">?</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.7</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.4</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">1</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.27</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.12</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.04</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.11</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.11</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.07</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.02</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.21</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.23</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s52" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">128.0.0.1</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.24</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.17</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.08</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.22</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.08</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.17</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.13</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.25</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s52" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">128.0.0.2</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s53" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">M   <i>128.0.0.3                </i><span class="s54">M           </span><span class="s51">K</span></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s52" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">128.0.0.4</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 28pt;text-indent: 0pt;text-align: left;">128.0.0.5                                     <span class="s54">N</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s55" style="padding-left: 89pt;text-indent: 0pt;text-align: left;">N              <span class="s51">K</span></p><h3 style="padding-top: 4pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">128.0.0.1</h3><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.68</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.59</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.29</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.84</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.17</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.08</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.29</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.19</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.1</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.001</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.17</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.09</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.06</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s28" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.12</p></td></tr><tr style="height:15pt"><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.61</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.68</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.39</p></td><td style="width:20pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F7CDCC"><p class="s26" style="padding-top: 4pt;text-indent: 0pt;text-align: center;">0.99</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s52" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">128.0.0.2</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s52" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">128.0.0.3</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s52" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">128.0.0.4</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 9pt;text-indent: 0pt;text-align: left;">128.0.0.5</h3><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s52" style="padding-left: 194pt;text-indent: 0pt;text-align: left;">Likely to be a misclassiﬁcation       Unlikely to be a misclassiﬁcation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s7" style="padding-left: 5pt;text-indent: 0pt;line-height: 94%;text-align: justify;"><span class="p">Figure 4: Latent factorization of the score matrix </span>R<span class="p">, a </span>M <span class="s42">× </span>N <span class="p">matrix, where M is the number of IP addresses and N is the number of blacklists. The cells indicate relevance scores. IP addresses not listed in a blacklist are assigned a zero score and IP addresses listed in </span>misclassification blacklist (MB) <span class="p">are given a score of 1. Score matrix is factorized into two matrices of </span>M <span class="s42">×</span>K <span class="p">and </span>K <span class="s42">× </span>N <span class="p">, and the cross product results in a new matrix </span>R<span class="s49">t</span><span class="p">, which updates the missing scores in </span>MB<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">between blacklists and latent features <i>K</i>. To obtain a relevance score for an address <i>a </i>in misclassification blacklist MB, the dot product of two latent vectors corresponding to address <i>a </i>and MB is calculated as follows:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s57" style="padding-left: 10pt;text-indent: -4pt;text-align: left;"><a name="bookmark29">&zwnj;</a><span class="s56">Known legitimate </span>sources (L<span class="s58">tr</span>)</p><p class="s22" style="padding-top: 2pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">216.59.16.171</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">243.13.0.23</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">243.13.222.203</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-left: 5pt;text-indent: 2pt;text-align: left;">Recommended misclassiﬁcations</p><p class="s22" style="padding-top: 3pt;padding-left: 8pt;text-indent: 0pt;text-align: left;">169.231.140.10</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-left: 5pt;text-indent: 0pt;line-height: 4pt;text-align: left;">Master blacklist Check Check</p><p class="s56" style="padding-left: 10pt;text-indent: 0pt;line-height: 4pt;text-align: left;">candidates  1<span class="s59">  </span>2</p><p class="s22" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">169.231.140.68 OK  !</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">193.1.64.5  <span class="s33">OK  </span>OK</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">193.1.64.8  OK  OK</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s32" style="padding-left: 4pt;text-indent: 1pt;line-height: 108%;text-align: left;">Selective expansion</p><p class="s60" style="text-indent: 0pt;line-height: 7pt;text-align: left;">a</p><p style="text-indent: 0pt;text-align: left;"/><p class="s7" style="padding-left: 103pt;text-indent: 0pt;text-align: left;">r<span class="s61">a,b</span><span class="p"> = </span>p<span class="s48">T</span> q<span class="s40">MB</span>           <span class="p">(3)</span></p><p class="s7" style="padding-top: 10pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><span class="p">Where </span>p<span class="s40">a</span> <span class="p">defines the association strength of address </span>a <span class="p">with features </span>K <span class="p">and </span>q<span class="s40">MB</span> <span class="p">defines the association strength of MB with features </span>K<span class="p">.</span></p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark28" class="s5">Consider IP addresses 128.0.0.1 and 128.0.0.5 in Figure </a>4, where one of them is listed in the MB and the other is not. Both IP addresses have similar relevance scores in other blacklists (with <i>bambenek_c2</i>’s scores of 0.6 and 0.7, and <i>openbl</i>’s scores of 0.3 and 0.4). Intuitively, if 128.0.0.1 were to be legitimate and listed in MB, we can expect it to have a similar relevance score as that of 128.0.0.5 which is already present in MB. The recommendation system captures this pattern and assigns a score of 0.84 to 128.0.0.1. On the other hand, address 128.0.0.4 has no similar listing pattern as that of 128.0.0.5, therefore the recommendation system assigns it a low score of 0.12 in MB. Finally, IP addresses 128.0.0.2 and 128.0.0.3 share some listings with 128.0.0.5. However, their relevance scores are not similar. This regularity is also captured by the recommendation system and assigns a score of 0.29 and 0.17 respectfully in MB. Cells in the score matrix, in the column MB, that was filled by the recommendation system contain the set of potential future sources of legitimate traffic to the customer (F).</p><p class="s7" style="padding-top: 8pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><span class="p">After we have calculated all the missing relevance scores in the misclassification blacklist MB, we proceed to construct the aggregated blacklist known as </span>master blacklist candidates<span class="p">. To generate the candidates, we observe relevance scores in MB and then use a threshold </span>α <span class="p">(choice of </span>α <a href="#bookmark62" class="s5">discussed in Section </a><span class="p">VII) to include all the IP addresses </span>a <span class="p">for which the following holds: </span>r<span class="s40">a,MB</span> <span class="s42">≤ </span>α<span class="p">. Intuitively, IP addresses, which have high scores in MB are either current legitimate sources of customer’s inbound traffic (L</span><span class="s40">tr</span><span class="p">) or likely to be so in the future (F), and the thresholding excludes them from the master blacklist.</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:10pt"><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#F5F5F5"><p class="s62" style="padding-left: 8pt;padding-right: 3pt;text-indent: -4pt;line-height: 4pt;text-align: left;">BLAG master blacklist</p></td></tr><tr style="height:10pt"><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s63" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">169.231.140.68</p></td></tr><tr style="height:10pt"><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s63" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">193.1.64.0/24</p></td></tr><tr style="height:10pt"><td style="width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s63" style="padding-top: 2pt;text-indent: 0pt;text-align: center;">216.59.0.0/24</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 120pt;text-indent: 0pt;text-align: left;">216.59.0.8  OK  OK</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 10pt;text-indent: 0pt;text-align: left;">Figure 5: Selective expansion of IP addresses into prefixes.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="C."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark23">&zwnj;</a>Selective Expansion to Prefixes<a name="bookmark30">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark17" class="s5">We have discussed in Section </a><a href="#bookmark146" class="s5">II-C why it would be useful to identify and expand IP addresses into prefixes. Prior works have expanded IP addresses into prefixes indiscriminately </a><a href="#bookmark126" class="s5">[75], </a><a href="#bookmark148" class="s5">[55], </a>[77] – this improves malicious source identification but greatly increases misclassifications. The novelty of our approach is to <i>selectively </i>expand IP addresses into prefixes, only when this expansion does not greatly increase misclassi- fications. This is particularly useful for customers deploying BLAG under emergency scenarios.</p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark54" class="s5">The expansion phase starts with master blacklist candi- dates, which are all added to the BLAG master blacklist. During expansion, we identify IP addresses, that could be ex- panded into their /24 prefixes (see Section </a>VI for the rationale behind choosing /24 prefix size). We first generate a list of all /24 prefixes from the master blacklist candidates. We then evaluate if each prefix should be added to the master blacklist. Prefixes that contain known legitimate sources (from (L<i>tr</i>)) are excluded (<i>Check 1</i>). Further, prefixes that contain likely misclassifications (IP addresses with high relevance scores in the misclassification blacklist, i.e. set (F)) are excluded (<i>Check 2</i><a href="#bookmark29" class="s5">). Remaining prefixes are added to the BLAG’s master blacklist. In Figure </a>5, none of the IP addresses are present in known-legitimate sources (L<i>tr</i>) and address 169.231.140.68 has another address in the same /24 prefix, which is a likely misclassification (in set (F)). Therefore, 169.231.140.68 is not expanded, and the other IP addresses are expanded to their corresponding prefix to be included in the master blacklist.</p></li><li data-list-text="D."><p class="s7" style="padding-top: 3pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark24">&zwnj;</a>Why BLAG Works</p></li></ol><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">BLAG assigns relevance scores to capture the relevance of IP addresses being listed in a blacklist. BLAG also introduces a new artificial blacklist – misclassification blacklist, which consists of known-legitimate sources (L<i>tr</i><a href="#bookmark57" class="s5">). The recommen- dation system used by BLAG helps during the aggregation phase by pruning out misclassifications, and also during the selective expansion phase by preventing those expansions of IP addresses into prefixes that would increase future mis- classifications. The recommendation system helps BLAG to discover other IP addresses that are predicted to be listed in the misclassification blacklist with a high relevance score. In other words, the recommendation system predicts future misclassifi- cations based on finding IP addresses that exhibit similarities, with regard to the blacklisting process, to known legitimate sources. In Section </a>VI-B, we quantify the contribution of the recommendation system in reducing misclassification during the aggregation and selective expansion phases.</p></li></ol></li><li data-list-text="IV."><p style="padding-top: 11pt;padding-left: 121pt;text-indent: -23pt;text-align: left;"><a name="bookmark31">&zwnj;</a>D<span class="s41">ATASETS</span><a name="bookmark38">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark46" class="s5">BLAG’s fundamental goal is to find a trade-off between identifying as many malicious sources as possible and keeping the misclassifications low. In this section, we look into the blacklists used by BLAG to aggregate information. We also present three BLAG deployment scenarios, which we use in evaluation. These scenarios include real-world legitimate and malicious traffic. We will show the performance of BLAG under these scenarios in Section </a>V, where BLAG achieves more than 95% specificity (5% misclassification rate), while significantly increasing recall (high detection of malicious sources), compared to individual blacklists and their naïve aggregation.</p><ol id="l8"><li data-list-text="A."><p class="s7" style="padding-top: 10pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark32">&zwnj;</a>Blacklist Dataset<a name="bookmark39">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark134" class="s5">We have monitored 157 publicly available blacklists for 11 months, starting from January 2016 to November 2016. Each blacklist is updated at a different frequency by its provider, ranging from 15 minutes to 7 days. We collected the update time of each blacklist manually and programmed our crawler to pull the snapshot of the blacklist when a new update was available. We have collected around 176 million blacklisted IP addresses over 23,483 autonomous systems. Our monitored blacklists vary in size – on one hand, we have large blacklists (15.76%) listing more than 500,000 IP addresses and on the other, we have small blacklists (19.56%), which list fewer than 1,000 IP addresses. We do not delve into details on the various properties of blacklists, such as their volume, contribution, exclusive contribution, detection of malicious activities (refer Vector et al. </a><a href="#bookmark10" class="s5">[63] work on an exhaustive study on properties of blacklists). Our work focuses more on identifying key properties of blacklists that make them ineffective in emer- gency scenarios (refer Section </a><a href="#bookmark25" class="s5">II) and presenting an improved blacklisting technique (refer Section III).</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark42" class="s5">Our blacklist dataset (B) is representative of different attack vectors such as spam, malware, DDoS attacks, ransomware, etc. Table </a><a href="#bookmark128" class="s5">II shows the blacklist maintainers and the number of blacklists maintained by them. Our dataset includes popular blacklists such as DShield </a><a href="#bookmark139" class="s5">[57], Nixspam </a><a href="#bookmark115" class="s5">[68], Spamhaus [44],</a></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><a href="#bookmark74" class="s5">Alienvault </a><a href="#bookmark108" class="s5">[3], Project Honeypot </a><a href="#bookmark118" class="s5">[37], Abuse.ch </a>[47] and</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><a href="#bookmark92" class="s5">Emerging Threats [21].</a></p></li><li data-list-text="B."><p class="s7" style="padding-top: 3pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark33">&zwnj;</a>Scenarios</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark41" class="s5">Table </a>I shows our three scenarios. Each scenario consists of three portions of the same dataset: training, validation and testing. The training portion contains only known-legitimate sources (L<i>tr</i><a href="#bookmark27" class="s5">) and is used to tailor BLAG to the customer network (Section </a>III-B). This portion is collected before the malicious event in each scenario. The validation and testing portions contain both the legitimate (L<i>v</i><i> </i>and L<i>te</i>) and malicious (M<i>v</i><i> </i>and M<i>te</i>) sources. The validation portion is used to calibrate BLAG’s parameters (<i>l</i>, <i>α </i>and <i>K</i><a href="#bookmark40" class="s5">) for testing</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">3</span>. The testing portion is used to evaluate the performance of BLAG and competing blacklisting approaches.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a name="bookmark34">&zwnj;</a>Our three scenarios contain sources of diverse attacks: spam, DDoS on a University network or DDoS on DNS root. This allows us to test how well BLAG could prevent these attacks if used by a customer network to filter attack traffic.</p><ol id="l9"><li data-list-text="1)"><p style="padding-top: 6pt;padding-left: 31pt;text-indent: -10pt;text-align: justify;"><i><b>Malicious Email Campaign or Spam</b></i><i>: </i>In this scenario (referred to as <b>Email</b><a href="#bookmark100" class="s5">), we look into a case where a University network is bombarded with spam emails. We collect malicious and legitimate IP addresses during the same time period of June 2016. Simultaneous collection is important, because an address may be malicious at one time, and cleaned afterward. We collect malicious IP addresses from Mailinator </a><a href="#bookmark135" class="s5">[29], a service, which allows users to redirect unwanted e-mails to a public-inbox. We filter e-mails from these public inboxes during June 2016, using SpamAsssassin </a>[64] to obtain around</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark114" class="s5" name="bookmark35">2.3 M spam e-mails, sent by around 39 K IP addresses. These IP addresses form our malicious dataset. We trained SpamAssassin using SpamAssasin’s public corpus </a><a href="#bookmark120" class="s5">[43] and spam archives from Untroubled </a>[49], to ensure we capture only malicious spam emails. We use the first 7 days consisting of 13 K IP addresses as a validation set (<i>M</i><i>v</i>) and the remaining 16 days consisting of 26 K IP addresses for testing (<i>M</i><i>te</i>). We collect legitimate IP addresses through a human user study. This study was reviewed and approved by our IRB. We recruited 37 volunteers from our University, who allowed us automated access to their Gmail inbox, during June 2016. We scanned each participant’s Gmail account using a plugin, which we developed. Our plugin used the OAuth2 protocol to access Gmail, and it used regular expressions to extract a sender’s IP address, time and label for each e-mail. We did not extract any other information and did not record the identity of the study participants, to protect privacy. The label in Gmail can be assigned by a user or by GMail, and it is usually “spam”, “inbox” or a user-defined label like “conference”. We harvested information only from e-mails that have labels other than “spam”. Our scanning generates as output a list of {sender IP address, time} tuples, which we save. We extracted around 30 K e-mail records, sent by around 9 K IP addresses. We use the first seven days of this dataset consisting of 3 K IP addresses for training (the known-legitimate sources set (L<i>tr</i>)), the next 7 days consisting of 2 K IP addresses for validation (L<i>v</i>) and the remaining 16 days consisting of 4 K IP addresses for testing (L<i>te</i>).</p></li><li data-list-text="2)"><p style="padding-top: 7pt;padding-left: 31pt;text-indent: -10pt;text-align: justify;"><i><b>DDoS on a University network</b></i><i>: </i>In this scenario (re- ferred to as <b>DDoS</b><b>Univ</b>), we look into a case where web- servers at a University could be targeted by Mirai-infected</p><p class="s11" style="padding-top: 9pt;padding-left: 5pt;text-indent: 7pt;text-align: left;"><a name="bookmark40">&zwnj;</a><span class="s10">3</span>We do not have a validation dataset for DDoS<span class="s66">DNS</span><a href="#bookmark62" class="s18">. Refer Section </a>VII for further explanation</p><table style="border-collapse:collapse;margin-left:92.045pt" cellspacing="0"><tr style="height:8pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s67" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;"><a name="bookmark41">&zwnj;</a>Scenario</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s67" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Duration</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s67" style="padding-top: 2pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">Source</p></td><td style="width:70pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="2"><p class="s68" style="padding-left: 12pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Training (L<span class="s69">tr </span>)</p></td><td style="width:74pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="2"><p class="s68" style="padding-left: 6pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Validation (L<span class="s69">v </span>+M<span class="s69">v </span>)</p></td><td style="width:74pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="2"><p class="s68" style="padding-left: 8pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Testing (L<span class="s69">te</span>+M<span class="s69">te</span>)</p></td></tr><tr style="height:8pt"><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Days</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">IPs</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Days</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">IPs</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">Days</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 6pt;text-align: center;">IPs</p></td></tr><tr style="height:8pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s70" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Email</p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s70" style="padding-left: 9pt;text-indent: 0pt;line-height: 7pt;text-align: left;">6/1/16-</p><p class="s70" style="padding-left: 9pt;text-indent: 0pt;line-height: 8pt;text-align: left;">6/30/16</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M:Mailinator</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">7</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M<span class="s69">v </span>: 13 K</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">16</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M<span class="s69">te</span>:26 K</p></td></tr><tr style="height:8pt"><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L: Ham</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">7</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">tr </span>: 3 K</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">7</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">v </span>: 2 K</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">16</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">te</span>: 4 K</p></td></tr><tr style="height:8pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s71" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">DDoS<span class="s72">Univ</span></p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s70" style="padding-left: 9pt;text-indent: 0pt;line-height: 7pt;text-align: left;">9/1/16-</p><p class="s70" style="padding-left: 9pt;text-indent: 0pt;line-height: 8pt;text-align: left;">9/30/16</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M:Mirai</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">7</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M<span class="s69">v </span>: 1.1 M</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">16</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M<span class="s69">te</span>: 2.8 M</p></td></tr><tr style="height:8pt"><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L: Web cl.</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">7</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">tr </span>: 16K</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">7</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">v </span>: 12 K</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">16</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">te</span>: 33 K</p></td></tr><tr style="height:8pt"><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s71" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">DDoS<span class="s72">DNS</span></p></td><td style="width:40pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s70" style="padding-left: 7pt;text-indent: 0pt;line-height: 7pt;text-align: left;">6/24/16-</p><p class="s70" style="padding-left: 9pt;text-indent: 0pt;line-height: 8pt;text-align: left;">6/25/16</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M:DDoS</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">-</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">1</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 7pt;text-align: center;">M<span class="s69">te</span>: 5.5 M</p></td></tr><tr style="height:8pt"><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L: DNS cl.</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">1</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">tr </span>: 2.7M</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">-</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">-</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 6pt;text-align: center;">1</p></td><td style="width:47pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s71" style="text-indent: 0pt;line-height: 6pt;text-align: center;">L<span class="s69">te</span>: 16 K</p></td></tr></table><p class="s75" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;line-height: 93%;text-align: justify;"><span class="p">Table I: </span><span class="s73">Scenario datasets used in this study. Each scenario dataset is split into three – training, validation and testing. The training dataset is </span><span class="s74">collected chronologically before the validation and testing, and contains only legitimate sources (L</span>tr <span class="s76">). The validation and testing datasets are collected during malicious events and contain malicious (M</span>v <span class="s76">and M</span>tr <span class="s76">) and legitimate (L</span>v <span class="s76">and L</span>tr <span class="s76">) sources. The validation dataset is used to </span><span class="s77">tune the appropriate parameters used in BLAG.</span></p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:8.711pt" cellspacing="0"><tr style="height:10pt"><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 7pt;text-align: center;"><a name="bookmark42">&zwnj;</a>Type</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 7pt;text-align: center;">#</p></td><td style="width:452pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s67" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Blacklist Maintainers</p></td></tr><tr style="height:16pt"><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Malware</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">57</p></td><td style="width:452pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;line-height: 7pt;text-align: center;"><a href="#bookmark92" class="s78">Emerging threats </a><a href="#bookmark96" class="s78">[21], Malware Bytes </a><a href="#bookmark88" class="s78">[25], CyberCrime </a><a href="#bookmark121" class="s78">[17], URLVir </a><a href="#bookmark118" class="s78">[50], Swiss security blog </a><a href="#bookmark77" class="s78">[47], Bambenek </a><a href="#bookmark105" class="s78">[6], NoThink </a><a href="#bookmark97" class="s78">[34], I-Blocklist [26],</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="#bookmark106" class="s78">NoVirusThanks </a><a href="#bookmark91" class="s78">[35], DYN </a><a href="#bookmark101" class="s78">[20], Malc0de </a><a href="#bookmark102" class="s78">[30], Malware domain list </a><a href="#bookmark80" class="s78">[31], Botscout </a><a href="#bookmark98" class="s78">[9], ImproWare [27]</a></p></td></tr><tr style="height:16pt"><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Reputation</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">32</p></td><td style="width:452pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;line-height: 7pt;text-align: center;"><a href="#bookmark92" class="s78">Emerging threats </a><a href="#bookmark94" class="s78">[21], Graphiclineweb </a><a href="#bookmark74" class="s78">[23], Alienvault </a><a href="#bookmark78" class="s78">[3], Binary Defense Systems </a><a href="#bookmark82" class="s78">[7], CINSscore </a><a href="#bookmark118" class="s78">[11], Swiss Security Blog </a><a href="#bookmark79" class="s78">[47], Blocklist.de [8],</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="#bookmark97" class="s78">I-Blocklist </a><a href="#bookmark83" class="s78">[26], Cisco Talos </a><a href="#bookmark76" class="s78">[12], Bad IPs </a><a href="#bookmark93" class="s78">[5], Blocklist Project </a><a href="#bookmark123" class="s78">[22], VXVault </a><a href="#bookmark112" class="s78">[52], ShunList </a><a href="#bookmark95" class="s78">[41], GreenSnow [24]</a></p></td></tr><tr style="height:16pt"><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Spam</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">39</p></td><td style="width:452pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;line-height: 7pt;text-align: center;"><a href="#bookmark115" class="s78">Spamhaus drop and edrop </a><a href="#bookmark117" class="s78">[44], Stop Forum Spam </a><a href="#bookmark75" class="s78">[46], Chaosreigns </a><a href="#bookmark99" class="s78">[4], Lashback </a><a href="#bookmark139" class="s78">[28], Nixspam </a><a href="#bookmark108" class="s78">[68], Project Honeypot </a><a href="#bookmark111" class="s78">[37], Sblam! </a><a href="#bookmark109" class="s78">[40], Turris [38],</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="#bookmark98" class="s78">ImproWare </a><a href="#bookmark96" class="s78">[27], Malware bytes </a><a href="#bookmark85" class="s78">[25], Cleantalk </a><a href="#bookmark104" class="s78">[14], My IP </a><a href="#bookmark76" class="s78">[33], BadIPs [5]</a></p></td></tr><tr style="height:16pt"><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">Attacks</p></td><td style="width:19pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s70" style="text-indent: 0pt;line-height: 7pt;text-align: center;">29</p></td><td style="width:452pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;line-height: 7pt;text-align: center;"><a href="#bookmark97" class="s78">I-Blocklist </a><a href="#bookmark96" class="s78">[26], Malware Bytes </a><a href="#bookmark113" class="s78">[25], Snort Labs </a><a href="#bookmark119" class="s78">[42], TrustedSec </a><a href="#bookmark81" class="s78">[48], Haley </a><a href="#bookmark90" class="s78">[10], Darklist </a><a href="#bookmark116" class="s78">[19], SIP blacklist </a><a href="#bookmark122" class="s78">[45], VoIPBL </a><a href="#bookmark128" class="s78">[51], DShield [57],</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="#bookmark105" class="s78">NoThink </a><a href="#bookmark107" class="s78">[34], OpenBL </a><a href="#bookmark87" class="s78">[36], Cruzit </a><a href="#bookmark89" class="s78">[16], BruteforceBlocker </a><a href="#bookmark84" class="s78">[18], Clean MX </a><a href="#bookmark76" class="s78">[13], Bad IPs </a><a href="#bookmark103" class="s78">[5], MaxMind [32]</a></p></td></tr></table><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;line-height: 94%;text-align: justify;">Table II: <span class="s73">Four types of blacklists, roughly categorized by the type of malicious activities they capture. Each row gives the number of blacklists and blacklist maintainers for that type.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark73" class="s5">hosts. The legitimate and malicious IP addresses are collected during September 2016. We collect malicious IP addresses from Netlab’s </a>[2] collection of Mirai-infected hosts during September 2016. There were around 3.9 M addresses, which form our malicious set. We use the first 7 days consisting of</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark36">&zwnj;</a>1.1 M IP addresses as a validation set (<i>M</i><i>v</i>) and the remaining 16 days consisting of 2.8 M IP addresses for testing (<i>M</i><i>te</i>). We collect legitimate IP addresses by identifying Web clients who communicated with a set of popular web servers at a mid-size US University in September 2016. We included only those TCP connections which exchanged payload with the server (thus excluding scans). This resulted in around 61 K legitimate IP addresses. We use the first 7 days consisting of 16 K IP addresses as the known-legitimate sources (L<i>tr</i>), the next 7 days consisting of 12 K IP addresses for validation (L<i>v</i>) and the remaining 16 days consisting of 33 K IP addresses as the future legitimate sources (L<i>te</i>).</p></li><li data-list-text="3)"><p style="padding-top: 5pt;padding-left: 31pt;text-indent: -10pt;text-align: justify;"><i><b>DDoS on DNS root</b></i><i>: </i>In this scenario (referred to as <b>DDoS</b><b>DNS</b><a href="#bookmark129" class="s5">), we look into a case of TCP SYN flood attack on the DNS B-root server </a>[58]. We communicated with the dataset provider to obtain non-anonymized sources of this attack, as well as non-anonymized data before the attack, which we use for training. We mine the malicious IP addresses (<i>M</i><i>te</i>) as those that have sent TCP SYN flood to the server for two hours on June 25, 2016. There are 5.5 M malicious IP addresses. We mine the known-legitimate sources (L<i>tr</i>) as sources of DNS queries 1-day before the attack event (2.7 M IP addresses), and the future legitimate sources (L<i>te</i>) as sources of DNS queries during the attack event (16 K IP addresses).</p></li></ol></li><li data-list-text="C."><p class="s7" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark37">&zwnj;</a>Limitations</p></li></ol><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark149" class="s5">The blacklist dataset contains only publicly available bla- cklists, while many providers also offer for-pay blacklists that are usually larger and more accurate </a><a href="#bookmark46" class="s5">[78] (see Section </a>V for the performance of our monitored blacklists). We chose to use only publicly available blacklists because: (1) these blacklists are widely used and we wanted to evaluate BLAG’s benefits</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark127" class="s5">for a customer network that deploys such blacklists. A recent survey shows that nearly 60% of surveyed network operators use blacklists including publicly available ones </a>[56]. We also believe that BLAG’s benefits would carry over to for-pay datasets because its mechanism is generic. (2) we wanted our work to be repeatable, and using public blacklists enables us to freely share our data. We plan to share the blacklist dataset and BLAG code, which could be used by any customer network to improve blacklisting.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark151" class="s5">Our scenario datasets suffer from several limitations. First, they only capture a small sample of legitimate/malicious IP addresses that were active on the Internet at a given point in time, and for a given legitimate or malicious purpose. Many other IP addresses could be legitimate or malicious at the same time, and we have no ground truth for these. We also rely on other security technologies (SpamAssassin) that may also be used by blacklist maintainers to blacklist an address. These limitations are present in other published works </a><a href="#bookmark141" class="s5">[80], </a><a href="#bookmark146" class="s5">[70], </a><a href="#bookmark149" class="s5">[75], </a><a href="#bookmark126" class="s5">[78], </a><a href="#bookmark110" class="s5">[55], which use similarly-sized malicious and legitimate datasets, and rely on other security technologies such as Proofpoint </a><a href="#bookmark134" class="s5">[39] and SpamAssassin, as we do, to establish maliciousness at a given time. A more recent study on Blacklisting has used Alexa’s top 10,000 list to evaluate the accuracy of blacklists based on IP addresses that are present in them </a><a href="#bookmark144" class="s5">[63] but Alexa’s rankings are also not ideal measure of legitimacy </a><a href="#bookmark132" class="s5">[73], </a>[61]. These limitations cannot be avoided, as there is no complete, 100% accurate list of legitimate and malicious IP addresses on the Internet nor in any specific network, at any given point in time.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Second, our datasets are dated – captured in 2016. Ideally, we would use more recent datasets. But, it is very hard to find data about attack events and legitimate traffic, which includes non-anonymized IP addresses. It is even harder to find such data streams that are collected simultaneously and that relate to the same type of sources (e.g., sources of legitimate email vs sources of spam). While dated, our scenarios faithfully capture sources of legitimate and malicious traffic at the same time.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">When working with each scenario <i>BLAG only uses blacklist data up to that point in time</i>. Thus we faithfully simulate what BLAG’s performance would have been if it were deployed by a customer network at the time.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Finally, we do not have a validation dataset for the <i>DDoS</i><i>DNS</i>, because the attack on B-Root DNS server was observed only for a few hours. From evaluation of our pa- rameter values on Email and DDoS<span class="s61">Univ</span><a href="#bookmark62" class="s5"> datasets (Section </a>VII) we observe that parameters <i>l </i>(historical decay) and <i>K </i>(matrix factorization) do not change with the dataset, and high values of parameter <i>α </i>(threshold for candidate IP addresses) lead to higher specificity. Therefore, to evaluate the performance of BLAG for DDoS<span class="s61">DNS</span> scenario, we use the same <i>l </i>and <i>K </i>parameters as that of Email and DDoS<span class="s61">Univ</span> scenarios and set a high value for <i>α</i>.</p></li><li data-list-text="V."><p style="padding-top: 10pt;padding-left: 112pt;text-indent: -17pt;text-align: left;"><a name="bookmark43">&zwnj;</a>Evaluation<a name="bookmark46">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark38" class="s5">In this section, we evaluate the performance of BLAG and several competing approaches, for different deployment sce- narios, described in Section </a>IV. We find that BLAG achieves high specificity (95–99%), and has much better recall (3.5x– 114x improvement) than competing approaches. BLAG also detects attackers 13.7 days faster than competing approaches.</p><ol id="l10"><li data-list-text="A."><p class="s7" style="padding-top: 10pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark44">&zwnj;</a>Evaluation Setup</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">We measure performance of blacklists using <i>recall </i>and <i>spe- cificity</i>. Recall measures the percentage of malicious sources (out of some ground-truth set) that were blacklisted. Specificity measures the percentage of legitimate sources (out of some ground-truth set) that were not blacklisted. Higher values for both measures denote better, more accurate, blacklists.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">In this section, we compare several competing blacklisting approaches against BLAG. In all cases when we evaluate a blacklisting approach we “travel back in time” to the time just before the testing portion of our given Scenario. We then use past data from our (B) dataset up to the time when the testing portion starts, and refresh it as blacklists update during the testing. For example, imagine if our scenario contained two days Sep 1st, 2016 and Sep 2nd, 2016, with Sep 1st used for training and Sep 2nd for testing. Our blacklist dataset (B) overlaps this period going from Jan 8th, 2016 to Nov 30th, 2016. When we test a blacklisting approach for the given scenario we would start by including all data from (B) from Jan 8th up to, and including Sep 1st. We would then start our evaluation and keep updating the blacklist on Sep 2nd. This way we faithfully simulate the performance a given approach would have if we were to travel back in time to Sep 2nd.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">We compare the performance of the following approaches against BLAG:</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><i><b>Best  </b></i>– the blacklist from Blacklist dataset that performs the best on a given scenario with regard to recall. <i>Best </i>is a hypothetical scenario, because in real deployment we could not tell which blacklist will eventually be the best. It allows us to measure the benefits of aggregation over the use of a single blacklist.</p><p class="s64" style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Historical  <span class="p">– all IP addresses listed in any blacklist in the Blacklist dataset. This approach assumes “once malicious, always malicious” and performs naïve aggregation.</span></p><p class="s64" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">PRESTA+L <a href="#bookmark149" class="s5">– the blacklist generated using techniques descri- bed in </a><span class="p">[78]. PRESTA performs spatio-temporal analysis and expansion using historical blacklist data to generate a more proactive blacklist. PRESTA assigns a reputation score to all blacklisted IP addresses across three different spatial groups (IP address, address’s /24 prefixes along with two surrounding</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">/24 prefixes and address’s corresponding autonomous systems). PRESTA combines all the spatial grouping into one and chooses relevant listings using a thresholding technique. We tune PRESTA such that the BLAG’s recall is equivalent to that of PRESTA for a deployment scenario, and then we compare the specificity of these two approaches. Further, to tease apart the factors that help us outperform PRESTA, we consider a variant approach, called <i>PRESTA+L</i>, where we remove addresses that are already present in known-legitimate sources (L<i>tr</i>) from every dataset.</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><i><b>BLAG with and without selective expansion: </b></i><a href="#bookmark25" class="s5">We run BLAG as described in Section </a>III. We set the length of address history <i>l </i>= 30 and the number of latent features for recommendation system <i>K </i>= 5. We set relevance threshold <i>α </i>= 0<i>.</i>8 for Email/DDos<span class="s61">DNS</span> datasets and <i>α </i>= 0<i>.</i>6 for DDoS<span class="s61">Univ</span><a href="#bookmark62" class="s5"> dataset. Our choices for these variables are explained in Section </a>VII. We compare the performance of BLAG with and without the selective expansion, to show the contributions of aggregation and expansion stages of BLAG.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">During the evaluation, for our testing dataset and each blacklisting approach (best, historical, PRESTA+L or BLAG) we simulate the dynamics of address appearance over time in the following manner. When an address appears in the blacklist dataset (B) we: (1) include the address in the best blacklist if it appeared on a blacklist, which will ultimately perform the best on the given BLAG deployment scenario,</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">(2) include the address in the historical blacklist, (3) apply PRESTA+L algorithm on the address and all its spatial groups to determine if it is included in the PRESTA+L blacklist,</p><ol id="l11"><li data-list-text="(4)"><p style="padding-left: 21pt;text-indent: -15pt;text-align: justify;">apply BLAG on the address to determine if it should be included in the BLAG’s aggregated master blacklist and if it should be expanded into its /24 prefix. We report recall and specificity at the end of the testing datasets.</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="B."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: justify;"><a name="bookmark45">&zwnj;</a>BLAG is More Accurate</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">BLAG’s goal is to capture as many malicious sources as possible while keeping the specificity high.</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>BLAG has the best specificity/recall tradeoff across the three scenarios:  </b><a href="#bookmark47" class="s5">Figure </a>6 shows that BLAG overall has the best performance. For the Email scenario, the best blacklist has higher specificity (100%) than BLAG (95%). However, BLAG improves the best blacklist’s recall from 4.7% to 69.7%. Historical blacklist has a recall of 19.4%, which is better than the best blacklist but not better than BLAG. Naïve aggregation of IP addresses in historical blacklist lowers its specificity to 89% which is much lower than that of BLAG (95%). For the same recall, BLAG has 11.5% better specificity than PRESTA+L. We observe similar pattern with DDoS<span class="s61">Univ</span> and DDoS<span class="s61">DNS</span><a href="#bookmark57" class="s5"> scenarios. BLAG’s recall ranges between 6.4–56.1% when compared to 0.004-0.4% for best blacklist and 1.8– 9.5% for historical blacklists. For the same recall, BLAG’s specificity ranges from 97.9–99.5% when compared to 53.1– 84.8% of PRESTA+L. We detail in Section </a>VI-B how the</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;"><a name="bookmark47">&zwnj;</a>100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">80                          80                          80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60                          60                          60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40                          40                          40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20                          20                          20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s81" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p class="s79" style="padding-top: 1pt;padding-left: 12pt;text-indent: 0pt;text-align: left;">Recall   Max recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s81" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p class="s79" style="padding-top: 1pt;padding-left: 12pt;text-indent: 0pt;text-align: left;">Recall   Max recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s81" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p class="s79" style="padding-top: 1pt;padding-left: 12pt;text-indent: 0pt;text-align: left;">Recall   Max recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">80                          80                          80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60                          60                          60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40                          40                          40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20                          20                          20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 47pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0</p><p class="s81" style="padding-left: 69pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l12"><li data-list-text="(a)"><p class="s8" style="padding-left: 105pt;text-indent: -12pt;text-align: left;">Email</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 40pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0</p><p class="s81" style="padding-left: 62pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="(b)"><p class="s8" style="padding-left: 91pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">Univ</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 40pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0</p><p class="s81" style="padding-left: 62pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Best  Historical PRESTA+L BLAG No Exp BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="(c)"><p class="s8" style="padding-left: 90pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">DNS</span></p></li></ol></li></ol><p style="padding-top: 10pt;padding-left: 46pt;text-indent: 0pt;text-align: center;">Figure 6: Specificity and recall of BLAG with two competing approaches on traffic datasets.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s83" style="padding-top: 6pt;padding-left: 44pt;text-indent: 0pt;text-align: left;"><a name="bookmark48">&zwnj;</a>20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 1pt;text-indent: 0pt;line-height: 7pt;text-align: left;">% of BLAG IPs</p><p style="text-indent: 0pt;text-align: left;"/><p class="s83" style="padding-left: 44pt;text-indent: 0pt;text-align: left;">15</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s83" style="padding-left: 44pt;text-indent: 0pt;text-align: left;">10</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s83" style="padding-left: 47pt;text-indent: 0pt;text-align: left;">5</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s83" style="padding-left: 47pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0</p><p class="s83" style="padding-left: 66pt;text-indent: 0pt;line-height: 6pt;text-align: left;">5  10  15  20  25  30</p><p class="s23" style="padding-top: 1pt;padding-left: 94pt;text-indent: 0pt;text-align: left;">days</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 8pt;text-indent: 22pt;line-height: 76%;text-align: right;">Email best DDoS<span class="s84">Univ </span>best DDoS<span class="s84">DNS </span>best Email historical DDoS<span class="s84">Univ </span>historical DDoS<span class="s84">DNS </span>historical Email PRESTA DDoS<span class="s84">Univ </span>PRESTA DDoS<span class="s84">DNS </span>PRESTA</p><h1 style="padding-top: 5pt;padding-left: 44pt;text-indent: 0pt;text-align: justify;">BLAG lists malicious sources faster.  <a href="#bookmark48" class="s5">We show in Figure </a><span class="p">7 the number of days taken by other competing approaches to list malicious IP addresses after BLAG discovers them. We track competing approaches for up to 30 days. On average across all scenarios, BLAG reports malicious sources 9.4 days faster than the best blacklist, 10.3–16.1 days faster than historical blacklists and 8.8–13.4 days faster than PRESTA+L. BLAG’s aggregation helps in detecting attackers faster than the best blacklist and BLAG’s selective expansion helps in detecting attackers faster than the historical blacklist. After</span></h1><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Figure 7: Delay in reporting malicious IP addresses reported by BLAG.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">contribution of recommendation systems in BLAG helps it achieve better specificity that PRESTA+L.</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>BLAG filters more attack traffic. </b>Some IP addresses may generate more attacks than others. We evaluate the amount of malicious activity that would be filtered by BLAG, best and historical blacklists for our three scenarios. In the Email scenario, BLAG would filter 69.7% of spam, compared to 4.7% and 19.4% filtered by best and historical blacklists respectively. In the DDoS<span class="s61">Univ</span> scenario, BLAG would filter traffic from 56.1% of infected devices, compared to only 0.4% and 9.5% filtered by best and historical blacklists. In the DDoS<span class="s61">DNS</span> scenario, BLAG would drop 6.4% of attack queries, compared to 0.004% and 0.1% filtered by best and historical blacklists.</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark47" class="s5">We pause here to address the low performance of public blacklists in general for offender identification. While BLAG greatly improves performance, it can only work with what it has – existing public blacklist data. For all malicious datasets, blacklists cover addresses in only 10.7–71.7% of /24 address spaces and BLAG’s recall cannot go beyond this (shown by the red horizontal line in Figure </a><a href="#bookmark149" class="s5">6). Overall BLAG manages to identify 6.4–69.7% of attackers and drop similar amounts of attack traffic. While this is far from perfect, dropping more than half of the attack traffic may be very helpful in emergency scenarios. If BLAG were used to aggregate for-pay blacklists, which list many more malicious sources </a>[78], its attacker coverage would likely be better. We emphasize, however, that BLAG manages to greatly improve the performance of public blacklists while limiting collateral damage to legitimate traffic.</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">30 days, the best blacklist catches up to 2.1% of malicious IP addresses discovered by BLAG for the Email scenario and does not report any malicious address for DDoS<span class="s61">Univ</span> and DDoS<span class="s61">DNS</span> scenarios. On the other hand, historical blacklists catch up to 0.2–4.1% and PRESTA+L catch up to 0.14–0.23% of malicious IP addresses discovered by BLAG.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="VI."><p style="padding-left: 91pt;text-indent: -22pt;text-align: left;"><a name="bookmark49">&zwnj;</a>Sensitivity Analysis<a name="bookmark54">&zwnj;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">In this section, we discuss the contribution of BLAG’s expansion phase. We then look into the contribution of BLAG’s recommendation system in pruning misclassifications for the aggregation and expansion phase.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l13"><li data-list-text="A."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark50">&zwnj;</a>Expansion approaches</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>BLAG’s performance comes both from aggregation and expansion. </b>We investigate how much of BLAG’s performance comes from its selection of high-quality data to aggregate and how much comes from expansion, by showing BLAG with and without expansion (<i>BLAG </i>and <i>BLAG No Exp </i><a href="#bookmark47" class="s5">in Figure </a>6). Without expansion, for the Email scenario, BLAG’s recall is 19.3% and its specificity is 98.7%, while the best blacklist has 8.9% recall and 100% specificity. BLAG is thus still better than the best blacklist, even without expansion. The historical blacklist has 19.4% recall (vs 19.3% of BLAG without expansion), but it has 89% specificity (vs 98.7% of BLAG). Finally, PRESTA+L has 68% recall (vs 19.3% of BLAG without expansion), but it has much lower specificity (84.8% vs 98.7%). This is expected since PRESTA+L applies expansion and we compare it to BLAG without expansion. Expansion of BLAG improves recall further (to 69.7%), at a small loss of specificity (95% specificity of BLAG with</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;"><a name="bookmark55">&zwnj;</a>100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">80                          80                          80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60                          60                          60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40                          40                          40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Best   Historical   BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Best   Historical   BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Best   Historical   BLAG</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">80                          80                          80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60                          60                          60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40                          40                          40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 47pt;text-indent: 0pt;text-align: left;">0     <span class="s79">Best   Historical   BLAG</span></p><ol id="l14"><li data-list-text="(a)"><p class="s8" style="padding-top: 3pt;padding-left: 105pt;text-indent: -12pt;text-align: left;">Email</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 47pt;text-indent: 0pt;text-align: left;">0     <span class="s79">Best   Historical   BLAG</span></p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 3pt;padding-left: 98pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">Univ</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 47pt;text-indent: 0pt;text-align: left;">0     <span class="s79">Best   Historical   BLAG</span></p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 3pt;padding-left: 98pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">DNS</span></p><p style="padding-top: 10pt;padding-left: 46pt;text-indent: 0pt;text-align: center;">Figure 8: Specificity and recall of BLAG and four competing approaches with expansion.</p><p style="padding-top: 10pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;"><a name="bookmark56">&zwnj;</a>100</p><p class="s79" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">80                         80                         80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">60                         60                         60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">40                         40                         40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">ASN    BGP    /24</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">ASN    BGP    /24</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Recall</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">ASN    BGP    /24</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">80                         80                         80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">60                         60                         60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 52pt;text-indent: 0pt;text-align: left;">40                         40                         40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 33pt;text-indent: 0pt;text-align: center;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 55pt;text-indent: 0pt;text-align: left;">0     <span class="s79">ASN    BGP /24</span></p><ol id="l15"><li data-list-text="(a)"><p class="s8" style="padding-top: 3pt;padding-left: 110pt;text-indent: -12pt;text-align: left;">Email</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">0     <span class="s79">ASN    BGP /24</span></p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 3pt;padding-left: 99pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">Univ</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s85" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">0     <span class="s79">ASN    BGP    /24</span></p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 3pt;padding-left: 98pt;text-indent: -12pt;text-align: left;">DDoS<span class="s82">DNS</span></p></li></ol></li></ol><p style="padding-top: 10pt;padding-left: 46pt;text-indent: 0pt;text-align: center;">Figure 9: Evaluating BGP and AS expansion techniques.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">expansion vs 84.8% of PRESTA+L), making BLAG the best performing approach, among the ones we tested. Similar trends hold for other scenarios we tested.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>BLAG outperforms best-expanded and historical-expanded blacklists. </b>We investigate if a similar expansion approach to BLAG’s could improve the performance of the best blacklist and the historical blacklist. Instead of selective expansion here, which uses BLAG’s information, we use naïve expansion, where each candidate address is expanded into its /24 prefix if there are no overlaps with the known-legitimate source (T<i>tr</i><a href="#bookmark55" class="s5">) dataset. Figure </a>8 shows that BLAG still outperforms competing approaches, due to its selection of only high-quality information to aggregate, before expansion. For the Email sce- nario, the best blacklist with expansion has 99.8% specificity vs 95% of BLAG. But, BLAG has 69.7% recall, while the best blacklist with expansion has only 14.4%. The historical blacklist with expansion has a comparable recall to that of BLAG (69.7% vs 70.4% respectively). However, BLAG has 95% specificity while the historical blacklist with expansion has 83.8%. We observe similar trends in the DDoS<span class="s61">Univ</span> and DDoS<span class="s61">DNS</span> scenarios. In the DDoS<span class="s61">DNS</span> scenario, the historical blacklist with expansion achieves 98.9% specificity (vs 99.5% of BLAG) and 7.9% recall (vs 6.4% of BLAG) so they perform roughly equal.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>BLAG’s expansion approach using BGP prefix and AS level. </b><a href="#bookmark146" class="s5">We investigate how BLAG’s performance would change if we expanded IP addresses into their full BGP prefixes or entire autonomous systems, as suggested in </a><a href="#bookmark56" class="s5">[75]. Expanding some IP addresses into large prefixes is not advisable, as this can potentially have large collateral damage, but we investigate it as a hypothetical scenario. We apply /24-prefix, BGP-prefix and AS-level aggregation to the master blacklist candidates, produced by BLAG for the three datasets. We then apply the selective expansion technique, but instead of using /24 prefix in deciding whether to expand, use the encompassing BGP prefix and the entire AS. We show the specificity and recall of BLAG with these expansion approaches in Figure </a>9. Overall, expanding IP addresses to AS or BGP prefix has a higher recall than /24 expansion (7.9–23.4% higher). However, specificity varies across different deployment scenarios. For the Email scenario, /24 expansion has a little better specificity than AS and BGP prefix expansion (2.5–3.7% better). For the DDoS<span class="s61">Univ</span> scenario, /24 expansion has better specificity than AS and BGP prefix hijacking (3.4–17.4%). For the DNS scenario, specificity is about the same across the three expansion approaches.</p></li><li data-list-text="B."><p class="s7" style="padding-top: 11pt;padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark51">&zwnj;</a>Contribution of recommendation system<a name="bookmark57">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: left;"><a href="#bookmark58" class="s5">Figure </a>10(a) shows the contribution of the recommendation system in the aggregation and selective expansion phase over</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;"><a name="bookmark58">&zwnj;</a>100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">80</p><p class="s79" style="padding-top: 2pt;padding-left: 2pt;text-indent: 6pt;line-height: 136%;text-align: left;">Naive aggregation    BLAG aggregation Aggregation</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">80</p><p class="s79" style="padding-top: 2pt;padding-left: 2pt;text-indent: 6pt;line-height: 136%;text-align: left;">Naive aggregation    BLAG aggregation Aggregation</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">specifcity (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s20" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">recall (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60                         60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 47pt;text-indent: 0pt;text-align: left;"><span class="s85">0    </span>Email   DDoS<span class="s86">Univ  </span>DDoS<span class="s86">DNS</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;"><span class="s85">0    </span>Email   DDoS<span class="s86">Univ  </span>DDoS<span class="s86">DNS</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s87" style="text-indent: 0pt;text-align: right;">100</p><p class="s87" style="text-indent: 0pt;text-align: right;">90</p><p class="s51" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">specifcity/recall (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s87" style="text-indent: 0pt;text-align: right;">80</p><p class="s87" style="text-indent: 0pt;line-height: 5pt;text-align: right;">70</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s51" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">specifcity      recall</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">specifcity (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">80</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">60</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">40</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">20</p><p class="s79" style="text-indent: 0pt;line-height: 4pt;text-align: right;">Raw expansion</p><p class="s79" style="text-indent: 0pt;line-height: 5pt;text-align: right;">Check 1</p><p class="s79" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Expansion</p><p class="s79" style="padding-left: 30pt;text-indent: 0pt;line-height: 5pt;text-align: left;">Check 2</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">80</p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">recall (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">60</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">40</p><p class="s79" style="padding-top: 5pt;text-indent: 0pt;text-align: right;">20</p><p class="s79" style="text-indent: 0pt;line-height: 4pt;text-align: right;">Raw expansion</p><p class="s79" style="text-indent: 0pt;line-height: 5pt;text-align: right;">Check 1</p><p class="s79" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Expansion</p><p class="s79" style="padding-left: 30pt;text-indent: 0pt;line-height: 5pt;text-align: left;">Check 2</p><p class="s87" style="padding-top: 2pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">60</p><p class="s87" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">50</p><p class="s87" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">40</p><p class="s87" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">30</p><p class="s87" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">20</p><p class="s87" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">10</p><p class="s87" style="padding-left: 45pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0</p><p class="s87" style="padding-left: 50pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0  20  40  60  80  100 120 140 160</p><p class="s79" style="padding-top: 5pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><span class="s85">0    </span>Email   DDoS<span class="s86">Univ  </span>DDoS<span class="s86">DNS</span></p><p class="s79" style="padding-top: 5pt;padding-left: 45pt;text-indent: 0pt;text-align: left;"><a name="bookmark59">&zwnj;</a><span class="s85">0    </span>Email   DDoS<span class="s86">Univ  </span>DDoS<span class="s86">DNS</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s51" style="padding-left: 47pt;text-indent: 0pt;text-align: left;"><a name="bookmark60">&zwnj;</a># of blacklists</p><ol id="l16"><li data-list-text="(a)"><p class="s8" style="padding-top: 2pt;padding-left: 45pt;text-indent: -11pt;text-align: left;">BLAG’s recommendation system contribu- tion to specificity.</p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 2pt;padding-left: 17pt;text-indent: -12pt;text-align: left;">BLAG’s recommendation system contribu- tion to recall.</p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 2pt;padding-left: 30pt;text-indent: -12pt;text-align: left;">Contribution of blacklists by size.</p><p style="padding-top: 10pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Figure 10: Evaluating impact on specificty/recall due to various components in BLAG and contribution of blacklist size to BLAG.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark58" class="s5">our three scenarios. During the aggregation phase (top of Figure </a>10(a)), BLAG’s recommendation system can prune out misclassifications and improve specificity from 89–99% to 98– 99.6%. BLAG is even more effective in increasing specificity during the selective expansion phase. BLAG’s recommenda- tion system (shown as <i>check</i><a href="#bookmark58" class="s5">1 in bottom half of Figure </a>10(a)), improves specificity from 24.5–69.7% to 86.9–95.6% over naïve expansion of all IP addresses. Also, BLAG’s complete selective expansion phase (shown as <i>check</i>2), further improves specificity to 95–99.5%.</p><p style="padding-top: 8pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark59" class="s5">On the other hand, BLAG’s recall depends on the cover- age of blacklist, aggregation and selective expansion phases. Figure 10(b) shows the impact of BLAG on recall. BLAG’s aggregation phase (top of Figure 10(b)) uses a threshold to prune out false positives and this can also prune out malicious addresses. This phase reduces recall from 0.18–19.4% to 0.15– 19.35%. BLAG’s selective expansion (bottom of Figure </a>10(b)) also reduces the recall. During <i>check1 </i>phase of selective expansion, recall further from 10.7–71.9% to 9–70.2% and during the <i>check2 </i>phase of selective expansion, the recall further reduces to 6.4–69.7%.</p><p style="padding-top: 9pt;text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li data-list-text="C."><p class="s7" style="padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark52">&zwnj;</a>Contribution of Individual Blacklists</p><p style="padding-top: 7pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">We ran BLAG on <i>n </i>largest blacklists for the Email sce- nario, and varied <i>n </i><a href="#bookmark60" class="s5">from 1 to 157 as shown in Figure </a>10(c). There is a 15.7% gain in recall for the first 106 blacklists. After this, there is a sharp increase in recall for the remaining blacklists. The next 20 largest blacklists double the recall to 32% and the next 14 largest blacklists push the recall past the 50% mark. When including all blacklists, the recall reaches 69.7%. Specificity stays at 100% for the first 41 blacklists</p></li><li data-list-text="D."><p class="s7" style="padding-top: 4pt;padding-left: 19pt;text-indent: -13pt;text-align: left;"><a name="bookmark53">&zwnj;</a>Contribution of known-legitimate sources (L<span class="s40">tr</span>):</p></li></ol><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">We ran BLAG by varying the duration of the (L<i>tr</i><a href="#bookmark65" class="s5">) available to BLAG– 0, 1, 3, 5 and 7 days for Email dataset as shown in Figure </a>11(a). As the number of days is increased, the specificity improves with small reduction in recall. With only 1 day of legitimate data available, the specificity improves by 36.7% with a loss of 2% of recall. As we increase the number of days the gain in specificity increases. By including all the days for training dataset, the specificity only improves by 4.5% and the recall reduces by 4.7%.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="VII."><p style="padding-left: 99pt;text-indent: -26pt;text-align: left;"><a name="bookmark61">&zwnj;</a>Parameter tuning<a name="bookmark62">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">In this section, we discuss a methodology used to determine the parameters <i>l</i>, <i>α </i>and <a href="#bookmark63" style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt;">K</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">4</span>.</p><p style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Parameter </b><i>l </i><b>for Historical Decay.   </b><a href="#bookmark26" class="s5">In Section </a>III-A, <i>l </i>roughly controls the length of historical data (in days) that may be included in the BLAG master blacklist. Using the validation dataset (L<i>v</i><i> </i>+ M<i>v</i>), we determine the impact of <i>l </i><a href="#bookmark66" class="s5">for three values (10, 30 and 50) shown in Figure </a>11(b). For the two scenarios, <i>l </i>= 30 has the highest recall. About 1.5– 8.9% and 4.3–36.4% higher recall for Email and DDoS<span class="s61">Univ</span> scenarios respectively. For <i>l </i>= 30, the specificity is uniformly high, ranging from from 95–97.9%. Therefore, <i>l </i>= 30 strikes the right balance, which increases recall with minimal loss in specificity. During our evaluation, we use <i>l </i>= 30 for the DDoS<span class="s61">DNS</span><a href="#bookmark16" class="s5"> dataset. This agrees with our observations in Section </a>II-B, where 91% of blacklisted addresses that re- offend, do so within 30 days.</p><h1 style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">Parameter <i>α </i>for choosing Master Blacklist candidates. <span class="p">The parameter </span><i>α </i><span class="p">controls the set of IP addresses, which should be considered for the expansion phase in BLAG. We show the</span></h1><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">and then drops slightly from 100% to 99.1% for the first</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">100 blacklists. The specificity drops to 95.5% for the next</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">performance in the validation dataset (L<i>v</i><i> </i>+ M<i>v</i><a href="#bookmark67" class="s5">). Figure </a>11(c) shows that for each scenario parameter</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: justify;">40 blacklists and finally, by adding the remaining blacklists,</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">the specificity comes down to 95%. Because we see a steady improvement in recall and a steady, slow decline in specificity, it is hard to tell how many blacklists would be enough. Instead, BLAG could let a customer choose different numbers of blacklists to aggregate and could produce specificity estimates (e.g., by using a validation set L<i>v</i>) for every choice.</p><p class="s7" style="padding-left: 172pt;text-indent: 0pt;line-height: 2pt;text-align: left;">α <span class="p">trades accuracy of</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark64" class="s5">BLAG with higher coverage. For various thresholds, we plot the specificity, recall and F1-score</a><span style=" color: black; font-family:&quot;Times New Roman&quot;, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: 3pt;">5</span>. Network operators could</p><p class="s12" style="padding-top: 9pt;padding-left: 5pt;text-indent: 7pt;text-align: left;"><a name="bookmark63">&zwnj;</a><span class="s10">4</span><span class="s11">Scripts to generate </span>l<span class="s8">, </span>α <span class="s8">and </span>K <a href="https://steel.isi.edu/Projects/BLAG/" class="a" target="_blank">can be found at https://steel.isi.edu/Projects/ </a><a href="https://steel.isi.edu/Projects/BLAG/" target="_blank">BLAG/</a><a name="bookmark64">&zwnj;</a></p><p class="s10" style="padding-left: 5pt;text-indent: 7pt;text-align: left;">5<span class="s11">F1-score is the harmonic mean of precision (fraction of IP addresses, which are listed and are indeed malicious sources) and recall</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;"><a name="bookmark65">&zwnj;</a>100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p class="s79" style="padding-top: 2pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 13pt;text-indent: 0pt;text-align: left;">0 days  1 days  3 days  5 days  7 days</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">0</p><p class="s79" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">BLAG<span class="s86">10   </span>BLAG<span class="s86">30   </span>BLAG<span class="s86">50</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">Specifcity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">Email    DDoS<span class="s86">Univ</span></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s88" style="text-indent: 0pt;text-align: right;">100</p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Specifcity (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s88" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">95</p><p class="s88" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">90</p><p class="s88" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">85</p><p class="s88" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Recall (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s88" style="text-indent: 0pt;text-align: right;">60</p><p class="s88" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">45</p><p class="s88" style="padding-top: 1pt;text-indent: 0pt;line-height: 4pt;text-align: right;">30</p><p class="s79" style="padding-top: 3pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">Email  DDoS<span class="s86">Univ</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s88" style="text-indent: 0pt;text-align: left;">0    0.2   0.4   0.6   0.8    1</p><p class="s79" style="padding-top: 3pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">Email  DDoS<span class="s86">Univ</span></p><p class="s79" style="padding-left: 54pt;text-indent: 0pt;line-height: 4pt;text-align: left;">Recall</p><p class="s79" style="padding-left: 42pt;text-indent: 0pt;line-height: 5pt;text-align: left;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 45pt;text-indent: 0pt;text-align: left;">20</p><p class="s79" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">100</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s80" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">(%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: right;">20</p><p class="s79" style="padding-left: 14pt;text-indent: 0pt;line-height: 5pt;text-align: left;">BLAG<span class="s86">10   </span>BLAG<span class="s86">30   </span>BLAG<span class="s86">50</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">Recall</p><p class="s88" style="padding-top: 2pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">15</p><p class="s88" style="padding-top: 1pt;padding-left: 45pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0</p><p class="s88" style="padding-left: 49pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0    0.2   0.4   0.6   0.8    1</p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">F1 score (%)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-top: 3pt;padding-left: 41pt;text-indent: 0pt;line-height: 6pt;text-align: center;">Email  DDoS<span class="s86">Univ</span></p><p class="s88" style="padding-left: 42pt;text-indent: 0pt;line-height: 4pt;text-align: left;">50</p><p class="s88" style="padding-left: 42pt;text-indent: 0pt;line-height: 5pt;text-align: left;">40</p><p class="s88" style="padding-left: 42pt;text-indent: 0pt;line-height: 5pt;text-align: left;">30</p><p class="s88" style="padding-left: 42pt;text-indent: 0pt;line-height: 5pt;text-align: left;">20</p><p class="s88" style="padding-left: 42pt;text-indent: 0pt;line-height: 5pt;text-align: left;">10</p><p class="s88" style="padding-left: 45pt;text-indent: 0pt;line-height: 5pt;text-align: left;">0</p><p class="s88" style="padding-left: 49pt;text-indent: 0pt;line-height: 5pt;text-align: left;"><a name="bookmark66">&zwnj;</a>0    0.2   0.4   0.6   0.8    1<a name="bookmark67">&zwnj;</a></p><p class="s85" style="padding-left: 47pt;text-indent: 0pt;line-height: 7pt;text-align: left;">0   <span class="s79">0 days  1 days  3 days  5 days  7 days</span></p><p class="s85" style="padding-left: 37pt;text-indent: 0pt;line-height: 8pt;text-align: left;">0      <span class="s79">Email    DDoS</span><span class="s86">Univ</span></p><p class="s79" style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">threshold</p><ol id="l17"><li data-list-text="(a)"><p class="s8" style="padding-top: 2pt;padding-left: 46pt;text-indent: -12pt;text-align: left;">Contribution of known-legitimate sources dataset.</p></li><li data-list-text="(b)"><p class="s8" style="padding-top: 2pt;padding-left: 47pt;text-indent: -12pt;text-align: left;">Evaluating parameter <i>l</i>.</p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 19pt;text-indent: 0pt;text-align: left;">Figure 11: Sensitivity analysis</p></li><li data-list-text="(c)"><p class="s8" style="padding-top: 2pt;padding-left: 45pt;text-indent: -12pt;text-align: left;">Threshold <i>α</i>.</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">use the F1-score as a metric to determine the appropriate threshold. We see that for the Email scenario, after a threshold of 0.8, the F1-score plateaus at 43%. For higher thresholds, the specificity drops from 95% to 85.9%. Similarly for DDoS<span class="s61">Univ</span> scenario, the F1-score plateaus after a threshold of 0.6 at 33%. For higher thresholds, the specificity again drops from 97.9% to 90.4%. Therefore, we set a threshold of 0.8 for Email and</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">0.6 for the DDoS<span class="s61">Univ</span>. Relevance scores for misclassifications would typically be high since all misclassifications are allo- cated a score of 1 in the misclassification blacklist. Therefore, for DDoS<span class="s61">DNS</span> scenario, we set a threshold of 0.8 to prune out misclassifications.</p><p class="s7" style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Parameter </b>K <b>for Matrix Factorization. </b><span class="p">Parameter </span>K <span class="p">is used in non-negative matrix factorization (NMF), and denotes the number of latent features. An ideal </span>K <span class="p">will have the minimum error between the matrix </span>R<span class="p">(</span>MxN <span class="p">) and </span>R<span class="s49">t</span><span class="s50"> </span><a href="#bookmark27" class="s5">(Section </a><a href="#bookmark124" class="s5">III-B). Brunet et al. </a><span class="p">[53] suggested using the smallest </span>K<span class="p">, after which the </span>cophenetic correlation coefficient <span class="p">starts decreasing. For the validation datasets, we evaluate different values of </span>K <span class="p">and find that the cophenetic correlation coefficient starts decreasing after </span>K <span class="p">is 5. BLAG is pre-configured to run gradient descent with </span>K <span class="p">= 5 until the root mean squared error (RMSE) between the original matrix </span>R <span class="p">and matrix </span>R<span class="s49">t</span><span class="s50"> </span><span class="p">fell below 1% or the number of iterations exceeded 1,000.</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="VIII."><p style="padding-left: 112pt;text-indent: -31pt;text-align: left;"><a name="bookmark68">&zwnj;</a>R<span class="s41">ELATED </span>W<span class="s41">ORK</span></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 14pt;text-align: left;">In this section, we survey work related to blacklist analysis, blacklist improvement and aggregation.</p><h1 style="padding-top: 9pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Analysis of Blacklists.  <a href="#bookmark131" class="s5">Kührer et al. evaluated the effec- tiveness of fifteen publicly available malware blacklists by measuring accuracy and completeness on datasets consisting of parked domains, sinkholed IP addresses, and active malware domains </a><a href="#bookmark141" class="s5">[60]. Pitsillidis et al. evaluated ten different blacklists on purity, coverage, proportionality, and timing </a><a href="#bookmark151" class="s5">[70]. Purity was measured by comparing feeds to Alexa top websites and Open directory listing, whereas coverage, proportionality, and timing were obtained by comparing feeds to one another. Both Kührer et al. and Pitsillidis et al. work support our findings that blacklists are not accurate. Zhang et al. evaluated nine blacklists using traffic logs from a regional ISP </a><span class="p">[80]. They</span></h1><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark134" class="s5">analyzed overlapping IP addresses between traffic logs and blacklists. But they were unable to measure the accuracy of blacklists, as the traffic in the logs was not labeled as malicious or legitimate. Vector et al. </a>[63] analyzed 47 distinct IP address threat intelligence sources and evaluated them for volume, differential contribution, exclusive contribution, latency, coverage, and accuracy. They used Alexa top 10 K websites as ground truth for legitimate sources and scanners captured by CAIDA darknet as ground truth for malicious sources. Vector et al. support our finding that blacklists or threat intelligence feeds have low recall (<i>&lt; </i>2%) and low misclassification as well. The main difference between these related works and ours is twofold. First, our main focus is on distilling accurate pieces of information from blacklists and aggregating it into a master blacklist; we use data about current blacklists merely to motivate our work. Second, we use an order of magnitude more blacklists than previous works.</p><p style="padding-top: 10pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;"><b>Improving Blacklisting.  </b><a href="#bookmark149" class="s5">PRESTA </a><a href="#bookmark115" class="s5">[78] uses historical data from three pay-for spam blacklists provided by Spamhaus </a>[44] to infer temporal and spatial properties of IP addresses and expand IP addresses into three spatial regions. Spamhaus blacklists are highly reputable and have high recall (<i>&gt; </i>80%) and very low misclassifications (<i>&lt; </i><a href="#bookmark46" class="s5">2%). PRESTA’s technique helps to uncover 18% more spammers while keeping misclassi- fications low. In our evaluation, too, PRESTA helped improve recall but at much higher misclassification cost (Section </a>V). This may be because we use public blacklists, which may not as accurate as pay-for blacklists.</p><p style="padding-top: 6pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 14pt;text-align: justify;"><a href="#bookmark150" class="s5">Highly Predictive Blacklisting </a><a href="#bookmark147" class="s5">[79] (HPB) creates blacklists customized to a given network by a page ranking algorithm. Soldo et al. </a><a href="#bookmark146" class="s5">[76] extended HPB to use historical data about attack sources and destinations and used a recommendation system to predict possible attackers for each victim. In contrast, BLAG uses a recommendation system to remove misclassifi- cations while aggregating blacklists. Sinha et al. </a>[75] present a new spam blacklisting technique, by monitoring email servers and spam traps to curate a spam blacklist. BLAG, on the other hand, works with existing blacklists to improve their performance and is applicable to different types of attacks.</p></li><li data-list-text="IX."><p style="padding-top: 3pt;padding-left: 115pt;text-indent: -22pt;text-align: left;"><a name="bookmark69">&zwnj;</a>Discussion</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">We discuss possible attacks on BLAG. BLAG has no way, other than the recommendation system, to differentiate between low-quality and high-quality information. Thus, if an attacker could produce a blacklist that is very similar to some reputable blacklist, which does not have much overlap with MB (e.g., by copying it) and if they included a few public servers in it, BLAG could conceivably propagate this information into its master blacklist. This could then lead to legitimate traffic from these public servers being dropped. Current blacklists could also be polluted by the same approach. Networks today choose carefully which blacklists to use, based on their reputation in the operator community. We assume they would apply the same care to choose blacklists used by BLAG. BLAG makes any polluted information less likely to propagate than individual blacklists. The attacker would have to carefully craft the polluted blacklist so that the servers appear on the same blacklist as many malicious sources, and their appearances do not resemble appearances of the known- legitimate sources on MB. Otherwise, BLAG would be able to identify and discard low-quality information. We leave the exact handling of pollution attempts for our future work.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="X."><p style="padding-left: 111pt;text-indent: -18pt;text-align: left;"><a name="bookmark70">&zwnj;</a>Conclusion</p></li></ol><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">Blacklists are widely used by network operators, but they usually miss many attacks. We have proposed BLAG– the sys- tem that can identify high-quality pieces of information from multiple blacklists, and aggregate them into a master blacklist, with some IP addresses expanded into /24 prefixes. Such a master blacklist could be useful for an emergency response to a novel or large-scale attack. Overall, BLAG has higher recall than any single blacklist or their naïve aggregation and has 95–99% specificity. BLAG also outperforms PRESTA+L, a competing approach, by having higher specificity for the same recall. We thus believe that BLAG could significantly improve network security, and produce higher-quality blacklists than existing approaches.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 50pt;text-indent: 0pt;text-align: center;">Acknowledgment</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 14pt;text-align: justify;">This project is the result of funding provided by the Science and Technology Directorate of the United States Department of Homeland Security under contract number D15PC00184. The views and conclusions contained herein are those of the authors, and should not be interpreted as necessarily repre- senting the official policies or endorsements, either expressed or implied, of the Department of Homeland Security or the US Government. Minlan Yu is partially supported by CNS 1413978 by the National Science Foundation. The authors are grateful to anonymous reviewers for their helpful comments. Additional thanks to Omid Alipourfard, Krutika Jain, Sula- gana Mukherjee, Aqib Nisar and Yu-Chuan Yen for their inputs in the earlier draft of the paper.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 50pt;text-indent: 0pt;text-align: center;"><a name="bookmark71">&zwnj;</a>References</p><ol id="l18"><li data-list-text="[1]"><p class="s8" style="padding-top: 6pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://krebsonsecurity.com/2016/09/krebsonsecurity-hit-with-record-ddos/" class="a" target="_blank" name="bookmark72">Krebsonsecurity hit with record ddos. https://krebsonsecurity.com/2016/ </a>09/krebsonsecurity-hit-with-record-ddos/, Sept 2016.</p></li><li data-list-text="[2]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="http://data.netlab.360.com/mirai-scanner/" class="a" target="_blank" name="bookmark73">Netlab: Mirai scanner feed. </a>http://data.netlab.360.com/mirai-scanner/, Sept 2016.</p></li><li data-list-text="[3]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://www.alienvault.com/" class="a" target="_blank" name="bookmark74">Alienvault Reputation System. </a>https://www.alienvault.com/, Sept 2019.</p></li><li data-list-text="[4]"><p class="s8" style="padding-top: 5pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="http://www.chaosreigns.com/iprep/" class="a" target="_blank" name="bookmark75">Automated ip reputation system for spammers. http://www.chaosreigns. </a>com/iprep/, Sept 2019.</p></li><li data-list-text="[5]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://www.badips.com/" class="a" target="_blank" name="bookmark76">Badips.com, an ip based abuse tracker. </a>https://www.badips.com/, Sept 2019.</p></li><li data-list-text="[6]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="http://osint.bambenekconsulting.com/feeds/" class="a" target="_blank" name="bookmark77">Bambenek consulting feeds.  http://osint.bambenekconsulting.com/ </a>feeds/, Sept 2019.</p></li><li data-list-text="[7]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://www.binarydefense.com/" class="a" target="_blank" name="bookmark78">Binary defense systems. </a>https://www.binarydefense.com/, Sept 2019.</p></li><li data-list-text="[8]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://www.blocklist.de/en/index.html" class="a" target="_blank" name="bookmark79">Blocklist.de fail2ban reporting service. https://www.blocklist.de/en/ </a>index.html, Sept 2019.</p></li><li data-list-text="[9]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -17pt;text-align: left;"><a href="https://www.botscout.com/" class="a" target="_blank" name="bookmark80">Botscout we catch bots so that you don’t have to. https://www.botscout. </a>com, Sept 2019.</p></li><li data-list-text="[10]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://charles.the-haleys.org/" class="a" target="_blank" name="bookmark81">Charles b. haley. </a>http://charles.the-haleys.org/, Sept 2019.</p></li><li data-list-text="[11]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://ciarmy.com/" class="a" target="_blank" name="bookmark82">Cinsscore. </a>http://ciarmy.com/, Sept 2019.</p></li><li data-list-text="[12]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.talosintelligence.com/" class="a" target="_blank" name="bookmark83">Cisco talos. </a>http://www.talosintelligence.com/, Sept 2019.</p></li><li data-list-text="[13]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a name="bookmark84">&zwnj;</a>Clean mx - realtime db. https://web.archive.org/web/20161102031447/ http://clean-mx.com:80/, Sept 2019.</p></li><li data-list-text="[14]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.cleantalk.org/" class="a" target="_blank" name="bookmark85">Cloud spam protection for forums, boards, blogs and sites. https://www. </a>cleantalk.org, Sept 2019.</p></li><li data-list-text="[15]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a name="bookmark86">&zwnj;</a>Criticalstack - the secure container orchestration platform for the enterprise. https://criticalstack.com/, Sept 2019.</p></li><li data-list-text="[16]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.cruzit.com/wbl.php" class="a" target="_blank" name="bookmark87">Cruzit - server blocklist / blacklist. </a>http://www.cruzit.com/wbl.php, Sept 2019.</p></li><li data-list-text="[17]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://cybercrime-tracker.net/" class="a" target="_blank" name="bookmark88">Cybercrime. </a>http://cybercrime-tracker.net/, Sept 2019.</p></li><li data-list-text="[18]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://danger.rulez.sk/index.php/bruteforceblocker/" class="a" target="_blank" name="bookmark89">Daniel gerzo, bruteforceblocker.  http://danger.rulez.sk/index.php/ </a>bruteforceblocker/, Sept 2019.</p></li><li data-list-text="[19]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://darklist.de/" class="a" target="_blank" name="bookmark90">Darklist.de | a malicious ip catcher blacklist. </a>http://darklist.de/, Sept 2019.</p></li><li data-list-text="[20]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://security-research.dyndns.org/pub/malware-feeds/" class="a" target="_blank" name="bookmark91">Dyn  malware  feeds.   http://security-research.dyndns.org/pub/ </a>malware-feeds/, Sept 2019.</p></li><li data-list-text="[21]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://rules.emergingthreats.net/" class="a" target="_blank" name="bookmark92">Emerging Threats. </a>https://rules.emergingthreats.net/, Sept 2019.</p></li><li data-list-text="[22]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://blocklist.net.ua/" class="a" target="_blank" name="bookmark93">General - blocklist.net.ua. </a>https://blocklist.net.ua/, Sept 2019.</p></li><li data-list-text="[23]"><p style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;line-height: 9pt;text-align: left;"><a href="https://graphiclineweb.wordpress.com/tech-notes/ip-blacklist/" class="a" target="_blank" name="bookmark94">Graphiclineweb.  </a><a href="https://graphiclineweb.wordpress.com/tech-notes/ip-blacklist/" target="_blank">https://graphiclineweb.wordpress.com/tech-notes/</a></p><p class="s8" style="padding-left: 27pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ip-blacklist/, Sept 2019.</p></li><li data-list-text="[24]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://greensnow.co/" class="a" target="_blank" name="bookmark95">Greensnow. </a>https://greensnow.co/, Sept 2019.</p></li><li data-list-text="[25]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://hosts-file.net/" class="a" target="_blank" name="bookmark96">hphosts - by malware bytes. </a>https://hosts-file.net/, Sept 2019.</p></li><li data-list-text="[26]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.iblocklist.com/" class="a" target="_blank" name="bookmark97">I-blocklist. </a>https://www.iblocklist.com/, Sept 2019.</p></li><li data-list-text="[27]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://antispam.imp.ch/" class="a" target="_blank" name="bookmark98">Improware. </a>http://antispam.imp.ch/, Sept 2019.</p></li><li data-list-text="[28]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://blacklist.lashback.com/" class="a" target="_blank" name="bookmark99">Lashback blacklist. </a>http://blacklist.lashback.com/, Sept 2019.</p></li><li data-list-text="[29]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.mailinator.com/" class="a" target="_blank" name="bookmark100">Mailinator inc. </a>http://www.mailinator.com, Sept 2019.</p></li><li data-list-text="[30]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://malc0de.com/database/" class="a" target="_blank" name="bookmark101">Malc0de Database. </a>http://malc0de.com/database/, Sept 2019.</p></li><li data-list-text="[31]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.malwaredomainlist.com/" class="a" target="_blank" name="bookmark102">Malware domain list. </a>http://www.malwaredomainlist.com/, Sept 2019.</p></li><li data-list-text="[32]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.maxmind.com/en/high-risk-ip-sample-list" class="a" target="_blank" name="bookmark103">Maxmind - sample list of high risk ip addresses. https://www.maxmind. </a>com/en/high-risk-ip-sample-list, Sept 2019.</p></li><li data-list-text="[33]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.myip.ms/info/about" class="a" target="_blank" name="bookmark104">My ip - blacklist checks. </a>https://www.myip.ms/info/about, Sept 2019.</p></li><li data-list-text="[34]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.nothink.org/" class="a" target="_blank" name="bookmark105">Nothink individual blacklist maintainer. </a>http://www.nothink.org/, Sept 2019.</p></li><li data-list-text="[35]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.ipspamlist.com/ip-reputation-feeds/" class="a" target="_blank" name="bookmark106">Novirusthanks: Security software and services. http://www.ipspamlist. </a>com/ip-reputation-feeds/, Sept 2019.</p></li><li data-list-text="[36]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.openbl.org/" class="a" target="_blank" name="bookmark107">OpenBL - Abuse reporting and blacklisting. https://web.archive.org/ </a>web/20170107081656/http://www.openbl.org/, Sept 2019.</p></li><li data-list-text="[37]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.projecthoneypot.org/" class="a" target="_blank" name="bookmark108">Project Honeypot. </a>https://www.projecthoneypot.org/, Sept 2019.</p></li><li data-list-text="[38]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.turris.cz/en/greylist" class="a" target="_blank" name="bookmark109">Project turris. </a>https://www.turris.cz/en/greylist, Sept 2019.</p></li><li data-list-text="[39]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.proofpoint.com/" class="a" target="_blank" name="bookmark110">Proofpoint inc. </a>http://www.proofpoint.com, Sept 2019.</p></li><li data-list-text="[40]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://sblam.com/" class="a" target="_blank" name="bookmark111">Sblam! </a>http://sblam.com/, Sept 2019.</p></li><li data-list-text="[41]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.autoshun.org/" class="a" target="_blank" name="bookmark112">Shun list. </a>https://www.autoshun.org/, Sept 2019.</p></li><li data-list-text="[42]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://labs.snort.org/" class="a" target="_blank" name="bookmark113">Sourcefire vrt labs. </a>https://labs.snort.org/, Sept 2019.</p></li><li data-list-text="[43]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://spamassassin.apache.org/old/publiccorpus/" class="a" target="_blank" name="bookmark114">Spamassasin public corpus.  https://spamassassin.apache.org/old/ </a>publiccorpus/, Sept 2019.</p></li><li data-list-text="[44]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.spamhaus.org/" class="a" target="_blank" name="bookmark115">Spamhaus Project. </a>https://www.spamhaus.org/, Sept 2019.</p></li><li data-list-text="[45]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://stefan.gofferje.net/it-stuff/sipfraud/sip-attacker-blacklist" class="a" target="_blank" name="bookmark116">Stefan gofferje - sip attacker blacklist. http://stefan.gofferje.net/it-stuff/ </a>sipfraud/sip-attacker-blacklist, Sept 2019.</p></li><li data-list-text="[46]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://stopforumspam.com/" class="a" target="_blank" name="bookmark117">Stop forum spam. </a>https://stopforumspam.com/, Sept 2019.</p></li><li data-list-text="[47]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.abuse.ch/" class="a" target="_blank" name="bookmark118">Swiss Security Blog - Abuse.ch. </a>https://www.abuse.ch/, Sept 2019.</p></li><li data-list-text="[48]"><p class="s8" style="padding-top: 3pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="https://www.trustedsec.com/" class="a" target="_blank" name="bookmark119">Trustedsec - information security consulting services. https://www. </a>trustedsec.com/, Sept 2019.</p></li><li data-list-text="[49]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://untroubled.org/spam/" class="a" target="_blank" name="bookmark120">Untroubled. </a>http://untroubled.org/spam/, Sept 2019.</p></li><li data-list-text="[50]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.urlvir.com/" class="a" target="_blank" name="bookmark121">Urlvir: Monitor malicious executable urls. </a>http://www.urlvir.com/, Sept 2019.</p></li><li data-list-text="[51]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://www.voipbl.org/" class="a" target="_blank" name="bookmark122">Voip blacklist. </a>http://www.voipbl.org/, Sept 2019.</p></li><li data-list-text="[52]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: left;"><a href="http://vxvault.net/ViriList.php" class="a" target="_blank" name="bookmark123">Vx vault. </a>http://vxvault.net/ViriList.php, Sept 2019.</p></li><li data-list-text="[53]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark124">&zwnj;</a>Jean-Philippe Brunet, Pablo Tamayo, Todd R Golub, and Jill P Mesirov. Metagenes and molecular pattern discovery using matrix factorization. <i>Proceedings of the national academy of sciences</i>, 101(12):4164–4169, 2004.</p></li><li data-list-text="[54]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark125">&zwnj;</a>Christoph Dietzel, Anja Feldmann, and Thomas King. Blackholing at ixps: On the effectiveness of ddos mitigation in the wild.  In <i>International Conference on Passive and Active Network Measurement</i>, pages 319–332. Springer, 2016.</p></li><li data-list-text="[55]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark126">&zwnj;</a>Shuang Hao, Nadeem Ahmed Syed, Nick Feamster, Alexander G Gray, and Sven Krasser. Detecting spammers with snare: Spatio-temporal network-level automatic reputation engine. In <i>USENIX security sympo- sium</i>, volume 9, 2009.</p></li><li data-list-text="[56]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a href="https://www.dropbox.com/s/i37ze8g4804owwz/usenix_poster.pdf?dl=0" class="a" target="_blank" name="bookmark127">Anushah Hossain, Sivaramakrishnan Ramanthan, and Sadia Afroz. Poster: Perceptions of third part blacklists. https://www.dropbox.com/ </a>s/i37ze8g4804owwz/usenix_poster.pdf?dl=0, August 2019.</p></li><li data-list-text="[57]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a href="https://dshield.org/about.html" class="a" target="_blank" name="bookmark128">SANS Institute. Internet Storm Center. </a>https://dshield.org/about.html, Sept 2019.</p></li><li data-list-text="[58]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a href="https://nsnam.isi.edu/datasets/readmes/B_Root_Anomaly-20160625.README.txt" class="a" target="_blank" name="bookmark129">ANT ISI.  https://nsnam.isi.edu/datasets/readmes/b_root_anomaly- 20160625.readme.txt. https://nsnam.isi.edu/datasets/readmes/B_Root_ </a>Anomaly-20160625.README.txt, June 2019.</p></li><li data-list-text="[59]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark130">&zwnj;</a>Yehuda Koren, Robert Bell, and Chris Volinsky. Matrix factorization techniques for recommender systems. <i>Computer</i>, 42(8):30–37, August 2009.</p></li><li data-list-text="[60]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark131">&zwnj;</a>Marc Kührer, Christian Rossow, and Thorsten Holz. Paint it black: Evaluating the effectiveness of malware blacklists. In <i>International Workshop on Recent Advances in Intrusion Detection</i>, pages 1–21. Springer, 2014.</p></li><li data-list-text="[61]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark132">&zwnj;</a>Victor Le Pochat, Tom Van Goethem, Samaneh Tajalizadehkhoob, Maciej Korczyn´ski, and Wouter Joosen. Tranco: A research-oriented top sites ranking hardened against manipulation. In <i>Proceedings of the 26th Annual Network and Distributed System Security Symposium</i>, NDSS 2019, 2019.</p></li><li data-list-text="[62]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark133">&zwnj;</a>Daniel D Lee and H Sebastian Seung. Algorithms for non-negative matrix factorization. In <i>Advances in neural information processing systems</i>, pages 556–562, 2001.</p></li><li data-list-text="[63]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark134">&zwnj;</a>Vector Guo Li, Matthew Dunn, Paul Pearce, Damon McCoy, Ge- offrey M. Voelker, and Stefan Savage.  Reading the tea leaves: A comparative analysis of threat intelligence. In <i>28th USENIX Security Symposium (USENIX Security 19)</i>, pages 851–867, Santa Clara, CA, August 2019. USENIX Association.</p></li><li data-list-text="[64]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark135">&zwnj;</a>Justin Mason. Filtering spam with spamassassin. In <i>HEANet Annual Conference</i>, page 103, 2002.</p></li><li data-list-text="[65]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark136">&zwnj;</a>David Moore, Colleen Shannon, et al. Code-red: a case study on the spread and victims of an internet worm. In <i>Proceedings of the 2nd ACM SIGCOMM Workshop on Internet measurment</i>, pages 273–284. ACM, 2002.</p></li><li data-list-text="[66]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark137">&zwnj;</a>Arman Noroozian, Jan Koenders, Eelco van Veldhuizen, Carlos H. Ganan, Sumayah Alrwais, Damon McCoy, and Michel van Eeten. Platforms in everything: Analyzing ground-truth data on the anatomy and economics of bullet-proof hosting.  In <i>28th USENIX Security Symposium (USENIX Security 19)</i>, pages 1341–1356, Santa Clara, CA, August 2019. USENIX Association.</p></li><li data-list-text="[67]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a href="https://krebsonsecurity.com/tag/memcached-attack/" class="a" target="_blank" name="bookmark138">Krebs on Security. memcached attack. https://krebsonsecurity.com/tag/ </a>memcached-attack/, March 2018.</p></li><li data-list-text="[68]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a href="https://www.heise.de/ix/NiX-Spam-DNSBL-and-blacklist-for-download-499637.html" class="a" target="_blank" name="bookmark139">Heise  Online.     NiX  Spam  DNSBL  and  black- list   for   download.         https://www.heise.de/ix/ </a>NiX-Spam-DNSBL-and-blacklist-for-download-499637.html,   Sept 2019.</p></li><li data-list-text="[69]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark140">&zwnj;</a>Michael Pazzani and Daniel Billsus. Content-based recommendation systems. <i>The adaptive web</i>, pages 325–341, 2007.</p></li><li data-list-text="[70]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark141">&zwnj;</a>Andreas Pitsillidis, Chris Kanich, Geoffrey M Voelker, Kirill Levchenko, and Stefan Savage. Taster’s choice: a comparative analysis</p><p class="s8" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: justify;">of spam feeds. In <i>Proceedings of the 2012 ACM conference on Internet measurement conference</i>, pages 427–440. ACM, 2012.</p></li><li data-list-text="[71]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark142">&zwnj;</a>Oregon RouteViews. University of oregon routeviews project. <a href="http://www/" class="s89" target="_blank">Eugene, OR.[Online]. Available: </a><i>http://www. routeviews. org</i>.</p></li><li data-list-text="[72]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark143">&zwnj;</a>J Ben Schafer, Dan Frankowski, Jon Herlocker, and Shilad Sen. Collaborative filtering recommender systems. In <i>The adaptive web</i>, pages 291–324. Springer, 2007.</p></li><li data-list-text="[73]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark144">&zwnj;</a>Quirin Scheitle, Oliver Hohlfeld, Julien Gamba, Jonas Jelten, Torsten Zimmermann, Stephen D Strowes, and Narseo Vallina-Rodriguez. A long way to the top: significance, structure, and stability of internet top lists. In <i>Proceedings of the Internet Measurement Conference 2018</i>, pages 478–493. ACM, 2018.</p></li><li data-list-text="[74]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark145">&zwnj;</a>Sushant Sinha, Michael Bailey, and Farnam Jahanian.  Shades of grey: On the effectiveness of reputation-based blacklists. In <i>Malicious and Unwanted Software, 2008. MALWARE 2008. 3rd International Conference on</i>, pages 57–64. IEEE, 2008.</p></li><li data-list-text="[75]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark146">&zwnj;</a>Sushant Sinha, Michael Bailey, and Farnam Jahanian. Improving spam blacklisting through dynamic thresholding and speculative aggregation. In <i>NDSS</i>, 2010.</p></li><li data-list-text="[76]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark147">&zwnj;</a>Fabio Soldo, Anh Le, and Athina Markopoulou. Predictive blacklisting as an implicit recommendation system. In <i>INFOCOM, 2010 Proceed- ings IEEE</i>, pages 1–9. IEEE, 2010.</p></li><li data-list-text="[77]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark148">&zwnj;</a>Shobha Venkataraman, Subhabrata Sen, Oliver Spatscheck, Patrick Haffner, and Dawn Song. Exploiting network structure for proactive spam mitigation. In <i>Usenix Security</i>, 2007.</p></li><li data-list-text="[78]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark149">&zwnj;</a>Andrew G West, Adam J Aviv, Jian Chang, and Insup Lee. Spam mitigation using spatio-temporal reputations from blacklist history. In <i>Proceedings of the 26th Annual Computer Security Applications Conference</i>, pages 161–170. ACM, 2010.</p></li><li data-list-text="[79]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark150">&zwnj;</a>Jian Zhang, Phillip A Porras, and Johannes Ullrich. Highly predictive blacklisting. In <i>USENIX Security Symposium</i>, pages 107–122, 2008.</p></li><li data-list-text="[80]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark151">&zwnj;</a>Jing Zhang, Ari Chivukula, Michael Bailey, Manish Karir, and Mingyan Liu. Characterization of blacklists and tainted network traffic. In <i>International Conference on Passive and Active Network Measurement</i>, pages 218–228. Springer, 2013.</p></li><li data-list-text="[81]"><p class="s8" style="padding-top: 2pt;padding-left: 27pt;text-indent: -21pt;text-align: justify;"><a name="bookmark152">&zwnj;</a>Jing Zhang, Zakir Durumeric, Michael Bailey, Mingyan Liu, and Manish Karir. On the mismanagement and maliciousness of networks. In <i>NDSS</i>, 2014.</p></li></ol></body></html>
