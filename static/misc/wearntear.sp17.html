<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>main.pdf</title><meta name="author" content="mikepo"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 24pt; }
 .s2 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .p, p { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .s3 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s4 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s5 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .h1, h1 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s6 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s7 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s8 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s9 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s10 { color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s11 { color: #231F20; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s12 { color: #535355; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; }
 .s13 { color: #231F20; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s14 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8.5pt; }
 .s15 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 .s16 { color: #231F20; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s18 { color: #231F20; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s19 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6.5pt; vertical-align: -1pt; }
 .s20 { color: #231F20; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s21 { color: #231F20; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s22 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s23 { color: #231F20; font-family:Symbol; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s24 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s25 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -2pt; }
 .s26 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s27 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: -1pt; }
 .s28 { color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s29 { color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 1pt; }
 .s30 { color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: -1pt; }
 .s31 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s32 { color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; }
 .s33 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 2pt; }
 .s34 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s35 { color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 2pt; }
 .s36 { color: #231F20; font-family:Helvetica, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s37 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9.5pt; }
 .s38 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 .s39 { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .a, a { color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, upper-roman)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "• "; color: #231F20; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 #l3 {padding-left: 0pt;counter-reset: e1 1; }
 #l3> li>*:first-child:before {counter-increment: e1; content: counter(e1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: e1 0;  }
 #l4 {padding-left: 0pt;counter-reset: f1 1; }
 #l4> li>*:first-child:before {counter-increment: f1; content: counter(f1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l5 {padding-left: 0pt;counter-reset: f2 1; }
 #l5> li>*:first-child:before {counter-increment: f2; content: counter(f2, decimal)") "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: f2 0;  }
 #l6 {padding-left: 0pt;counter-reset: g1 1; }
 #l6> li>*:first-child:before {counter-increment: g1; content: counter(g1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: g1 0;  }
 #l7 {padding-left: 0pt;counter-reset: h1 1; }
 #l7> li>*:first-child:before {counter-increment: h1; content: counter(h1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l7> li:first-child>*:first-child:before {counter-increment: h1 0;  }
 #l8 {padding-left: 0pt; }
 #l8> li>*:first-child:before {content: "● "; color: #5B5C5E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3pt; vertical-align: 1pt; }
 #l9 {padding-left: 0pt; }
 #l9> li>*:first-child:before {content: "● "; color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 2pt; }
 #l10 {padding-left: 0pt;counter-reset: k1 1; }
 #l10> li>*:first-child:before {counter-increment: k1; content: counter(k1, upper-latin)". "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l10> li:first-child>*:first-child:before {counter-increment: k1 0;  }
 #l11 {padding-left: 0pt;counter-reset: k2 1; }
 #l11> li>*:first-child:before {counter-increment: k2; content: counter(k2, decimal)") "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: k2 0;  }
 #l12 {padding-left: 0pt;counter-reset: l1 1; }
 #l12> li>*:first-child:before {counter-increment: l1; content: counter(l1, upper-latin)". "; color: #231F20; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: l1 0;  }
 li {display: block; }
 #l13 {padding-left: 0pt;counter-reset: m1 1; }
 #l13> li>*:first-child:before {counter-increment: m1; content: "["counter(m1, decimal)"] "; color: #231F20; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: m1 0;  }
 #l14 {padding-left: 0pt;counter-reset: k1 3; }
 #l14> li>*:first-child:before {counter-increment: k1; content: counter(k1, upper-latin)". "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l14> li:first-child>*:first-child:before {counter-increment: k1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p class="s1" style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: center;">Spotless Sandboxes: Evading Malware Analysis Systems using Wear-and-Tear Artifacts</p><p class="s2" style="padding-top: 15pt;padding-left: 21pt;text-indent: 0pt;text-align: center;">Najmeh Miramirkhani, Mahathi Priya Appini, Nick Nikiforakis, Michalis Polychronakis</p><p style="padding-left: 24pt;text-indent: 0pt;text-align: center;">Stony Brook University</p><p class="s3" style="padding-left: 24pt;text-indent: 0pt;text-align: center;">{<span class="s4">nmiramirkhani, mappini, nick, mikepo</span>}<span class="s4">@cs.stonybrook.edu</span></p><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 6pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Abstract<span class="h1">—Malware sandboxes, widely used by antivirus companies, mobile application marketplaces, threat detection appliances, and security researchers, face the challenge of environment-aware malware that alters its behavior once it de- tects that it is being executed on an analysis environment. Recent efforts attempt to deal with this problem mostly by ensuring that well-known properties of analysis environments are replaced with realistic values, and that any instrumentation artifacts remain hidden. For sandboxes implemented using virtual machines, this can be achieved by scrubbing vendor-speciﬁc drivers, processes, BIOS versions, and other VM-revealing indicators, while more sophisticated sandboxes move away from emulation-based and virtualization-based systems towards bare-metal hosts.</span></p><h1 style="padding-top: 1pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">We observe that as the ﬁdelity and transparency of dynamic malware analysis systems improves, malware authors can resort to other system characteristics that are indicative of artiﬁcial environments. We present a novel class of sandbox evasion techniques that exploit the “wear and tear” that inevitably occurs on real systems as a result of normal use. By moving beyond how realistic a system looks like, to how realistic <i>its past use </i>looks like, malware can effectively evade even sandboxes that do not expose any instrumentation indicators, including bare-metal systems. We investigate the feasibility of this evasion strategy by conducting a large-scale study of wear-and-tear artifacts collected from real user devices and publicly available malware analysis services. The results of our evaluation are alarming: using simple decision trees derived from the analyzed data, malware can determine that a system is an artiﬁcial environment and not a real user device with an accuracy of 92.86%. As a step towards defending against wear-and-tear malware evasion, we develop statistical models that capture a system’s age and degree of use, which can be used to aid sandbox operators in creating system images that exhibit a realistic wear-and-tear state.</h1><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="I."><p style="padding-left: 104pt;text-indent: -10pt;text-align: left;">Introduction</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">As the number and sophistication of the malware samples and malicious web pages that must be analyzed every day constantly increases, defenders rely on automated analysis systems for detection and forensic purposes. Malware scanning based on static code analysis faces signiﬁcant challenges due to the prevalent use of packing, polymorphism, and other code obfuscation techniques. Consequently, malware analysts largely rely on dynamic analysis approaches to scan potentially malicious executables. Dynamic malicious code analysis systems operate by loading each sample into a heavily instrumented environment, known as a <i>sandbox</i>, and monitoring its operations at varying levels of granularity (e.g., I/O activity, system calls, machine instructions). Malware sandboxes are typically built using API hooking mechanisms [1], CPU</p><p style="padding-top: 4pt;padding-left: 8pt;text-indent: 0pt;text-align: justify;">emulators [2]–[5], virtual machines [6], [7], or even dedicated</p><p style="padding-left: 8pt;text-indent: 0pt;text-align: justify;">bare-metal hosts [8]–[10].</p><p style="padding-left: 8pt;text-indent: 9pt;text-align: justify;">Malware sandboxes are employed by a broad range of systems and services. Besides their extensive use by antivirus companies for analyzing malware samples gathered by deployed antivirus software or by voluntary submissions from users, sandboxes have also become critical in the mobile ecosystem, for scrutinizing developers’ app submissions to online app marketplaces [11], [12]. In addition, a wide variety of industry security solutions, including intrusion detection systems, secure gateways, and other perimeter security appliances, employ sandboxes (also known as “detonation boxes”) for on-the-ﬂy or off-line analysis of unknown binary downloads and email attachments [13]–[17].</p><p style="padding-left: 7pt;text-indent: 11pt;text-align: justify;">As dynamic malware analysis systems become more widely used, online miscreants constantly seek new methods to hinder analysis and evade detection by altering the behavior of malicious code when it runs on a sandbox [8], [9], [11], [18]– [20]. For example, malicious software can simply crash or refrain from performing any malicious actions, or even exhibit benign behavior by masquerading as a legitimate application. Similarly, exploit kits hosted on malicious (or infected) web pages have started employing evasion and cloaking techniques to refrain from launching exploits against analysis systems [21], [22]. To effectively alter its behavior, a crucial capability for malicious code is to be able to recognize whether it is being run on a sandbox environment or on a real user system. Such “environment-aware” malware has been evolving for years, using sophisticated techniques against the increasing ﬁdelity of malware analysis systems.</p><p style="padding-left: 4pt;text-indent: 13pt;text-align: justify;">In this paper, we argue that as the ﬁdelity and non- intrusiveness of dynamic malware analysis systems continues to improve, an anticipated next step for attackers is to rely on other environmental features and characteristics to distin- guish between end-user systems and analysis environments. Speciﬁcally, we present an alternative, more potent approach to current VM-detection and evasion techniques that is effective <i>even if we assume that no instrumentation or introspection artifacts of an analysis system can be identiﬁed by malware at run time</i>. This can be achieved by focusing instead on the <i>“wear and tear” </i>and <i>“aging” </i>that inevitably occurs on real systems as a result of normal use. Instead of trying to identify artifacts characteristic to analysis environments, malware can determine the plausibility of its host being a real system used by an actual person based on system usage indicators.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">The key intuition behind the proposed strategy is that, in contrast to real devices under active use, existing dynamic analysis systems are typically implemented using operating system images in almost pristine condition. Although some further conﬁguration is often performed to make the system look more realistic, after each binary analysis, the system is rolled back to its initial state [23]. This means that any possible wear-and-tear side-effects are discarded, and the system is always brought back to a pristine condition. As an indicative example, in a real system, properties like the browsing history, the event log, and the DNS resolver cache, are expected to be populated as a result of days’ or weeks’ worth of activity. In contrast, due to the rollback nature of existing dynamic analysis systems, malicious code can easily identify that the above aspects of a system may seem unrealistic for a device that supposedly has been in active use by an actual person.</p><p style="padding-left: 5pt;text-indent: 11pt;text-align: justify;">Even though researchers have already discussed the pos- sibility of using speciﬁc indicators, such as the absence of “Recently Open Files” [24] and the lack of a sufﬁcient number of processes [25] as ways of identifying sandbox environments, we show that these individual techniques are part of a larger problem, and systematically assess their threat to dynamic analysis sandboxes. To assess the feasibility and effectiveness of this evasion strategy, we have identiﬁed a multitude of wear- and-tear artifacts that can potentially be used by malware as indicators of the extent to which a system has been actually used. We present a taxonomy of our ﬁndings, based on which we then proceeded to implement a probe tool that relies on a subset of those artifacts—ones that can be captured in a privacy- preserving way—to determine a system’s level of wear and tear. Using that tool, we gathered a large set of measurements from 270 real user systems, and used it to determine the discriminatory capacity of each artifact for evasion purposes.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">We then proceed to test our hypothesis that wear and tear can be a robust indicator for environment-aware malware, by gauging the extent to which malware sandboxes are vulner- able to evasion using this strategy. We submitted our probe executable to publicly available malware scanning services, receiving results from 16 vendors. Using half of the collected sandbox data, we trained a decision tree model that picks a few artifacts to reason whether a system is real or not, and evaluated it using the other half. Our ﬁndings are alarming: for all tested sandboxes, the employed model can determine that the system is an artiﬁcial environment and not a real user device with an accuracy of 92.86%.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">We provide a detailed analysis of the robustness of this evasion approach using different sets of artifacts, and show that modifying existing sandboxes to withstand this type of evasion is not as simple as artiﬁcially adjusting the probed artifacts to plausible values. Besides the fact that malware can easily switch to the use of another set of artifacts, we have uncovered a deeper direct correlation of many of the evaluated wear-and-tear artifacts and the reported age of the system, which can allow malware to detect unrealistic conﬁgurations. As a step towards defending against wear-and-tear malware evasion, we have developed statistical models that capture the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">age and degree of usage of a given system, which can be used to ﬁne-tune sandboxes so that they look realistic.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">In summary, our work makes the following main contribu- tions:</p><ul id="l2"><li data-list-text="•"><p class="s3" style="padding-top: 1pt;padding-left: 25pt;text-indent: -10pt;text-align: justify;">	<span class="p">We show that certain, seemingly independent, techniques for identifying sandbox environments are in fact all instances of a broader evasion strategy based on a system’s wear-and-tear characteristics.</span></p></li><li data-list-text="•"><p style="padding-left: 25pt;text-indent: -10pt;text-align: justify;">We present an indicative set of diverse wear-and-tear artifacts, and evaluate their discriminatory capacity by conducting a large-scale measurement study based on data collected from real user systems and malware sandboxes.</p></li><li data-list-text="•"><p style="padding-left: 25pt;text-indent: -10pt;text-align: justify;">We demonstrate that using simple decision trees derived from the analyzed data, malware can robustly evade <i>all </i>tested sandboxes with an accuracy of 92.86%.</p></li><li data-list-text="•"><p style="padding-left: 25pt;text-indent: -10pt;text-align: justify;">We present statistical models that can predict the age of a system based on its system usage indicators, which can be used to “age” existing artiﬁcial-looking sandboxes to the desired degree.</p></li></ul></li><li data-list-text="II."><p style="padding-top: 6pt;padding-left: 60pt;text-indent: -14pt;text-align: left;">Background and Related Work</p><ol id="l3"><li data-list-text="A."><p class="s3" style="padding-top: 3pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Virtualization and Instrumentation Artifacts</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 10pt;text-align: justify;">Antivirus companies, search engines, mobile application marketplaces, and the security research community in general largely rely on dynamic code analysis systems that load potentially malicious content in a controlled environment for analysis purposes [1]–[6], [8]–[10], [21], [26]–[34]. Given that virtual machines and system emulators are very convenient platforms for building malware sandboxes, evasive malware often relies on various artifacts of such systems to alter its behavior [8], [9], [11], [18]–[20], [35]. Probably the simplest approach is to use static heuristics that check for certain system properties, such as VM-speciﬁc device drivers and hardware conﬁgurations, ﬁxed identiﬁers including MAC addresses, IMEIs (for mobile malware analysis systems), user/host names, VM-speciﬁc loaded modules and processes (e.g., VMware Tools in case of VMware), and registry entries [20], [36].</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Even when dynamic analysis systems are carefully conﬁg- ured to avoid expected values and conﬁgurations, lower-level properties of the execution environment can be used to identify the presence of a virtual environment. These include emulator intricacies that can be observed at runtime using small code snippets, timing properties of certain virtualized instructions, cache side effects, and many others [8], [20], [37]–[43].</p></li><li data-list-text="B."><p class="s3" style="padding-top: 6pt;padding-left: 19pt;text-indent: -13pt;text-align: justify;">Environmental and User Interaction Artifacts</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 9pt;text-align: justify;">The increasing sophistication of environment-aware malware has prompted many research efforts that focus on either detecting the “split personality” of malware by running each sample on multiple and diverse analysis systems [18], [44], [45], or increasing the ﬁdelity of the analysis environment by avoiding the use of emulation or virtualization altogether, and opting for “bare-metal” systems [8]–[10], [46].</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">These recent developments, however, along with the pro- liferation of virtual environments in production deployments and end-user systems, have resulted in yet another change of</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">tactics from the side of malware authors. Given that a VM host may be equally “valuable” as a non-VM host, the number of malicious samples that rely on VM detection tricks for evasion has started to decrease [47].</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">At the same time, malware authors have started employing other heuristics that focus mostly on how realistic the state and conﬁguration of a host is, rather than whether it is a real or a virtual one. Such heuristics include checking whether the mouse cursor remains motionless in the center of the screen [48], observing the absence of “Recently Open Files” [24] or an unusually low number of processes [25], testing whether unrestricted internet connectivity is available, and trying to resolve a known non-existent domain name. As some malware analysis systems blindly serve all DNS requests, a positive answer to a request for a non-existent domain is an indication of a malware analysis environment and not a real system [9]. Correspondingly, malware sandboxes have started emulating user behavior (e.g., by generating realistic- looking mouse movements and actions) and exposing a more realistic network environment. Unfortunately, as we show in this work, a neglected aspect of this effort towards making malware sandboxes as realistic as possible, is the wear and tear that is expected to occur as a result of normal use.</p></li><li data-list-text="C."><p class="s3" style="padding-top: 7pt;padding-left: 21pt;text-indent: -14pt;text-align: justify;">Sandbox Fingerprinting</p></li></ol><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">A few research efforts have focused on deriving conﬁguration proﬁles from sandboxes used by malware scanning services and security appliances [23], [49]. By ﬁngerprinting the sandboxes of different vendors, malware can then identify the distinguishing characteristics of a given sandbox, and alter its behavior accordingly. Maier et al. developed Sand- Finger [49], a sandbox ﬁngerprinting tool for Android-based analysis systems. The extracted ﬁngerprints capture properties that are mostly speciﬁc to mobile devices, such as saved WiFi networks, paired Bluetooth devices, or whether a device is connected to a host via a cable. The authors show that the derived ﬁngerprints can be used by malicious apps to evade Google’s Bouncer and other mobile app sandboxes.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">Recently, Blackthorne et al. presented AVLeak, a tool that can ﬁngerprint emulators running inside commercial antivirus (AV) software, which are used whenever AVs detect an unknown executable [50]. The authors developed a method that allows them to treat these emulators as black boxes and use side channels as a means of extracting ﬁngerprints from each AV engine.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Yokoyama et al. developed SandPrint [23], a sandbox ﬁngerprinting tool tailored for Windows malware analysis systems. The tool considers a set of 25 features that were identiﬁed to exhibit characteristic, high-entropy values on malware sandboxes used by different vendors. These include hardware conﬁguration parameters, which tend to have unusu- ally low values to facilitate the parallel operation of multiple sandbox images (e.g., by lowering the amount of RAM or disk space), or features speciﬁc to the malware sample invocation mechanism employed by each sandbox (e.g., Cuckoo Sandbox’s <span class="s4">agent.py </span>launch script, or the fact that the ﬁle name of the</p><p style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: justify;">analyzed executable is changed according to its MD5 sum or using some other naming scheme). The authors then performed automated clustering to classify ﬁngerprints collected after the submission of the tool to 20 malware analysis services, resulting in the observation of 76 unique sandboxes. They also used some of the features to build a classiﬁer that malware can use to reliably evade the tested sandboxes.</p><p style="padding-top: 2pt;padding-left: 7pt;text-indent: 10pt;text-align: left;">As the authors of SandPrint note, <i>“most of the selected features are deterministic and their values discrete and reliable,” </i>and <i>“a stealthy sandbox could try to diversify the feature values.” </i>Inspired by this observation, our aim in this paper is to explore what the next step of attackers might be, once sandbox operators begin to diversify the values of the above features, and to conﬁgure their systems using more realistic settings, rendering sandbox-ﬁngerprinting ineffective. To that end, instead of focusing on features characteristic to sandboxes, we take a radically different view and focus on artifacts characteristic to real, <i>used </i>machines. Previous works have shown that sandboxes are conﬁgured differently than real systems, and can thus be easily ﬁngerprinted. The programs used to analyze malware are designed to be as transparent as possible, to prevent malware from detecting that it is being analyzed. In this work, we show that even with completely transparent analysis programs, the environment outside the analysis program is enough for malware to determine that it is under analysis.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="III."><p style="padding-left: 79pt;text-indent: -18pt;text-align: left;">Wear and Tear Artifacts</p><p style="padding-top: 7pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 7pt;text-indent: 10pt;text-align: justify;">To determine the extent to which a system has been actually used, and consequently, the plausibility of it being a real user system and not a malware sandbox, malicious code can rely on a broad range of artifacts that are indicative of the wear and tear of the system. In this section, we discuss an indicative set of the main types of such artifacts that we have identiﬁed, which can be easily probed by malware.</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 11pt;text-align: justify;">Our strategy for selecting these artifacts was based on identifying what aspects of a system are affected as a result of normal use, and <i>not </i>on system features that may be affected by certain sandbox-speciﬁc implementation intricacies—a realistically conﬁgured sandbox may not exhibit any such features at all. We located these artifacts by using a method similar to the snowball method for conducting literature surveys. Speciﬁcally, upon identifying a potentially promising artifact, we would search in that same location of the system for more artifacts. Besides intuition, to identify additional sources of artifacts, we also studied various Windows “cleaner” and “optimizer” programs, as well as Windows forensics literature.</p><p style="padding-top: 2pt;padding-left: 7pt;text-indent: 10pt;text-align: justify;">Our list of artifacts is clearly non-comprehensive and we are certain that there are many more good sources of artifacts that were not included in this study. At the same time, although it is expected that one can ﬁnd a multitude of wear-and-tear artifacts, e.g., as a result of the customization, personalization, and use of different applications on an actual user system, our selection was constrained by an important additional requirement.</p><ol id="l4"><li data-list-text="A."><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Probing for Artifacts while Preserving User Privacy</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">We can distinguish between two main types of wear-and-tear artifacts, depending on their source: artifacts that stem from <i>direct </i>user actions, versus artifacts caused by <i>indirect </i>system activity. For instance, a browser’s history contains the URLs that a user has explicitly visited. Expecting to ﬁnd a popular search engine, a social networking service, and a news website among the recently visited URLs could constitute a heuristic that captures a user’s speciﬁc interests. In contrast, the number of application events in the system event log is an indirect artifact which, although it depends on user activity, it does not capture any private user information.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Direct artifacts are qualitatively stronger indicators of a system’s degree of use by a person. Conceivably, malware could rely on a broad and diverse range of such artifacts to decide whether a system has been under active use, e.g., by inspecting whether document folders contain plausible numbers of ﬁles with expected ﬁle extensions, checking for recently opened documents in popular document viewing applications, or looking for the most recently typed online search engine queries, system-wide (“spotlight-like”) search queries, instant messaging or email message contents, and so on.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">For the purposes of our study, however, such artifacts are out of question, as collecting them from real user systems would constitute a severe privacy violation. Consequently, we limit our study mainly to indirect, system-wide artifacts, which do not reveal any private user information. To get a glimpse on the evasion potential of direct artifacts, we do consider a limited set of browser-speciﬁc artifacts, which though are strictly limited to aggregate counts (e.g., number of cookies, number of downloaded ﬁles and, number of visited URLs) that can be collected without compromising user privacy and anonymity.</p></li><li data-list-text="B."><p class="s3" style="padding-top: 6pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Artifact Categories</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Many aspects of a system are susceptible to wear and tear, from the operating system itself, to the various ﬁle, network, and other subsystems. Considering, for instance, a typical Microsoft Windows host, a multitude of different wear-and-tear artifacts are available for estimating the extent to which the system has been used. In the following, we provide a brief description of the main types of artifacts that we have identiﬁed. The complete set of artifacts that we used in our experiments is shown in Table I.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l5"><li data-list-text="1)"><p class="s3" style="padding-left: 30pt;text-indent: -13pt;text-align: justify;">System: <span class="p">Generic system properties such as the number of running processes or installed updates are directly related to the “history” of a system, as more installed software typically accumulates throughout the years.</span></p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">The event log of Windows systems is another rich source of information about the current state and past activity of the system. Various types of events are recorded into the event log, including application, security, setup, and system events of different administrative ratings (critical, error, warning, information, audit success or failure). Of particular interest are events that denote abnormal conditions, such as warnings about</p><p style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: justify;">missing ﬁles, inaccessible network links, unexpected service terminations, and access permission errors. The more a system has been used, the higher the number of records that will have been accumulated in the event log. Besides the simple count of system events, we also consider additional aspects indicative of past use, such as the number of events from user applications, the number of different event sources, and the time difference between the ﬁrst and last event.</p><p style="padding-top: 2pt;padding-left: 7pt;text-indent: 9pt;text-align: justify;">The event log will be (almost) empty only if the operating system is freshly installed, or if the user deleted the recorded entries. The vast majority of users, however, are not even aware of the existence of this log, so it is unlikely that its contents will be affected (e.g., deleted) by explicit user actions.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2)"><p class="s3" style="padding-left: 31pt;text-indent: -13pt;text-align: justify;">Disk:  <span class="p">User activity results in ﬁle system changes, exhibited in various forms, including the generation of temporary ﬁles, deleted ﬁles, actual user content, cached data, and so on. Given the sensitive nature of accessing user-generated content, even in terms of just counting ﬁles, we limit the collection of disk artifacts directly related to user activity only to the number of ﬁles on the desktop and in the recycle bin. The rest of the disk artifacts capture counts of ﬁles related to non-user-generated temporary or cached data (e.g., generated ﬁle-content thumbnails, or process crash “minidump” ﬁles).</span></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="3)"><p class="s3" style="padding-left: 31pt;text-indent: -13pt;text-align: justify;">Network: <span class="p">The network activity of a system, especially from a historical perspective, is a strong indicator of actual use. Every time a host is about to send a packet to a remote destination, it consults the system’s address resolution protocol (ARP) cache to ﬁnd the physical (MAC) address of the gateway, or the address of another host in the local network. Similarly, every time a domain name is resolved to an IP address, the operating system’s DNS stub resolver includes it in a cache of the most recent resolutions. The use of public key encryption also results in artifacts related to the certiﬁcates that have been encountered. For instance, once a certiﬁcate revocation list (CRL) is downloaded, it is cached locally. The list of the URLs of previously downloaded CRLs is kept as part of the cached information, so the number of entries in that list is directly related to past network activity (not only due to browsing activity, but also due to applications that perform automatic updates over the network). We also consider the number of cached wireless network SSIDs, which is a good indicator of past use for mobile devices, and the number of active TCP connections.</span></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4)"><p class="s3" style="padding-left: 30pt;text-indent: -13pt;text-align: justify;">Registry: <span class="p">The Windows registry contains a vast amount of information about many aspects of a system, including many that would ﬁt in the aforementioned categories. We chose, however, to consider the Registry separately both because it is privy to information that does not exist elsewhere, as well as because, in Section V, we investigate whether sandbox- detection is possible if an attacker has to constrain himself to a single type of wear-and-tear artifacts.</span></p><p class="s3" style="padding-top: 3pt;padding-left: 23pt;text-indent: 0pt;text-align: center;">TABLE I: Complete list of wear-and-tear artifacts.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:10.1085pt" cellspacing="0"><tr style="height:12pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="text-indent: 0pt;text-align: center;">Category</p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Name</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Description</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">User</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Sandbox</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Baseline</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalProcesses</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of processes</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">94.4</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">35</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">41</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">winupdt</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># installed Windows updates</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">794</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">19</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">sysevt</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;"># system of system events</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">27K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">8K</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">334</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="text-indent: 0pt;text-align: center;">System</p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">appevt</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of application events</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">18K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2.4K</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">184</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">syssrc</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># sources of system events</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">78</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">49</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">48</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">appsrc</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># sources of application events</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">40</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">26</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">23</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">sysdiffdays</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Elapsed time since the ﬁrst system event (days)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">370</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.7K</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:12pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">appdiffdays</p></td><td style="width:250pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Elapsed time since the ﬁrst application event (days)</p></td><td style="width:39pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">298</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">943</p></td><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">recycleBinSize</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Total size of the recycle bin (bytes)</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2.5G</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">50M</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">recycleBinCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># ﬁles in the recycle bin</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">109</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">tempFilesSize</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Total size of temporary system ﬁles (bytes)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">302</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">24</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">8.2</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">tempFilesCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;"># temporary system ﬁles</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">411</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">60</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">10</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="text-indent: 0pt;text-align: center;">Disk</p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">miniDumpSize</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Total size of process crash minidump ﬁles (bytes)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3M</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">409K</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">miniDumpCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of process crash minidump ﬁles</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">9</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">4</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">thumbsFolderSize</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Total size of the system’s thumbnails folder (bytes)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">63M</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">8M</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2.6M</p></td></tr><tr style="height:12pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">desktopFileCount</p></td><td style="width:250pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># ﬁles on the desktop</p></td><td style="width:39pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">34</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">6</p></td><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">ARPCacheEntries</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># entries in the ARP cache</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">19</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">4.5</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">5</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">dnscacheEntries</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># entries in the DNS resolver cache</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">151</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">4</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3</p></td></tr><tr style="height:22pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-top: 5pt;text-indent: 0pt;text-align: center;">Network</p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">certUtilEntries</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">wirelessnetCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># URLs of previously downloaded CRLs</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"># of cached wireless SSIDs</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.7K</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">8</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">210</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">6</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:12pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">tcpConnections</p></td><td style="width:250pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of active TCP connections</p></td><td style="width:39pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">77</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">27</p></td><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">16</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">regSize</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Size of the registry (in bytes)</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">144.8M</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">53M</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">35M</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">uninstallCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># registered software uninstallers</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">177</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">58</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">18</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">autoRunCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># programs that automatically run at system startup</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">9</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalSharedDlls</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Legacy DLL reference count</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">242</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">176</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">26</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalAppPaths</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># registered application paths</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">54</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">35</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">23</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalActiveSetup</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># Active Setup application entries</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">24</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">32</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">25</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">orphanedCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># leftover registry entries</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">11</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">10</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">9</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalMissingDlls</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># registered DLLs that do not exist on disk</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">21</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">23</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">13</p></td></tr><tr style="height:22pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-top: 5pt;text-indent: 0pt;text-align: center;">Registry</p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">usrassistCount</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">shimCacheCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of entries in the UserAssist cache (frequently opened applications)</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"># entries in the Application Compatibility Infrastructure (Shim) cache</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">222</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">191K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">98</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">98K</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">11</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">38K</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">MUICacheEntries</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># Multi User Interface (MUI) cache entries</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">66</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">83</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">163</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">FireruleCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of rules in the Windows Firewall</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">511</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">332</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">358</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">deviceClsCount</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># previously connected USB devices (DeviceInstance IDs)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">81</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">29</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">60</p></td></tr><tr style="height:12pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">USBStorCount</p></td><td style="width:250pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># previously connected USB storage devices</p></td><td style="width:39pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.7</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">browserNum</p></td><td style="width:250pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># installed browsers (Internet Explorer, Firefox, Chrome)</p></td><td style="width:39pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2.9</p></td><td style="width:43pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.4</p></td><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">uniqueURLs</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># unique visited URLs</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">28K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">13.8</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.64</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalTypedURLs</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># URLs typed in the browser’s navigation bar</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1.6K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">4</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalCookies</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># of HTTP cookies</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3K</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">135</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr style="height:22pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-top: 5pt;text-indent: 0pt;text-align: center;">Browser</p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">uniqueCookieDomains</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">totalBookmarks</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># unique HTTP cookie domains</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"># bookmarks</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1003</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">274</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">23</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">20</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">1</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">totalDownloadedFiles</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"># downloaded ﬁles</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">340</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:11pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">urlDiffDays</p></td><td style="width:250pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Time elapsed between the oldest and newest visited URL (days)</p></td><td style="width:39pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">225</p></td><td style="width:43pt"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">370</p></td><td style="width:42pt;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr style="height:12pt"><td style="width:45pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:89pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">cookieDiffDays</p></td><td style="width:250pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Time elapsed between the oldest and newest HTTP cookie (days)</p></td><td style="width:39pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">303</p></td><td style="width:43pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">256</p></td><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">0</p></td></tr></table><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Every time an application or driver is installed on a Windows system, it typically stores many key-value pairs in the registry. This effect is so extensive that Windows is known from suffering from “registry bloat,” since programs often add keys during installation, but neglect to remove them when uninstalled. This is exempliﬁed by the multitude of “registry cleaning” tools which aim to clean the registry from stale entries [51], [52]. Many of the registry artifacts we consider are thus related to the footprints of the applications that have been installed on the system (e.g., number of installed applications, uninstall entries, shared DLLs, applications set to</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">automatically run upon boot), as well those that have not been fully uninstalled (e.g., “orphaned” entries left from removed programs and listed DLLs that do not exist on disk).</p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">We also consider various other system-wide properties, including: the size of the registry (in bytes); the number of ﬁrewall rules, as new applications often install additional rules; the number of previously connected USB removable storage devices (a unique instance ID key is generated for each device and stored in a cache); the number of entries in the UserAssist cache, which contains information about the most frequently opened applications and paths; the number of entries in the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Application Compatibility Infrastructure (Shim) cache, which contains metadata of previously run executables that used this facility; and the number of entries in the MUICache, which are related to previously run executables and are generated by the Multi User Interface that provides support for different languages.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="5)"><p class="s3" style="padding-left: 30pt;text-indent: -13pt;text-align: justify;">Browser: <span class="p">For many users, an operating system does little more than housing their web browser and a few other applications. Web browsers have become an all-inclusive tool for accessing ofﬁce suites, games, e-shopping, e-banking, and social networking services. Due to the indispensable use of a browser, it would be really uncommon to ﬁnd a browser in a pristine, out-of-the-box condition on a real user system.</span></p></li></ol></li></ol><p style="padding-left: 5pt;text-indent: 11pt;text-align: justify;">In fact, the older a system is, the longer the accumulated “history” of its main browser will likely be. This history is captured in various artifacts related to past user activity, including previously visited URLs, stored HTTP cookies, saved bookmarks, and downloaded ﬁles. As noted earlier, we consider only aggregate counts of such artifacts, instead of more detailed data, to respect users’ privacy. Given that a person may use more than one browser, or a different one than the operating system’s default browser, the browser artifacts that we consider correspond to combined values across all browsers found on the system (our tool currently supports Internet Explorer, Firefox, and Chrome). For example, the number of HTTP cookies corresponds to the total number of cookies extracted from all installed browsers. The number of installed browsers is also considered as a standalone artifact.</p></li><li data-list-text="IV."><p style="padding-top: 6pt;padding-left: 99pt;text-indent: -17pt;text-align: left;">Data Collection</p><ol id="l6"><li data-list-text="A."><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Probe Tool Implementation</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">To gather a large and representative dataset of the identiﬁed wear-and-tear artifacts from real user systems and malware sandboxes, we implemented a probe tool that collects artifact information and transmits it to a server. The probe tool was implemented in C++ and consists of a single Windows 32-bit PE ﬁle that does not require any installation, and which does not have any dependencies besides already available system APIs. Although many artifacts are easy to collect by simply accessing the appropriate log ﬁles and directories, probably the most challenging aspect of our implementation was to maximize compatibility with as many Windows versions as possible, from Windows XP to Windows 10. Besides differences in the paths of various system ﬁles and directories across major versions, in many cases we also had to use different system APIs for Windows XP compared to more recent Windows versions for various system-related artifacts (e.g., event log statistics). Browser artifacts are collected separately for each of the three supported browsers (IE, Firefox, Chrome) that are found on a given system, and are synthesized into compound artifacts at the server side.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">The collected information is transmitted to our server through HTTPS. The tool uses both GET and POST requests, in case either of the two is blocked by a sandbox. Besides the collected data, additional metadata for each submission include the IP</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">address of the host, OS version and installation date, and BIOS vendor. The latter is used as a simple VM-detection heuristic, to prevent poisoning of our real-user dataset with any results from virtual machines (we explicitly asked users to run the tool only on their real systems).</p><p style="padding-left: 5pt;text-indent: 10pt;text-align: justify;">Each executable submitted to a public sandbox is generated with a unique embedded ID, which allows us to identify multiple submissions by the same vendor. Since a given unique instance of the tool may run on more than one sandboxes (e.g., due to the use of multiple different sandboxes by the same vendor, or due to sample sharing among vendors), we additionally distinguish between different systems based on the combination of the following keys: reported IP address, OS installation date, Windows version, BIOS vendor, number of installed user applications, and elapsed time since the ﬁrst system event.</p></li><li data-list-text="B."><p class="s3" style="padding-top: 7pt;padding-left: 19pt;text-indent: -13pt;text-align: left;">IRB Approval and User Involvement</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 10pt;text-align: right;">Our experiments for the collection of artifact values from real user systems involved human subjects, and thus we had to obtain institutional review board (IRB) approval prior to conducting any such activity. Our IRB application included a detailed description of the information to be collected, the process a participant would follow, and all the measures that were taken to protect the participants’ privacy and anonymity. Our activities did not expose users to any risk. The collected data does not include any form of personally identiﬁable information (PII), nor any such information can be derived from it. Due to the nature of our experiment (collecting simple system statistics), our probe tool is small and simple enough so that we can be conﬁdent about the absence of any ﬂaws or bugs that would cause damage or mere inconvenience to a user’s system and data. The tool does not get installed on the system, and thus users can simply delete the downloaded executable to remove all traces of the experiment. The collected data merely reﬂects the wear and tear of a user’s system as a result of normal use, rather than some personal trait that could be considered PII. Even when considering the full information that is recorded in the transmitted data, no personal information</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">about the user of the system can be inferred.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Based on the above, the IRB committee of our institution approved the research activity on April 11, 2016.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">All participants (colleagues, friends, and Amazon’s Mechan- ical Turk workers) were directed to a web page that includes an overview of the experiment, a detailed description of the collected information (including a full sample report from one of the authors’ laptop), and instructions for downloading and executing our probe tool (as well as deleting it afterwards). The page was hosted using our institution’s second-level domain and TLS certiﬁcate, and included information about the IRB approval, as well as the authors’ full contact details.</p><p style="padding-left: 5pt;text-indent: 9pt;text-align: justify;">Given that our email requests to friends and colleagues for downloading and executing a binary from a web page could be considered as spear phishing attempts, we pointed to proof for the legitimacy of the message, which was hosted under the authors’ institutional home pages.</p><p class="s3" style="padding-top: 3pt;padding-left: 8pt;text-indent: 0pt;text-align: justify;">TABLE II: Distribution of BIOS vendors of users’ machines.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:35.467pt" cellspacing="0"><tr style="height:13pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-left: 6pt;text-indent: 0pt;line-height: 10pt;text-align: left;">BIOS vendor</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-right: 6pt;text-indent: 0pt;line-height: 10pt;text-align: right;">Frequency</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">American Megatrends Inc.</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">25.77%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Dell Inc.</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">18.08%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Insyde</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">15.38%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Lenovo</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">15.38%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Hewlett-Packard</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">6.92%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Award Software International Inc.</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">3.85%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Phoenix Technologies Ltd.</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">3.85%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Acer</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.92%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">AMI</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.92%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Intel Corp.</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.92%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Alienware</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.54%</p></td></tr><tr style="height:12pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Toshiba</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.54%</p></td></tr><tr style="height:13pt"><td style="width:139pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Other</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">1.93%</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="C."><p class="s3" style="padding-left: 21pt;text-indent: -14pt;text-align: left;">Data Collection</p><p style="padding-top: 6pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">To quantify the difference of wear-and-tear artifacts be- tween real users and sandbox environments, we use the aforementioned probing tool to compile three datasets. The ﬁrst dataset contains wear-and-tear artifacts collected from 270 real user machines (<i>D</i><i>real</i>). The majority of these observations (89.4%) originate from Amazon Mechanical Turk workers, who downloaded and executed our artifact-probing tool, and the remaining from systems operated by friends and colleagues. The users who participated in this study come from 35 different countries, with the top countries being: US (44%), India (18%), GB (10%), CA (8%), NL (1%), PK (1%), RU (1%) and 28 other</p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">countries with lower than 1% frequency. Therefore, we argue that our dataset is representative of users from both developed and developing countries, whose machines may have different wear-and-tear characteristics. The BIOS vendor distribution of the user systems is shown in Table II. As the table shows, the users’ personal systems include different brands, such as Dell, HP, Lenovo, Toshiba, and Acer, as well as game series systems such as Alienware.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">As mentioned earlier, our tool does not collect any PII and does not affect the user’s machine in any way, i.e., it does not modify or leave any data. After running the tool, the user can simply delete the executable.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">While analyzing the collected data from Mechanical Turk to ﬁlter out those users who, despite our instructions, executed our tool inside a virtual machine (identiﬁed through the collected BIOS information), we observed that our server had collected artifacts that could not be traced back to Mechanical Turk workers. By analyzing the artifacts and the logs of our server, we realized that, because the public Human Intelligence Task (HIT) web page for our task on Amazon’s website was pointing to our tool download page through a link, the crawlers of a popular search engine followed that link, downloaded our probing tool, and executed it. Based on the IP address space of the clients who reported these artifacts, as well as custom identiﬁers found in the reported BIOS versions, we are conﬁdent that these were sandbox environments that</p><p style="padding-top: 7pt;padding-left: 7pt;text-indent: 0pt;text-align: justify;">are associated with a popular search engine that downloads and executes binaries as a way of proactively discovering malware. After removing duplicate entries, we marked the rest as belonging to “crawlers” and incorporated them in our sandbox artifact dataset (described in the next paragraph).</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">The second dataset (<i>D</i><i>sand</i>) consists of artifacts extracted by sandboxes belonging to various malware analysis services. We identiﬁed these sandboxes through prior work on sandbox evasion [23], as well as by querying popular search engines for keywords associated with malware analysis. Most sandboxes are not available for download, but do allow users to submit suspicious binaries which they then analyze and report on the activity of the analyzed binary, in varying levels of detail. Even though we were able to ﬁnd 23 sandboxes that provide users the ability to upload suspicious ﬁles, our artifact-gathering server was able to collect artifacts from 15 different sandbox environments (not counting the aforementioned search-engine sandbox). We reason that the remaining analysis environments are either non-operational, rely on static analysis to scan executables, or completely block any network activity of each analyzed binary.</p><p style="padding-left: 7pt;text-indent: 9pt;text-align: justify;">Table III lists the names of sandboxes from which our server received the results of our probing tools. We uploaded our probing tool multiple times in a period of a month and we also witnessed that some sandboxes executed our probing tool multiple times on different underlying environments (e.g., multiple versions of Microsoft Windows). As mentioned in Section IV-A, each uploaded executable had a unique ID embedded in its code which was sent to our artifact-gathering server, so as to perform accurate attribution.</p><p class="s3" style="padding-left: 6pt;text-indent: 10pt;text-align: justify;"><span class="p">The third and ﬁnal dataset (</span>D<span class="s10">base</span><span class="p">) is our baseline dataset which consists of artifacts extracted from fresh installations of multiple versions of Microsoft Windows. Next to setting up local VMs and installing Microsoft Windows XP, Windows Vista, Windows 7, and Windows 8, we also make use of all the Windows server images available in two large public cloud providers, Azure and AWS. Overall, </span>D<span class="s10">base</span> <span class="p">contains the artifacts extracted from 22 baseline environments.</span></p></li><li data-list-text="D."><p class="s3" style="padding-top: 7pt;padding-left: 21pt;text-indent: -14pt;text-align: justify;">Dataset Statistics</p></li></ol><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Table IV shows the number of different Microsoft Windows versions in our three collected datasets. There we see that the vast majority of users are utilizing Windows 7, 8 and 10, with only 4.1% of users still utilizing Windows XP and Windows Vista. Contrastingly, we see almost no sandboxes utilizing Windows 10, and the majority of them (83.7%) utilizing Windows 7. Note that because we extract the version of Windows programmatically, the same version number can correspond to more than one Windows versions, such as, Windows Server 2012 R2 and Windows Server 2016 having the same version with Windows 8.1 and Windows 10. Even though it is not the central focus of our paper, we ﬁnd it troublesome that sandboxes do not attempt to follow the distribution of operating systems from real user environments.</p><p style="padding-left: 7pt;text-indent: 10pt;text-align: justify;">Figure 1 shows boxplots that reveal the distribution of the values of each wear-and-tear artifact across all three datasets</p><p class="s11" style="padding-top: 2pt;padding-left: 32pt;text-indent: 0pt;text-align: center;">User  Sandbox  Baseline</p><p class="s12" style="padding-top: 7pt;padding-left: 17pt;text-indent: 0pt;text-align: left;">1.00</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 1pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Normalized value</p><p style="text-indent: 0pt;text-align: left;"/><p class="s12" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.75</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.50</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.25</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">n_arpcacheEntries</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">n_dnscacheEntries</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">n_certUtilEntries</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">n_tcpConnections</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_recycleBinCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_recycleBinSize</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_tempFilesSize</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_tempFilesCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_miniDumpSize</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_miniDumpCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_thumbsFolderSize</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_totalProcesses</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">d_desktopFileCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_appevt</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_appdiffdays</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_sysevt</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_sysdiffdays</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_syssrc</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_appsrc</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">e_winupdt</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_regSize</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_uninstallCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_orphanedCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_shimCacheCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_deviceClsCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_InstalledApps</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_autoRunCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_totalApps</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_usrassistCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_MUICacheEntries</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_FireruleCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_totalSharedDlls</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">r_totalMissingDlls</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">totalBookmarks</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">totalCookies</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">uniqueCookieDomains</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">cookieDiffDays</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">totalTypedURLs</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">totalDownloadedFiles</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">uniqueURLs</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">urlDiffDays</p><p style="text-indent: 0pt;text-align: left;"/><p class="s13" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">b_num</p><p style="text-indent: 0pt;text-align: left;"/><p class="s12" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.00</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 21pt;text-indent: 0pt;text-align: center;">System artifacts</p><p class="s3" style="padding-top: 7pt;padding-left: 56pt;text-indent: 0pt;text-align: left;">Fig. 1: Distribution of artifacts across user machines, sandboxes, and baselines (normalized values).</p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">TABLE III: Sandboxes from which artifacts were successfully collected.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:60.464pt" cellspacing="0"><tr style="height:13pt"><td style="width:23pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">ID</p></td><td style="width:69pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">Name</p></td><td style="width:52pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="text-indent: 0pt;line-height: 10pt;text-align: center;">#Instances</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td><td style="width:69pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Anubis</p></td><td style="width:52pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">2</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">2</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Avira</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">2</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">3</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Drweb</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">3</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">4</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Fortiguard</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">3</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">5</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Fsecure</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">2</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">6</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Kaspersky</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">15</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">7</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">McAfee</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">7</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">8</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Microsoft</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">9</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">HybridAnalysis</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">10</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Pctools</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">11</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Crawlers</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">50</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">12</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Malwr</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">2</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">13</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Sophos</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">4</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">14</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">ThreatTrack</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">3</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">15</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Bitdefender</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td></tr><tr style="height:12pt"><td style="width:23pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">16</p></td><td style="width:69pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">Minotaur</p></td><td style="width:52pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="text-indent: 0pt;text-align: center;">1</p></td></tr></table><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">TABLE IV: Distribution of operating systems in each dataset.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:9.121pt" cellspacing="0"><tr style="height:11pt"><td style="width:80pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">v5.1</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">v6.0</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">v6.1</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">v6.2</p></td><td style="width:31pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-right: 6pt;text-indent: 0pt;line-height: 9pt;text-align: right;">v6.3</p></td><td style="width:31pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s6" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">Total</p></td></tr><tr style="height:11pt"><td style="width:80pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>Users </b>(<span class="s16">D</span><i>real</i>)</p></td><td style="width:27pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">8</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">3</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">105</p></td><td style="width:26pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">7</p></td><td style="width:31pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">147</p></td><td style="width:31pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 10pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">270</p></td></tr><tr style="height:11pt"><td style="width:80pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>Sandboxes </b>(<span class="s16">D</span><i>sand</i>)</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">14</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">-</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">82</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">-</p></td><td style="width:31pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">2</p></td><td style="width:31pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 10pt;text-indent: 0pt;text-align: center;">98</p></td></tr><tr style="height:12pt"><td style="width:80pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>Baseline </b>(<span class="s16">D</span><i>base</i>)</p></td><td style="width:27pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">1</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">1</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">2</p></td><td style="width:26pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 5pt;text-indent: 0pt;text-align: right;">1</p></td><td style="width:31pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">17</p></td><td style="width:31pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s7" style="padding-left: 10pt;text-indent: 0pt;text-align: center;">22</p></td></tr><tr style="height:53pt"><td style="width:247pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" colspan="7"><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">v5.1: Windows XP</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;padding-right: 96pt;text-indent: 0pt;line-height: 112%;text-align: left;">v6.0: Windows Vista / Win Server 2008 v6.1: Win7, Win Server 2008 R2</p><p class="s7" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">v6.2: Win8 / Win Server 2012</p><p class="s7" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">v6.3: Win 8.1/Win 10/ Win Server 2012 R2/ Win Server 2016</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;text-align: justify;"><span class="p">(</span>D<span class="s10">real</span><span class="p">, </span>D<span class="s10">sand</span> <span class="p">and, </span>D<span class="s10">base</span><span class="p">). There we can observe multiple patterns that will be of use later on in this paper. For example, we see that the vast majority of artifacts have larger values in</span></p><p style="padding-top: 8pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">real user systems, than they have in sandboxes and baselines. This observation, by itself, indicates that these artifacts can be used to differentiate between real machines and sandboxes and can thus be used for malware evasion purposes. Similarly, we also observe that the distributions of artifact values is wider for real systems than it is for systems that are not used by real users. This could indicate that these artifacts could also be used to predict the age of any given machine.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">At the same time, we do see certain cases where the opposite behavior manifests. For instance, the appdiffdays and sysdiffdays artifacts are clearly more diverse in sandboxes than they are in real user systems. We argue that the explanation for this behavior is two-fold. As Table IV suggests, on average, sandboxes are “older” compared to real-user systems. As such, it is entirely within reason that the events in Windows’ event log are further apart than those in real user systems. Moreover, assuming that the Windows log will only store events up to a maximum number, systems with more real-user activity are more likely to need to delete older events and hence reduce the time span observable in the Windows event log.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">To verify, from a statistical point of view, the difference that we can visually identify between the distributions of artifacts, we need to use a metric that will allow us to differentiate between different distributions. Even though a normal distribution is usually assumed, by conducting a Shapiro-Wilk test we ﬁnd that none of our extracted artifacts matches a normal distribution. For that reason, we use the Mann-Whitney U test to compare distributions, which is a non-parametric alternative of a t-test and does not assume that the data is normally distributed. We handle missing values by replacing them with dummy-coded values because the fact that an artifact cannot be extracted can be useful information for differentiating between systems.</p><p class="s3" style="padding-left: 6pt;text-indent: 9pt;text-align: justify;"><span class="p">Figure 2 shows the effect size of the differences between the distribution of </span>D<span class="s10">real</span> <span class="p">and </span>D<span class="s10">sand</span> <span class="p">as reported by the Mann-</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Whitney U test. Using standard interpretations of effect sizes, an effect between 0.3 and 0.5 is considered to be characteristic of a “medium” effect while one higher than 0.5 is considered to be a “strong” effect. This conﬁrms that the vast majority of our identiﬁed wear-and-tear artifacts have different distributions in sandbox and real-user environments.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="V."><p style="padding-left: 67pt;text-indent: -13pt;text-align: left;">Evading Malware Sandboxes</p><p style="padding-top: 6pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">In the previous sections, we described the type of OS artifacts that we hypothesized would be indicative of wear and tear, and collected these artifacts from real user machines, sandboxes, and fresh installations of operating systems in virtualized environments. As our results showed, most artifacts have sufﬁciently different distributions, allowing them to be used to predict whether a given system is an artiﬁcial environment or a real user system, and evade the former while executing on the latter. In this section, we take advantage of these artifacts and treat them as features in a supervised machine-learning setting, allowing the implementation of simple decision trees that can be employed by malware for evasion purposes.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l7"><li data-list-text="A."><p class="s3" style="padding-left: 20pt;text-indent: -13pt;text-align: justify;">Setup and Classiﬁer</p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">When we were considering which classiﬁer to use, we came to the conclusion that explainability of the results is a desirable property for our setup. It is important for the security community to understand how these seemingly benign features are different between real user systems and sandbox environments. Moreover, attackers can also beneﬁt from a classiﬁer with explainable results since they can, in real time, reason whether the result of their classiﬁer makes intuitive sense given the execution environment. As such, even if an SVM-based classiﬁer may perform slightly better than most explainable supervised learning algorithms, attackers have no way of evaluating the truthfulness of the result, especially in environments that are constantly evolving to bypass their evasion techniques.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">For these reasons, we decided to use decision trees as our algorithm of choice. Next to their explainable results, a decision- tree model is also straightforward to implement as a series of if-else statements, which can be beneﬁcial for attackers who wish to keep the overall footprint of their malware small. Before training our classiﬁer, we inspected the correlation of pairs of features by calculating the Pearson correlation coefﬁcient</p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">(<i>r</i>) for each possible pair. The results showed that four pairs of features have a strong correlation (<i>r &gt; </i>0.7). We decided, however, to include all features in our classiﬁer, since from the point of view of defenders, they would have to address all correlated features in order to stop malware from successfully evading their analysis systems.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">The training set of the classiﬁer is composed as follows. For positive examples, we randomly sample 50% of our sandbox observations (49 instances) and add to them 100% (22 instances) of our fresh OS installations. We consider it important to augment the sandbox dataset (<i>D</i><i>sand</i>) with our baseline dataset (<i>D</i><i>base</i>) to cover a wider range of possible</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">sandbox environments, starting from the most basic virtualiza- tion environments, to state-of-the-art sandboxes belonging to the security industry. To balance this data, we randomly sample 71 instances from real-user environments collected through Amazon Mechanical Turk (<i>D</i><i>real</i>). Therefore, our <i>training set </i>consists of 142 observations, balanced between the two classes. Similarly, our <i>testing dataset </i>comprises the remaining 50% of sandbox observations (49 instances) and a random sample of 49 real user machines which were not part of our training set. We handle missing feature values by setting them equal to zero.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">To improve the accuracy of our classiﬁer, we utilize two orthogonal techniques. First, we use a 10-trial adaptive boosting where the algorithm creates multiple trees, with each tree focusing on improving the detection of the previous tree [53]. Speciﬁcally, while constructing <i>tree</i><i>i</i>, the algorithm assigns larger weights to the observations misclassiﬁed by <i>tree</i><i>i</i><span class="s18">−</span><span class="s19">1</span>, aiming to improve the detection rate for these observations. Through the construction of multiple sequential trees, the adaptive boosting decision tree algorithm can learn boundaries that a single decision tree could not. Note that this choice does not really complicate the implementation of this algorithm by malware, as it can still be implemented as multiple sets of if- else rules, and use a weighted sum of all predictions according to the weights speciﬁed by the trained model.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">In addition to adaptive boosting, we specify our own cost matrix where false negatives are ten times more expensive than false positives. The rationale for this decision is that we assume it is preferable for malware, from the point of view of the malware author, to miss an infection of a real user’s machine (false positive), rather than to execute in a sandbox environment where its detection would mean the creation of signatures that would jeopardize its ability to infect systems protected with antivirus software.</p></li><li data-list-text="B."><p class="s3" style="padding-top: 7pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Evaluation</p></li></ol><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Using the aforementioned training dataset and parameters, we trained an adaptive boosting decision tree and evaluated it on the testing set. Figure 3 shows three of the ten trees that our classiﬁer generated, as well as the fraction of misclassiﬁcation of each ﬁnal decision which, as described earlier, drives the construction of the next tree.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">Note that the testing set was not provided to our algorithm during training, in an attempt to quantify how well our model generalizes to previously unseen data. Our model achieved an accuracy of 92.86% on the testing set, with a false-negative rate (FNR) of 4.08% and a false positive rate (FPR) of 10.20%. The ten constructed trees had an average tree size of 4.6 splits, with the shortest tree having 3 splits and the longest one 5 splits. Table V shows the features that were the most useful to the algorithm, and the percentage of trees using any given feature.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">To assess the robustness of our algorithm against incremental changes in sandbox environments, we repeated our aforemen- tioned experiment 30 times, each time removing an additional feature from the original datasets, compiling new, randomly</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Effect Size</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.6</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.4</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.2</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 6pt;text-indent: -2pt;line-height: 154%;text-align: right;">d_miniDumpCount d_miniDumpSize r_totalSharedDlls r_orphanedCount e_appdiffdays e_sysdiffdays r_totalMissingDlls d_tempFilesSize</p><p class="s21" style="padding-left: 4pt;text-indent: 20pt;line-height: 154%;text-align: right;">urlDiffDays e_sysevt d_tempFilesCount</p><p class="s21" style="text-indent: 0pt;text-align: right;">r_usbCount</p><p class="s21" style="padding-top: 3pt;text-indent: 0pt;text-align: right;">r_MUICacheEntries</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-left: 6pt;text-indent: 12pt;line-height: 154%;text-align: right;">totalTypedURLs n_wirelessnetCount r_usrassistCount r_shimCacheCount d_thumbsFolderSize d_recycleBinSize r_InstalledApps d_recycleBinCount</p><p class="s21" style="padding-left: 18pt;text-indent: 14pt;line-height: 154%;text-align: right;">r_totalApps r_uninstallCount n_certUtilEntries cookieDiffDays</p><p class="s21" style="padding-left: 20pt;text-indent: 17pt;line-height: 154%;text-align: right;">e_appevt r_FireruleCount</p><p class="s21" style="padding-left: 13pt;text-indent: 23pt;line-height: 154%;text-align: right;">r_regSize e_winupdt r_autoRunCount n_tcpConnections</p><p class="s21" style="padding-left: 1pt;text-indent: 37pt;line-height: 154%;text-align: right;">e_appsrc d_desktopFileCount totalBookmarks n_arpcacheEntries totalDownloadedFiles uniqueCookieDomains</p><p class="s21" style="padding-left: 29pt;text-indent: 9pt;line-height: 154%;text-align: right;">e_syssrc totalCookies</p><p class="s21" style="padding-left: 10pt;text-indent: 34pt;line-height: 154%;text-align: right;">b_num n_dnscacheEntries</p><p class="s21" style="padding-left: 16pt;text-indent: 13pt;line-height: 154%;text-align: right;">uniqueURLs d_totalProcesses</p><p class="s21" style="text-indent: 0pt;text-align: right;">r_deviceClsCount</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">0.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 16pt;text-indent: 0pt;text-align: center;">Features</p><p class="s3" style="padding-top: 6pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Fig. 2: The difference of the distributions of a given artifact’s values between real user systems and sandboxes, based on the Mann-Whitney U test. An effect size above 0.3 (highlighted with light yellow) can be interpreted as a medium difference, while an effect size above 0.5 (highlighted with red) corresponds to a high difference between the two distributions.</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 140pt;text-indent: 0pt;text-align: center;">1</p><p class="s22" style="padding-top: 2pt;padding-left: 140pt;text-indent: 0pt;text-align: center;">regartifacts_deviceClsCount</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 134pt;text-indent: 0pt;text-align: center;">1</p><p class="s22" style="padding-top: 2pt;padding-left: 134pt;text-indent: 0pt;text-align: center;">regartifacts_autoRunCount</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 75pt;text-indent: 0pt;text-align: center;">1</p><p class="s22" style="padding-top: 2pt;padding-left: 75pt;text-indent: 0pt;text-align: center;">evtartifacts_syssrc</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 119pt;text-indent: 0pt;text-align: center;">2</p><p class="s22" style="padding-top: 2pt;padding-left: 119pt;text-indent: 0pt;text-align: center;">cookieDiffDays</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">42  </span><span class="s24"> </span><span class="s22">42</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: right;"><span class="s24"> </span><span class="s22">4   </span><span class="s24"> </span><span class="s22">4</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 44pt;text-indent: 0pt;text-align: center;">2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 112pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">61  </span><span class="s24"> </span><span class="s22">61</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 25pt;text-indent: 0pt;text-align: center;">2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 18pt;text-indent: 0pt;text-align: center;">3</p><p class="s22" style="padding-top: 2pt;padding-left: 18pt;text-indent: 0pt;text-align: center;">regartifacts_autoRunCount</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 2pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">971    </span><span class="s24"> </span><span class="s22">971</span></p><p class="s22" style="padding-top: 2pt;padding-left: 34pt;text-indent: 0pt;text-align: left;">diskartifacts_totalProcesses</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 37pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">81   </span><span class="s24"> </span><span class="s22">81</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 18pt;text-indent: 0pt;text-align: left;">3</p><p class="s22" style="padding-top: 2pt;padding-left: 34pt;text-indent: 0pt;text-align: left;">diskartifacts_totalProcesses</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 37pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">81   </span><span class="s24"> </span><span class="s22">81</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 18pt;text-indent: 0pt;text-align: left;">3</p><p class="s23" style="padding-top: 2pt;padding-left: 37pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">2  </span><span class="s24"> </span><span class="s22">2</span></p><p class="s22" style="padding-top: 1pt;padding-left: 73pt;text-indent: 0pt;text-align: left;">5</p><p class="s22" style="padding-top: 2pt;padding-left: 37pt;text-indent: 0pt;text-align: left;">regartifacts_usrassistCount</p><p class="s22" style="padding-top: 2pt;padding-left: 37pt;text-indent: 0pt;text-align: left;">netartifacts_certUtilEntries</p><p class="s22" style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;text-align: center;">netartifacts_tcpConnections</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 51pt;text-indent: 0pt;text-align: center;"><span class="s24"> </span><span class="s22">17  </span><span class="s24"> </span><span class="s22">17</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: center;"><span class="s24"> </span><span class="s22">83  </span><span class="s24"> </span><span class="s22">83</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 49pt;text-indent: 0pt;text-align: left;">Node 4 (n = 38) <span class="s25">1  </span>Node 5 (n = 40) <span class="s25">1  </span>Node 6 (n = 5) <span class="s25">1  </span>Node 7 (n = 59) <span class="s25">1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 40pt;text-indent: 0pt;text-align: left;"><span class="s24"> </span><span class="s22">367  </span><span class="s24"> </span><span class="s22">367</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Node 4 (n = 70) <span class="s25">1  </span>Node 5 (n = 7) <span class="s25">1  </span>Node 6 (n = 5) <span class="s25">1  </span>Node 7 (n = 60) <span class="s25">1</span></p><p class="s22" style="padding-top: 4pt;padding-left: 9pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Node 4 (n = 31) Node 6 (n = 8) Node 7 (n = 26) Node 8 (n = 1) Node 9 (n = 76)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 9pt;text-indent: 0pt;line-height: 2pt;text-align: left;">0.8</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Base</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: right;">1</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.6</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.4</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.2</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0</p><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: right;">1</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.6</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.4</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.2</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0</p><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: right;">1</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.6</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.4</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.2</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0</p><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: right;">1</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.6</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.4</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.2</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0</p><p class="s22" style="text-indent: 0pt;line-height: 5pt;text-align: right;">1</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.8</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.6</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.4</p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0.2</p><p class="s22" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="text-indent: 0pt;text-align: right;">0</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 15pt;text-indent: 0pt;text-align: center;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 15pt;text-indent: 0pt;text-align: center;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">User</p><p style="text-indent: 0pt;text-align: left;"/><p class="s22" style="padding-left: 15pt;text-indent: 0pt;text-align: center;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-left: 12pt;text-indent: 0pt;text-align: center;">0</p><p style="padding-top: 4pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Fig. 3: Trees 1, 3, and 5, calculated by the C5.0 decision tree algorithm with adaptive boosting and a custom cost matrix that favors false positives over false negatives.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">sampled, training and testing datasets using the splits described earlier, and training and testing the new classiﬁer. Speciﬁcally, we remove the feature that was the most used by the previous model, i.e., the most important one. For example, the ﬁrst feature that we removed was the number of entries in a system’s DNS cache, as it was the most commonly used feature of our ﬁrst classiﬁer according to Table V. Through this process we aim to quantify an attacker’s ability of distinguishing sandboxes from real users, in the face of dedicated sandbox operators who can try to mimic a real user system by populating our identiﬁed wear-and-tear artifacts with realistic values.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">We argue that this setup captures the worst-case scenario for an attacker, because not only are there fewer and fewer features to train on, but also because the remaining features are of lower discriminatory power than the removed ones. Figure 4 shows how the accuracy, false positive rate, and false negative rate vary, as we keep on removing features from our dataset. As one can notice, the overall accuracy of the classiﬁer remains</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">high (greater than 90%) even if we remove as many as 20 discriminatory features.</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">Similarly, we see that, guided by our custom cost matrix, the classiﬁer constantly prefers to err on the side of false positives instead of false negatives. We even observe that for the ﬁrst eight features, the accuracy increases and the FPR/FNR rates decrease. This shows that some pattern that was learned by the training data concerning the removed features did not appear in the testing data, and thus removing these features, in fact, made the classiﬁer more accurate. The average accuracy of the ﬁrst 30 classiﬁers (removing from 0 to 29 features) is 91.5% with a FPR of 9.05% and a FNR of 7.96%. When the 30th feature is removed (out of 33 in total), the decision tree algorithm fails to train a model with accuracy greater than random chance, and quits.</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">To better understand how each type of artifact affects the accuracy of our classiﬁer, we retrained our model using only one type of artifacts at a time. Table VI shows the number of artifacts per category and the performance of each classiﬁer on</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><ul id="l8"><li data-list-text="●"><p class="s26" style="padding-left: 70pt;text-indent: -7pt;text-align: left;">Accuracy  False Negative Rate  False Positive Rate</p></li></ul><p class="s3" style="padding-top: 3pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">TABLE V: Features that the adaptive boosting decision trees rely on, and the percentage of trees utilizing them.</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-left: 34pt;text-indent: 0pt;line-height: 2pt;text-align: left;">●  <span class="s28">● ● ●</span></p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 10pt;text-indent: 0pt;line-height: 3pt;text-align: left;">● ● <span class="s29">● </span>● <span class="s29">● </span><span class="s30">● </span>● ● ●</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s31" style="text-indent: 0pt;line-height: 3pt;text-align: left;">●</p><p style="text-indent: 0pt;text-align: left;"/><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:13pt"><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-left: 7pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Category</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-left: 7pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Feature</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-right: 6pt;text-indent: 0pt;line-height: 10pt;text-align: right;">% of trees</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Network</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">dnscacheEntries</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">System</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">sysevt</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">System</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">syssrc</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Registry</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">deviceClsCount</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Registry</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">autoRunCount</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Browser</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">uniqueURLs</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">100.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Disk</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">totalProcesses</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">66.90%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Browser</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">cookieDiffDays</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">59.86%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Registry</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">usrassistCount</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">54.93%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Network</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">certUtilEntries</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">54.23%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">System</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">appevt</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">54.23%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Browser</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">uniqueCookieDomains</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">52.82%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Network</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">tcpConnections</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">50.00%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">System</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">winupdt</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">16.90%</p></td></tr><tr style="height:12pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Registry</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">MUICacheEntries</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">11.27%</p></td></tr><tr style="height:13pt"><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Network</p></td><td style="width:99pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">ARPCacheEntries</p></td><td style="width:57pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">4.93%</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><p class="s29" style="padding-left: 10pt;text-indent: 0pt;line-height: 2pt;text-align: left;">● <span class="s28">● ● </span>●     <span class="s31">●     ●</span></p><p class="s26" style="padding-left: 15pt;text-indent: 0pt;line-height: 7pt;text-align: left;">90   <span class="s32">●     </span><span class="s33">●</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s34" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Percentage</p><p style="text-indent: 0pt;text-align: left;"/><p class="s26" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">30</p><p class="s31" style="padding-left: 15pt;text-indent: 0pt;line-height: 4pt;text-align: left;">● <span style=" color: #5B5C5E;">●    </span><span class="s30">●     </span>●</p><p class="s35" style="padding-left: 29pt;text-indent: 0pt;line-height: 5pt;text-align: left;">●     <span class="s28">●    </span><span class="s31">●</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l9"><li data-list-text="●"><p style="padding-left: 54pt;text-indent: -2pt;text-align: left;"/></li></ul><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 33pt;text-indent: 0pt;text-align: left;">0           10          20          30</p><p class="s34" style="padding-left: 95pt;text-indent: 0pt;text-align: left;">Number of removed features</p><p class="s3" style="padding-top: 6pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Fig. 4: Variance of accuracy, false negative rate, and false positive rate of our boosted classiﬁer as we keep removing the topmost features. Even after removing tens of the features with the highest discriminatory capacity, the accuracy of the classiﬁer drops only slightly.</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 7pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">the unseen testing dataset. We can observe that, even though the classiﬁer based on registry artifacts had the most features available to it, it performed worse than the Network-based and Disk-based classiﬁers. This indicates that certain classes of artifacts have higher discriminatory power than the rest. At the same time, all classiﬁers achieve fairly high accuracy (some even have a 0% FNR), which suggests that malware authors can choose which category of artifacts they can focus on, without compromising the evasion capabilities of their malware. As such, malware authors who, for example, know that their samples will be analyzed by a sandbox that considers registry-related activity suspicious, can use the other types of wear-and-tear artifacts for both detecting the sandbox and avoiding raising suspicion.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Our results demonstrate that, not only is it possible to differentiate between real systems and sandboxes based on non-intrusive, sandbox-agnostic wear-and-tear artifacts, but that incremental patching approaches where one or two artifacts are made to look similar to those in real systems will not be sufﬁcient to prevent sandbox evasion.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="VI."><p style="padding-left: 65pt;text-indent: -18pt;text-align: left;">Estimating Actual System Age</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 11pt;text-align: justify;">In the previous section, we showed that wear-and-tear artifacts can be used to accurately differentiate between machines belonging to real users and sandbox environments. The underlying intuition is that sandbox environments do not “age” either at all, or clearly not in the same way as user environments. Based on this observation, in this section, we explore the possibility of predicting the age of a system based on the values of its wear-and-tear artifacts. This possibility would allow malware to assess whether a machine exhibits a realistic wear and tear that matches its reported age. At the same time, it would also enable researchers to artiﬁcially age malware sandboxes to match a desired age.</p><p class="s3" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">TABLE VI: Classiﬁer performance when trained only on a single type of artifacts (FNR = False Negative Rate, FPR = False Positive Rate).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:9.5965pt" cellspacing="0"><tr style="height:13pt"><td style="width:66pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Artifact Type</p></td><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">#Artifacts</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">Accuracy</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="padding-left: 4pt;text-indent: 0pt;text-align: center;">FNR</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s14" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">FPR</p></td></tr><tr style="height:12pt"><td style="width:66pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Network</p></td><td style="width:51pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">4</p></td><td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">95.92%</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">2.04%</p></td><td style="width:41pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">6.12%</p></td></tr><tr style="height:12pt"><td style="width:66pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Disk</p></td><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">5</p></td><td style="width:50pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">95.92%</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">0.00%</p></td><td style="width:41pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">8.16%</p></td></tr><tr style="height:12pt"><td style="width:66pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">System</p></td><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">5</p></td><td style="width:50pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">92.86%</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">0.00%</p></td><td style="width:41pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">14.29%</p></td></tr><tr style="height:12pt"><td style="width:66pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Registry</p></td><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">11</p></td><td style="width:50pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">93.88%</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">4.08%</p></td><td style="width:41pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">8.16%</p></td></tr><tr style="height:13pt"><td style="width:66pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Browser</p></td><td style="width:51pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">7</p></td><td style="width:50pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">92.86%</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-left: 4pt;padding-right: 4pt;text-indent: 0pt;text-align: center;">2.04%</p></td><td style="width:41pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s15" style="padding-right: 6pt;text-indent: 0pt;text-align: right;">12.24%</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l10"><li data-list-text="A."><p class="s3" style="padding-left: 19pt;text-indent: -13pt;text-align: left;">Correlation Between Age and Artifacts</p><p style="padding-top: 6pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">We begin this process by ﬁrst investigating the self-reported age of sandboxes and real user machines. Figure 5 shows the cumulative distribution function of the age of user systems and malware sandboxes. We can clearly see that, on average, user systems are much “newer” than sandboxes. Half of the users have systems less than a year old, yet 50% of sandboxes are less than two years old. This makes intuitive sense since most users update their hardware on a regular basis, while many sandboxes were setup once and are just reused over and over for a long period of time. At the same time, we see that the two distributions meet at the top, meaning that there some users have systems that are as old (or even older) than the oldest available sandboxes.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Having established their age, we can now investigate the extent to which each individual wear-and-tear artifact can potentially be used to predict an environment’s age. Figure 6 shows the Pearson correlation between the reported age and each wear-and-tear artifact for real user systems. We argue that changing the age reported by the OS is not only something that everyday users cannot do, but that they do not have any interest of doing. As such, we assume that the reported ages collected from real user systems are accurate.</p><p style="padding-top: 1pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">1.00</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Fraction of systems</p><p style="text-indent: 0pt;text-align: left;"/><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.75</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.50</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.25</p><p style="padding-top: 5pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.00</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">Users Sandboxes</p><p class="s3" style="padding-top: 3pt;padding-left: 17pt;text-indent: 0pt;text-align: left;">TABLE VII: Signiﬁcant coefﬁcients of linear regression for predicting the age of a system based on wear-and-tear artifacts.</p><p class="s36" style="padding-left: 41pt;text-indent: 0pt;line-height: 8pt;text-align: left;">0        4</p><p class="s36" style="padding-left: 123pt;text-indent: 0pt;line-height: 8pt;text-align: left;">System age</p><p class="s36" style="padding-left: 3pt;text-indent: 0pt;line-height: 9pt;text-align: left;">8       12</p><p class="s3" style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Fig. 5: CDF of the reported ages for sandboxes and real user machines.</p><p style="padding-top: 10pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">We see that many artifacts that were very successful in differentiating real machines from sandboxes do not, in fact, correlate with a machine’s age. By focusing on the artifacts that appear towards the middle of Figure 6 (having a correlation coefﬁcient close to zero), one can notice that these artifacts may be characteristic of user activity but they are also under a user’s control. Users can delete their cookies, visit more or fewer URLs than other users, delete downloaded ﬁles, and, in general, affect the values of these artifacts in unpredictable ways that prevent them from being indicative of system’s age. Similarly, there are other artifacts, such as the number of cached wireless networks, TCP connections, and ﬁrewall rules, which are not under the direct control of users, clearly do not correlate with age, yet vary sufﬁciently between sandboxes and real machines to be of use for differentiation.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">Towards the right end of Figure 6 we see the artifacts that appear to positively correlate with system age, such as the number of previously connected USBs, the number of install applications, and the elapsed time since the ﬁrst user event. These artifacts are either “proxies” of age (e.g., the longer a machine is used, the more applications are installed on it), or are direct sources of age information which, unlike HTTP cookies, are buried deeper in an OS’s internals, and are thus unlikely to be modiﬁed or deleted by users.</p></li><li data-list-text="B."><p class="s3" style="padding-top: 5pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Regression</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Having established that some artifacts positively correlate with age, we now attempt to identify the appropriate way of combining their raw values to estimate a system’s actual age. To that end, we ﬁrst process our dataset to remove artifacts with missing values in many of our observations. For artifacts with a high rate of missing values (more than 80% of their values are missing) we remove them from our dataset and do not attempt to utilize them any further. For the remaining 37 artifacts, we used the rest of the dataset to predict what would have been the most appropriate value, had we been able to extract it. We use a random-forest-based imputation technique, which is a standard way of handling missing values, without the need to remove entire observations and without relying on overly generic statistics, like a feature’s mean or mode, which could bias our results.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:3pt" cellspacing="0"><tr style="height:13pt"><td style="width:120pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-left: 7pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Feature</p></td><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="text-indent: 0pt;line-height: 10pt;text-align: center;">Coeﬁcient</p></td><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s8" style="padding-left: 7pt;text-indent: 0pt;line-height: 10pt;text-align: left;">p-Value</p></td></tr><tr style="height:13pt"><td style="width:120pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">diskartifacts:tempFilesCount</p></td><td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">0 2.92</p></td><td style="width:59pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0041 **</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">diskartifacts:totalProcesses</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">-2.12</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0364 *</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:appevt</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">02.39</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0186 *</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:sysevt</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">1.71</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0901 .</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:syssrc</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">-3.09</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0025 **</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:appsrc</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">2.57</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0114 *</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:regSize</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">2.70</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0080 **</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:uninstallCount</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">-2.07</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0411 *</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:deviceClsCount</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">1.85</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0664 .</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:InstalledApps</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">5.13</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">1.2e-06 ***</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:totalApps</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">1.99</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0490 *</p></td></tr><tr style="height:12pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">totalDownloadedFiles</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">2.11</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0368 *</p></td></tr><tr style="height:14pt"><td style="width:120pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">browser:num</p></td><td style="width:53pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="text-indent: 0pt;text-align: center;">-2.56</p></td><td style="width:59pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">0.0117 *</p></td></tr><tr style="height:25pt"><td style="width:232pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20" colspan="3"><p class="s9" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">Signiﬁcance Codes: 0 *** 0.001 ** 0.01 * 0.05 . 0.1</p><p class="s9" style="padding-top: 1pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Multiple R-Squared: 0.68, Adjusted R-Squared: 0.583</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"/><ol id="l11"><li data-list-text="1)"><p class="s3" style="padding-left: 30pt;text-indent: -13pt;text-align: justify;">Linear Regression: <span class="p">We ﬁrst attempt to use linear regres- sion, since this is a common regression method that works well in many contexts. In essence, we start with the formula </span>Y <span class="p">= </span>β<span class="s19">0</span><span class="p"> + </span>β<span class="s19">1</span>X<span class="s19">1</span><span class="p"> + </span>β<span class="s19">2</span>X<span class="s19">2</span><span class="p"> + </span>... <span class="p">+ </span>E <span class="p">where </span>X<span class="s10">i</span> <span class="p">is the value of any given artifact, and try to calculate the weights </span>β<span class="s10">i</span> <span class="p">that would allow us to sum the artifacts in a way that will provide a prediction of machine’s age (</span>Y <span class="p">).</span></p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">To train a linear regression model based on the real users’ dataset, we ﬁrst split the user dataset into two sets, one for training (60%) and one for testing (40%). We keep the test dataset aside to use it later to test how well our model generalizes on previously unseen data. Our linear regression model is trained on the training set, and we use a 10-fold cross validation to evaluate it, which results in a mean square error (MSE) of 1.23. The coefﬁcients of the model and their p-values are reported in Table VII. We see that 13 wear-and- tear artifacts correlate with a machine’s age in a statistically signiﬁcant way. Even though our model is not perfect, it can still explain up to 68% of the variability in a system’s age.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Since the training error does not necessarily guarantee the performance of our model when dealing with new data, we evaluate the accuracy of the linear regression model against the previously unseen test dataset. We ﬁrst apply our model to the unseen test dataset of systems belonging to real users to make sure that it can predict their age with sufﬁcient accuracy, and then proceed to use it to predict the age of sandboxes and compare it with their claimed age. The MSE of the predicted ages for the regular systems is 1.88, while sandboxes have a very high MSE of 6.25. Our results indicate that a model trained on real user data can not only predict the age of other unseen systems based on the values of their wear-and-tear artifacts, but it can also identify that a system’s artifacts are unrealistically high (or low) for its claimed age.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Figure 7 shows the CDF of the values of residuals when applying our linear regression model on systems from <i>D</i><i>real</i></p><p class="s21" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;text-align: left;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Correlation</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 19pt;text-indent: 0pt;text-align: left;">0.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">-0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 13pt;text-indent: 0pt;line-height: 154%;text-align: justify;">r_deviceClsCount d_totalProcesses n_tcpConnections</p><p class="s21" style="padding-left: 1pt;text-indent: 38pt;line-height: 154%;text-align: right;">e_syssrc uniqueCookieDomains d_thumbsFolderSize r_orphanedCount r_totalMissingDlls n_arpcacheEntries d_recycleBinSize d_miniDumpSize</p><p class="s21" style="padding-left: 10pt;text-indent: 34pt;line-height: 154%;text-align: right;">b_num totalCookies e_winupdt r_shimCacheCount d_recycleBinCount r_FireruleCount r_autoRunCount totalBookmarks d_miniDumpCount</p><p class="s21" style="padding-left: 4pt;text-indent: 25pt;line-height: 154%;text-align: right;">uniqueURLs totalTypedURLs n_wirelessnetCount n_certUtilEntries d_tempFilesSize totalDownloadedFiles</p><p class="s21" style="padding-left: 8pt;text-indent: 30pt;line-height: 154%;text-align: right;">e_appsrc cookieDiffDays r_usrassistCount e_sysdiffdays d_tempFilesCount r_uninstallCount d_desktopFileCount</p><p class="s21" style="padding-left: 9pt;text-indent: 27pt;line-height: 154%;text-align: right;">r_regSize r_totalApps e_appdiffdays urlDiffDays r_MUICacheEntries n_dnscacheEntries r_totalSharedDlls</p><p class="s21" style="padding-left: 31pt;text-indent: 7pt;line-height: 154%;text-align: right;">e_sysevt r_usbCount e_appevt</p><p class="s21" style="text-indent: 0pt;line-height: 7pt;text-align: right;">r_InstalledApps</p><p style="text-indent: 0pt;text-align: left;"/><p class="s21" style="padding-left: 17pt;text-indent: 0pt;text-align: left;">-0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 18pt;text-indent: 0pt;text-align: center;">Artifacts</p><p class="s3" style="padding-top: 6pt;padding-left: 23pt;text-indent: 0pt;text-align: center;">Fig. 6: Correlation between the reported age of user systems and each of the artifacts.</p><p style="padding-top: 8pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">TABLE VIII: Lasso regression coefﬁcients of the features selected as good predictors of system age by the model.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:43.1535pt" cellspacing="0"><tr style="height:14pt"><td style="width:124pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s37" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Feature</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s37" style="text-indent: 0pt;line-height: 11pt;text-align: center;">Coeﬁcient</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">netartifacts:dnscacheEntries</p></td><td style="width:55pt;border-top-style:solid;border-top-width:1pt;border-top-color:#231F20;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.1383</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">diskartifacts:tempFilesCount</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.0883</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:appevt</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.1345</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">evtartifacts:sysevt</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.1097</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:regSize</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.1160</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:InstalledApps</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.6432</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">regartifacts:totalApps</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">0.0559</p></td></tr><tr style="height:13pt"><td style="width:124pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">browser:num</p></td><td style="width:55pt;border-left-style:solid;border-left-width:1pt;border-left-color:#231F20;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#231F20;border-right-style:solid;border-right-width:1pt;border-right-color:#231F20"><p class="s38" style="text-indent: 0pt;text-align: center;">-0.0138</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">and <i>D</i><i>sand</i>. We see that although the majority of real user systems have a residual error approximately equal to zero (meaning that the predicted age closely matches the system’s actual age), the residuals when attempting to predict the age of sandboxes are much higher, i.e., the predicted age is much lower than the reported age, thereby shifting the distribution towards the right part of the graph.</p></li><li data-list-text="2)"><p class="s3" style="padding-top: 1pt;padding-left: 30pt;text-indent: -13pt;text-align: justify;">Lasso Regression: <span class="p">To explore whether a more involved regression model would result in better prediction accuracy, we also report the results of Lasso regression. Lasso regression penalizes the absolute size of the regression coefﬁcients, and sets the coefﬁcients of unnecessary features to zero, reducing in this way the size of our artifacts set. One of the beneﬁts of Lasso regression is that it typically utilizes less predicting variables than linear regression, which reduces the complexity of the overall model. In the case of malware, a smaller feature set means fewer API calls to the underlying OS, and thereby less chances of triggering suspicious activity monitors.</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">For our experiments, we split the datasets to three parts: training, evaluation, and testing. We ﬁrst train a Lasso model on the training set and make use of cross validation to ﬁnd the optimum <i>λ </i>value. We use the discovered value (<i>λ </i>= 0<i>.</i>145), as this minimizes the MSE of the model, and train our ﬁnal model. Table VIII shows the eight features that the Lasso model selected as good predictors of system age and their</p><p style="padding-top: 8pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">corresponding coefﬁcients. The only artifact that has a small negative coefﬁcient is the number of browsers installed on a system. One reasonable explanation for this is that owners of older systems may hesitate to install additional browsers, which has an effect on our trained model.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">By applying the model on the unseen dataset that consists of artifacts from real user systems (<i>D</i><i>real</i>), the MSE is 0.749, which is better than that of linear regression. The MSE on the testing sandbox dataset is 4.45, which again shows how the wear and tear of sandboxes does not match their claimed age. Figure 7 shows the residual errors of the trained Lasso regression model, and how these compare to the errors of the linear regression model. We observe that although both models can predict the age of real user systems (residual errors approximately equal zero), the Lasso model can better differentiate some sandboxes based on fewer artifacts compared to the linear regression model.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">Overall, we see that wear-and-tear artifacts can predict, with sufﬁcient accuracy, the real age of a system and thus reveal the age mismatch present in current sandboxes. As we mentioned earlier in this section, other than just improving our understanding of the relationship between artifacts and system age, our trained models can be of use to sandbox developers to help them create environments with wear and tear that matches their stated age.</p></li></ol></li></ol></li><li data-list-text="VII."><p style="padding-top: 7pt;padding-left: 116pt;text-indent: -22pt;text-align: left;">Discussion</p><ol id="l12"><li data-list-text="A."><p class="s3" style="padding-top: 4pt;padding-left: 20pt;text-indent: -13pt;text-align: justify;">Ethical Considerations and Coordinated Disclosure</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Our research sheds light to the problem of next-generation environment-aware malware based on wear and tear arti- facts. By demonstrating the effectiveness of this new evasion technique, we will hopefully bring more attention to this issue, and encourage further research on developing effective countermeasures. To that end, our preliminary investigation on predicting a systems’ age based on the evaluated artifact values can help sandbox operators to ﬁne-tune the wear-and-tear characteristics of their systems so that they look realistic. There have been very recent indications that malware authors have already started taking into consideration usage-related artifacts</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">Fraction of systems</p><p style="text-indent: 0pt;text-align: left;"/><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">1.00</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.75</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.50</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.25</p><p style="padding-top: 2pt;text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">0.00</p><p class="s36" style="padding-top: 8pt;padding-left: 14pt;text-indent: 0pt;text-align: center;">LM-sandbox LM-user Lasso-sandbox Lasso-user</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s36" style="padding-left: 14pt;text-indent: 0pt;line-height: 8pt;text-align: center;">-5       0        5</p><p class="s36" style="padding-left: 57pt;text-indent: 0pt;line-height: 8pt;text-align: left;">System age - Predicted age</p><p style="padding-top: 3pt;padding-left: 16pt;text-indent: 9pt;text-align: justify;">Another aspect that must be considered is that as the principle of least privilege is better enforced in user accounts and system services, a malicious program may not have the necessary permissions to access all system resources and APIs. We did not encounter any such issues with our probe tool on the tested operating systems, but based on our ﬁndings, there is plenty of artifacts that can be probed even by under-privileged programs. This issue may become more important in other environments, such as, in malicious mobile apps, which are much more constrained in terms of the environmental features they can access.</p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">Fig. 7: CDF of the difference between the reported and estimated age for sandboxes and real systems, using the linear and Lasso regression models.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">(e.g., whether any documents appear under the recently opened documents menu [54]). Consequently, developing effective countermeasures before malware authors start taking advantage of wear and tear for evasion purposes more broadly, is of utmost importance.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">Although our results regarding the analyzed sandboxes used by public malware analysis services showcase their vulnerability to evasion based on wear and tear, adversaries may have already come to the same conclusion even before us, given that our probing technique was reasonably straightforward, and that similar techniques have also been used as part of previous research on public sandbox ﬁngerprinting [23]. Hopefully, by publishing our ﬁndings and coordinating with the affected vendors, our research will eventually result in more robust malware analysis systems.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">To that end, we contacted all vendors from which our probe tool managed to collect wear-and-tear artifact information, notifying them about our ﬁndings several months before the publication of this paper. Some of these vendors acknowledged the issue and requested additional information, as well as the code of our artifact-probing tool so that they can more easily detect future artifact exﬁltration attempts.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="B."><p class="s3" style="padding-left: 20pt;text-indent: -13pt;text-align: justify;">Probing Stealthiness</p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">Depending on the type of artifact, the actual operations that some malware needs to perform in order to retrieve the necessary information range from simple memory or ﬁle system read operations, to more complex parsing and querying operations that may involve system APIs and services. Instead of making sandboxes look realistic from a wear-and-tear perspective, an alternative (at least short-term) defense strategy may thus focus on detecting the probing activity itself. At the same time, many environmental aspects can be probed or inferred through non-suspicious system operations commonly exhibited during the startup or installation of benign software (e.g., retrieving or storing state information from the registry or conﬁguration ﬁles, or checking for updates), while malware can always switch to a different set of artifacts that are not monitored for suspicious activity.</p></li><li data-list-text="C."><p class="s3" style="padding-top: 8pt;padding-left: 20pt;text-indent: -14pt;text-align: justify;">OS Dependability</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">We have focused on the Windows environment, given that it is one of the most severely plagued by malware, and that most malware analysis services employ Windows sandboxes. As a result, many of the identiﬁed artifacts are Windows-speciﬁc (e.g., the registry-related ones), and clearly not applicable for malware that target other operating systems (e.g., Linux, Mac, Android). Even so, artifacts related to browser usage, the ﬁle system, and the various network caches, are likely to be present regardless of the exact operating system.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">Based on the dependability of an artifact on a given OS, sandbox operators may choose different defensive strategies. For instance, operators of sandboxes tailored to the detection of cross-platform malware (e.g., written in Java) may start addressing OS-independent artifacts ﬁrst, before focusing on OS-dependent ones. Finally, since end-user systems are the most popular targets of malware authors, our study is focused solely on them. We leave the analysis of wear-and-tear artifacts on other platforms, such as embedded devices, for future work.</p></li><li data-list-text="D."><p class="s3" style="padding-top: 8pt;padding-left: 21pt;text-indent: -14pt;text-align: justify;">Defenses</p></li></ol><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 9pt;text-align: justify;">We have demonstrated that removing system instrumentation and introspection artifacts from malware sandboxes is not enough to prevent malware evasion. Since the lack of wear and tear can allow attackers to differentiate between dynamic analysis systems and real user systems, <i>introducing </i>wear and tear artifacts to analysis systems becomes an additional necessary step. We outline two different potential strategies to achieve this.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">First, a real user system can be cloned and used as a basis for a malware sandbox. In this scenario, the system will already have organic wear and tear which can be used to confuse attackers. Potential difﬁculties of adopting this approach are: i) privacy issues (how does one scrub all private information before or after cloning, but leaves wear-and-tear artifacts intact?), and ii) eventual outdating of the artifacts (if the cloned system is used over a long period of time, an attacker can use our proposed statistical models to detect that the claimed age does not match the level of wear and tear).</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">An alternative approach is to start with a freshly installed image of an operating system and artiﬁcially age it by automatically simulating user actions. This would include installing and uninstalling different software while changing the system time to the past, browsing popular and less popular</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">webpages, and, in general, taking actions which will affect the wear-and-tear artifacts on which an attacker could rely for detecting dynamic analysis systems. While this approach does not introduce any privacy concerns and can be repeated as often as desired, it is unclear to what extent this artiﬁcial aging will produce realistic artifacts that are similar enough to those of real systems.</p><p style="padding-left: 6pt;text-indent: 9pt;text-align: justify;">We leave the implementation and comparison of these two approaches for future work.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="VIII."><p style="padding-left: 71pt;text-indent: -25pt;text-align: left;">Conclusion and Future Work</p></li></ol><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">In this paper, we have systematically assessed the threat of a malware sandbox evasion strategy that leverages artifacts indicative of the wear and tear of a system to identify artiﬁcial environments, and demonstrated its effectiveness against existing sandboxes used by malware analysis services. As long as this aspect is not taken into consideration when implementing malware sandboxes, malicious code will continue to be able to effectively alter its behavior when being analyzed. Even approaches that move from emulated and virtualized environments to bare-metal systems [8]–[10] will be helpless if evasion tactics shift from how realistic a system looks like, to how realistic its <i>past use </i>looks like. The same also holds for existing techniques that identify split personalities in malware by comparing malware behavior on an emulated analysis environment and on an unmodiﬁed reference host [44] or multiple sandboxes [18]. As long as all involved systems do not look realistic from the perspective of a real user’s activity, they will be easily detectable and, therefore, evadable.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">As a step towards mitigating this threat, we have presented statistical models that capture a system’s age and degree of use, which can aid sandbox operators in ﬁne-tuning their systems so that they exhibit more realistic wear-and-tear characteristics. Although addressing each and every identiﬁed artifact may be a viable short-term solution, more generic automated “aging” techniques will probably be needed to provide a more robust defense, as many more artifacts may be available.</p><p style="padding-left: 6pt;text-indent: 10pt;text-align: justify;">As part of our future work, we plan to explore such approaches based on simulation-based generation, as well as privacy-preserving transformation of system images extracted from real user devices. We also plan to evaluate the effec- tiveness of sandbox evasion based on wear and tear in other environments, such as, different desktop operating systems as well as mobile devices.</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 86pt;text-indent: 0pt;text-align: left;">Acknowledgments</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 10pt;text-align: justify;">We thank our shepherd, Tudor Dumitras, and the anonymous reviewers for their valuable feedback. This work was supported in part by the Ofﬁce of Naval Research (ONR) under grant N00014-16-1-2264, and by the National Science Foundation (NSF) under grants CNS-1617902 and CNS-1617593, with additional support by Qualcomm. Any opinions, ﬁndings, conclusions, or recommendations expressed herein are those of the authors, and do not necessarily reﬂect those of the US Government, ONR, NSF, or Qualcomm.</p><p style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: center;">References</p><ol id="l13"><li data-list-text="[1]"><p class="s39" style="padding-top: 5pt;padding-left: 24pt;text-indent: -14pt;text-align: justify;">C. Willems, T. Holz, and F. Freiling, “Toward automated dynamic malware analysis using CWSandbox,” <i>Security Privacy, IEEE</i>, vol. 5, no. 2, pp. 32–39, March 2007.</p></li><li data-list-text="[2]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	U. Bayer, C. Kruegel, and E. Kirda, “TTAnalyze: A tool for analyzing malware,” in <i>Proceedings of the 15th European Institute for Computer Antivirus Research Annual Conference (EICAR)</i>, April 2006.</p></li><li data-list-text="[3]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	X. Jiang and X. Wang, “‘Out-of-the-box’ monitoring of VM-based high-interaction honeypots,” in <i>Proceedings of the 10th International Conference on Recent Advances in Intrusion Detection (RAID)</i>, 2007,</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">pp. 198–218.</p></li><li data-list-text="[4]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	H. Yin, D. Song, M. Egele, C. Kruegel, and E. Kirda, “Panorama: Capturing system-wide information ﬂow for malware detection and analysis,” in <i>Proceedings of the 14th ACM Conference on Computer and Communications Security (CCS)</i>, 2007, pp. 116–127.</p></li><li data-list-text="[5]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">“Anubis: Malware analysis for unknown binaries,” https://anubis.iseclab. org/.</p></li><li data-list-text="[6]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	A. Dinaburg, P. Royal, M. Sharif, and W. Lee, “Ether: Malware analysis via hardware virtualization extensions,” in <i>Proceedings of the 15th ACM Conference on Computer and Communications Security (CCS)</i>, 2008, pp. 51–62.</p></li><li data-list-text="[7]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">“Automated malware analysis: Cuckoo sandbox,” https://cuckoosandbox. org/.</p></li><li data-list-text="[8]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	C. Willems, R. Hund, A. Fobian, D. Felsch, T. Holz, and A. Vasudevan, “Down to the bare metal: Using processor features for binary analysis,” in <i>Proceedings of the 28th Annual Computer Security Applications Conference (ACSAC)</i>, 2012, pp. 189–198.</p></li><li data-list-text="[9]"><p class="s39" style="padding-left: 24pt;text-indent: -14pt;text-align: justify;">	D. Kirat, G. Vigna, and C. Kruegel, “Barecloud: Bare-metal analysis- based evasive malware detection,” in <i>Proceedings of the 23rd USENIX Security Symposium</i>, 2014, pp. 287–301.</p></li><li data-list-text="[10]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">S. Mutti, Y. Fratantonio, A. Bianchi, L. Invernizzi, J. Corbetta, D. Kirat,</p><ol id="l14"><li data-list-text="C."><p class="s39" style="padding-left: 34pt;text-indent: -10pt;text-align: justify;">Kruegel, and G. Vigna, “Baredroid: Large-scale analysis of android apps on real devices,” in <i>Proceedings of the 31st Annual Computer Security Applications Conference (ACSAC)</i>, December 2015.</p></li></ol></li><li data-list-text="[11]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;">J. Oberheide and C. Miller, “Dissecting the Android Bouncer,” 2012, https://jon.oberheide.org/ﬁles/summercon12-bouncer.pdf.</p></li><li data-list-text="[12]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">S. Neuner, V. van der Veen, M. Lindorfer, M. Huber, G. Merzdovnik,</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">M. Mulazzani, and E. Weippl, “Enter sandbox: Android sandbox com- parison,” in <i>Proceedings of the 3rd IEEE Mobile Security Technologies Workshop (MoST)</i>, 2014.</p></li><li data-list-text="[13]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://www.ﬁreeye.com/" class="a" target="_blank">“FireEye Malware Analysis AX Series,” </a>https://www.ﬁreeye.com/ products/malware-analysis.html.</p></li><li data-list-text="[14]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://www.bluecoat.com/" class="a" target="_blank">“Blue Coat Malware Analysis Appliance,” </a>https://www.bluecoat.com/ products/malware-analysis-appliance.</p></li><li data-list-text="[15]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://www.cisco.com/c/en/us/products/" class="a" target="_blank">“Cisco Anti-Malware System,” </a>http://www.cisco.com/c/en/us/products/ security/web-security-appliance/anti malware index.html.</p></li><li data-list-text="[16]"><p style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://www.fortinet.com/products/fortisandbox/index.html" class="a" target="_blank">	“FortiNet Advanced Threat Protection (ATP) - FortiSandbox,” http:// </a><a href="http://www.fortinet.com/products/fortisandbox/index.html" target="_blank">www.fortinet.com/products/fortisandbox/index.html.</a></p></li><li data-list-text="[17]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://www.mcafee.com/us/" class="a" target="_blank">“McAfee Advanced Threat Defense,” </a>http://www.mcafee.com/us/ products/advanced-threat-defense.aspx.</p></li><li data-list-text="[18]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;">	M. Lindorfer, C. Kolbitsch, and P. Milani Comparetti, “Detecting environment-sensitive malware,” in <i>Proceedings of the 14th International Conference on Recent Advances in Intrusion Detection (RAID)</i>, 2011,</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">pp. 338–357.</p></li><li data-list-text="[19]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;"><a href="http://labs.lastline.com/analyzing-environment-aware-malware-a-look-" class="a" target="_blank">C.  Kolbitsch,  “Analyzing  environment-aware  malware,”  2014, </a>http://labs.lastline.com/analyzing-environment-aware-malware-a-look- at-zeus-trojan-variant-called-citadel-evading-traditional-sandboxes.</p></li><li data-list-text="[20]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">T. Petsas, G. Voyatzis, E. Athanasopoulos, M. Polychronakis, and</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">S. Ioannidis, “Rage against the virtual machine: Hindering dynamic analysis of mobile malware,” in <i>Proceedings of the 7th European Workshop on System Security (EuroSec)</i>, April 2014.</p></li><li data-list-text="[21]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;">	A. Kapravelos, Y. Shoshitaishvili, M. Cova, C. Kruegel, and G. Vigna, “Revolver: An automated approach to the detection of evasive web-based malware,” in <i>Proceedings of the 22nd USENIX Security Symposium</i>, 2013, pp. 637–652.</p></li><li data-list-text="[22]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;text-align: justify;">	G. Stringhini, C. Kruegel, and G. Vigna, “Shady paths: Leveraging surﬁng crowds to detect malicious web pages,” in <i>Proceedings of the ACM SIGSAC Conference on Computer &amp; Communications Security (CCS)</i>, 2013, pp. 133–144.</p></li><li data-list-text="[23]"><p class="s39" style="padding-left: 24pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">A. Yokoyama, K. Ishii, R. Tanabe, Y. Papa, K. Yoshioka, T. Matsumoto,</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">T. Kasama, D. Inoue, M. Brengel, M. Backes, and C. Rossow, “SandPrint: Fingerprinting malware sandboxes to provide intelligence for sandbox evasion,” in <i>Proceedings of the 19th International Symposium on Research in Attacks, Intrusions and Defenses (RAID)</i>, 2016, pp. 165–187.</p></li><li data-list-text="[24]"><p class="s39" style="padding-top: 3pt;padding-left: 25pt;text-indent: -18pt;text-align: justify;"><a href="http://www.zscaler.com/blogs/research/malicious-" class="a" target="_blank">D. Desai, “Malicious Documents leveraging new Anti-VM &amp; Anti- Sandbox techniques,” </a>https://www.zscaler.com/blogs/research/malicious- documents-leveraging-new-anti-vm-anti-sandbox-techniques, 2016.</p></li><li data-list-text="[25]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: left;"><a href="http://www.proofpoint.com/us/threat-" class="a" target="_blank">ProofPoint, “Ursnif Banking Trojan Campaign Ups the Ante with New Sandbox Evasion Techniques,” </a>https://www.proofpoint.com/us/threat- insight/post/ursnif-banking-trojan-campaign-sandbox-evasion- techniques, 2016.</p></li><li data-list-text="[26]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;line-height: 9pt;text-align: left;">Y.-M. Wang, D. Beck, X. Jiang, R. Roussev, C. Verbowski, S. Chen, and</p><p class="s39" style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">S. King, “Automated web patrol with strider honeymonkeys: Finding web sites that exploit browser vulnerabilities,” in <i>Proceedings of the 13th Network and Distributed Systems Security Symposium (NDSS)</i>, 2006.</p></li><li data-list-text="[27]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	N. Provos, P. Mavrommatis, M. A. Rajab, and F. Monrose, “All your iFRAMEs point to us,” in <i>Proceedings of the 17th USENIX Security Symposium</i>, 2008.</p></li><li data-list-text="[28]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">A. Moshchuk, T. Bragin, S. D. Gribble, and H. M. Levy, “A crawler- based study of spyware on the web,” in <i>Proceedings of the 13th Network and Distributed Systems Security Symposium (NDSS)</i>, 2006.</p></li><li data-list-text="[29]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	A. Moshchuk, T. Bragin, D. Deville, S. D. Gribble, and H. M. Levy, “Spyproxy: Execution-based detection of malicious web content,” in <i>Proceedings of the 16th USENIX Security Symposium</i>, 2007.</p></li><li data-list-text="[30]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">M. Cova, C. Kruegel, and G. Vigna, “Detection and analysis of drive- by-download attacks and malicious javascript code,” in <i>Proceedings of the World Wide Web Conference (WWW)</i>, 2010.</p></li><li data-list-text="[31]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	“Wepawet: Detection and Analysis of Web-based Threats,” https:// wepawet.iseclab.org/.</p></li><li data-list-text="[32]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	K. Rieck, T. Krueger, and A. Dewald, “Cujo: Efﬁcient detection and prevention of drive-by-download attacks,” in <i>Proceedings of the 26th Annual Computer Security Applications Conference (ACSAC)</i>, 2010, pp. 31–39.</p></li><li data-list-text="[33]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	S. Ford, M. Cova, C. Kruegel, and G. Vigna, “Analyzing and detecting malicious ﬂash advertisements,” in <i>Proceedings of the Annual Computer Security Applications Conference (ACSAC)</i>, Honolulu, HI, December 2009.</p></li><li data-list-text="[34]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	M. Egele, T. Scholte, E. Kirda, and C. Kruegel, “A survey on automated dynamic malware-analysis techniques and tools,” <i>ACM Comput. Surv.</i>, vol. 44, no. 2, pp. 6:1–6:42, Mar. 2008.</p></li><li data-list-text="[35]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	T. Vidas and N. Christin, “Evading android runtime analysis via sandbox detection,” in <i>Proceedings of the 9th ACM Symposium on Information, Computer and Communications Security (AsiaCCS)</i>, 2014, pp. 447–458.</p></li><li data-list-text="[36]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;"><a href="http://www/" class="a" target="_blank">T. Klein, “ScoopyNG – The VMware detection tool,” 2008, </a>http://www. trapkit.de/tools/scoopyng/index.html.</p></li><li data-list-text="[37]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">M. G. Kang, H. Yin, S. Hanna, S. McCamant, and D. Song, “Emulating emulation-resistant malware,” in <i>Proceedings of the 1st ACM Workshop on Virtual Machine Security (VMSec)</i>, 2009, pp. 11–22.</p></li><li data-list-text="[38]"><p class="s39" style="padding-top: 3pt;padding-left: 25pt;text-indent: -18pt;text-align: justify;">P. Ferrie, “Attacks on Virtual Machine Emulators,” http://www.symantec. com/avcenter/reference/Virtual Machine Threats.pdf.</p></li><li data-list-text="[39]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;"><a href="http://pferrie.tripod/" class="a" target="_blank">——, “Attacks on More Virtual Machine Emulators,” </a>http://pferrie.tripod. com/papers/attacks2.pdf.</p></li><li data-list-text="[40]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">Y. Bulygin, “CPU side-channels vs. virtualization rootkits: the good, the bad, or the ugly.” ToorCon, 2008.</p></li><li data-list-text="[41]"><p style="padding-left: 25pt;text-indent: -18pt;text-align: justify;"><a href="http://www.invisiblethings.org/papers/redpill.html" class="a" target="_blank">J. Rutkowska, “Red Pill... or how to detect VMM using (almost) one CPU instruction,” 2004, https://web.archive.org/web/20071112073957/ </a><a href="http://www.invisiblethings.org/papers/redpill.html" target="_blank">http:/www.invisiblethings.org/papers/redpill.html.</a></p></li><li data-list-text="[42]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;line-height: 9pt;text-align: justify;">O. Bazhaniuk, Y. Bulygin, A. Furtak, M. Gorobets, J. Loucaides, and</p><p class="s39" style="padding-left: 25pt;text-indent: 0pt;text-align: justify;">M. Shkatov, “Reaching the far corners of MATRIX: generic VMM ﬁngerprinting.” SOURCE Seattle, 2015.</p></li><li data-list-text="[43]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: left;"><a href="http://www.botconf.eu/wp-content/uploads/2014/12/2014-2.7-" class="a" target="_blank">P.  Jung,  “Bypassing  sanboxes  for  fun!”    BotConf,  2014, </a>https://www.botconf.eu/wp-content/uploads/2014/12/2014-2.7- Bypassing-Sandboxes-for-Fun.pdf.</p></li><li data-list-text="[44]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	D. Balzarotti, M. Cova, C. Karlberger, C. Kruegel, E. Kirda, and G. Vigna, “Efﬁcient detection of split personalities in malware,” in <i>Proceedings of the Symposium on Network and Distributed System Security (NDSS)</i>, 2010.</p></li><li data-list-text="[45]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	M. K. Sun, M. J. Lin, M. Chang, C. S. Laih, and H. T. Lin, “Malware virtualization-resistant behavior detection,” in <i>Proceedings of the 17th IEEE International Conference on Parallel and Distributed Systems (ICPADS)</i>, 2011, pp. 912–917.</p></li><li data-list-text="[46]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	D. Kirat, G. Vigna, and C. Kruegel, “BareBox: Efﬁcient malware analysis on bare-metal,” in <i>Proceedings of the 27th Annual Computer Security Applications Conference (ACSAC)</i>, 2011, pp. 403–412.</p></li><li data-list-text="[47]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: left;"><a href="http://www.symantec.com/connect/blogs/does-malware-still-detect-" class="a" target="_blank">	C. Wueest, “Does malware still detect virtual machines?” 2014, </a>http://www.symantec.com/connect/blogs/does-malware-still-detect- virtual-machines.</p></li><li data-list-text="[48]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;line-height: 8pt;text-align: left;">A. Singh, “Defeating Darkhotel Just-In-Time Decryption,” 2015, http:</p><p class="s39" style="padding-left: 25pt;text-indent: 0pt;line-height: 9pt;text-align: left;">//labs.lastline.com/defeating-darkhotel-just-in-time-decryption.</p></li><li data-list-text="[49]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	D. Maier, T. Mu¨ller, and M. Protsenko, “Divide-and-conquer: Why an- droid malware cannot be stopped,” in <i>Proceedings of the 9th International Conference on Availability, Reliability and Security (ARES)</i>, 2014, pp. 30–39.</p></li><li data-list-text="[50]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: justify;">	J. Blackthorne, A. Bulazel, A. Fasano, P. Biernat, and B. Yener, “AVleak: Fingerprinting antivirus emulators through black-box testing,” in <i>Proceedings of the 10th USENIX Workshop on Offensive Technologies (WOOT)</i>, Austin, TX, 2016.</p></li><li data-list-text="[51]"><p style="padding-left: 25pt;text-indent: -18pt;line-height: 9pt;text-align: left;"><a href="http://www.registry-cleaner.net/" class="a" target="_blank">“CleanMyPC Registry Cleaner,” </a><a href="http://www.registry-cleaner.net/" target="_blank">http://www.registry-cleaner.net/.</a></p></li><li data-list-text="[52]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: left;"><a href="http://www.piriform.com/ccleaner/" class="a" target="_blank">“CCleaner - Registry Cleaner,” </a>https://www.piriform.com/ccleaner/ registry-cleaner.</p></li><li data-list-text="[53]"><p class="s39" style="padding-left: 25pt;text-indent: -18pt;text-align: left;">R. E. Schapire and Y. Freund, <i>Boosting: Foundations and algorithms</i>. MIT press, 2012.</p></li><li data-list-text="[54]"><p style="padding-left: 25pt;text-indent: -18pt;line-height: 9pt;text-align: left;"><a href="http://labs.lastline.com/evasive-jscript" class="a" target="_blank">M. Cova, “Evasive JScript,” 2016, </a><a href="http://labs.lastline.com/evasive-jscript" target="_blank">http://labs.lastline.com/evasive-jscript.</a></p></li></ol></body></html>
